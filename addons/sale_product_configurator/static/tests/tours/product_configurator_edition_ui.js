flectra.define('sale.product_configurator_edition_tour',function(require){
"usestrict";

vartour=require('web_tour.tour');

tour.register('sale_product_configurator_edition_tour',{
    url:"/web",
    test:true,
},[tour.stepUtils.showAppsMenuItem(),{
    trigger:'.o_app[data-menu-xmlid="sale.sale_menu_root"]',
    edition:'community'
},{
    trigger:'.o_app[data-menu-xmlid="sale.sale_menu_root"]',
    edition:'enterprise'
},{
    trigger:".o_list_button_add",
    extra_trigger:".o_sale_order"
},{
    trigger:"a:contains('Addaproduct')"
},{
    trigger:'div[name="product_template_id"]input',
    run:function(){
        var$input=$('div[name="product_template_id"]input');
        $input.click();
        $input.val('Custo');
        varkeyDownEvent=jQuery.Event("keydown");
        keyDownEvent.which=42;
        $input.trigger(keyDownEvent);
    }
},{
    trigger:'ul.ui-autocompletea:contains("CustomizableDesk(TEST)")',
    run:'click'
},{
    trigger:'.configurator_containerspan:contains("Steel")',
    run:function(){
        $('input.product_id').change(function(){
            $('.o_sale_product_configurator_add').attr('request_count',1);
        });
    }
},{
    trigger:'.configurator_containerspan:contains("Aluminium")'
},{
    trigger:'.o_sale_product_configurator_add[request_count="1"]',
    run:function(){}//usedtosyncwith"get_combination_info"completion
},{
    trigger:'.o_sale_product_configurator_add:not(.disabled)'
},{
    trigger:'buttonspan:contains(Confirm)',
    extra_trigger:'.oe_optional_products_modal',
    run:'click'
},{
    trigger:'td.o_data_cell:contains("CustomizableDesk(TEST)(Aluminium,White)")',
    extra_trigger:'div[name="order_line"]',
    run:function(){}//checkaddedproduct
},{
    trigger:'td.o_product_configurator_cell',
},{
    trigger:'.o_edit_product_configuration',
},{
    trigger:'.configurator_containerli.js_attribute_value:has(span:contains("Aluminium"))input:checked',
    run:function(){}//checkupdatedlegs
},{
    trigger:'span.oe_currency_value:contains("800")',
    run:function(){}//checkupdatedprice
},{
    trigger:'.configurator_containerspan:contains("Steel")',
    run:function(){
        $('input.product_id').change(function(){
            if($('.o_sale_product_configurator_edit').attr('request_count')){
                $('.o_sale_product_configurator_edit').attr('request_count',
                    parseInt($('.o_sale_product_configurator_edit').attr('request_count'))+1);
            }else{
                $('.o_sale_product_configurator_edit').attr('request_count',1);
            }
        });
    }
},{
    trigger:'.configurator_containerspan:contains("Custom")',
    run:function(){
        //FIXMEawa:sincejquery3updateitdoesn't"click"
        //ontheelementwithoutthisrun(and'run:"click"'
        //doesn'tworkeither)
        $('.configurator_containerspan:contains("Custom")').click();
    }
},{
    trigger:'.configurator_container.variant_custom_value',
    run:'textnicecustomvalue'
},{
    trigger:'input[data-value_name="Black"]',
    run:'click'
},{
    trigger:'.o_sale_product_configurator_edit[request_count="2"]',
    run:function(){}//usedtosyncwith"get_combination_info"completion
},{
    trigger:'.o_sale_product_configurator_edit',
},{
    trigger:'td.o_data_cell:contains("CustomizableDesk(TEST)(Custom,Black)")',
    extra_trigger:'div[name="order_line"]',
    run:function(){}//checkupdatedproduct
},{
    trigger:'td.o_data_cell:contains("Custom:nicecustomvalue")',
    extra_trigger:'div[name="order_line"]',
    run:function(){}//checkcustomvalue
},{
    trigger:'td.o_product_configurator_cell',
},{
    trigger:'.o_edit_product_configuration',
},{
    trigger:'.configurator_container.variant_custom_value',
    run:'textanothernicecustomvalue'
},{
    trigger:'.o_sale_product_configurator_edit',
},{
    trigger:'td.o_data_cell:contains("Custom:anothernicecustomvalue")',
    extra_trigger:'div[name="order_line"]',
    run:function(){}//checkcustomvalue
},{
    trigger:'td.o_product_configurator_cell',
},{
    trigger:'.o_edit_product_configuration',
},{
    trigger:'.configurator_containerspan:contains("Steel")',
    run:function(){
        $('input.product_id').change(function(){
            $('.o_sale_product_configurator_edit').attr('request_count',1);
        });
    }
},{
    trigger:'.configurator_containerspan:contains("Steel")',
    run:function(){
        //FIXMEawa:sincejquery3updateitdoesn't"click"
        //ontheelementwithoutthisrun(and'run:"click"'
        //doesn'tworkeither)
        $('.configurator_containerspan:contains("Steel")').click();
    }
},{
    trigger:'.o_sale_product_configurator_edit[request_count="1"]',
    run:function(){}//usedtosyncwith"get_combination_info"completion
},{
    trigger:'.configurator_containerbutton.js_add_cart_json:has(.fa-plus)',
},{
    trigger:'.o_sale_product_configurator_edit',
},{
    trigger:'td.o_data_cell:contains("2.00")',
    run:function(){}//checkquantity
},{
    trigger:'td.o_product_configurator_cell',
    run:function(){
        //usedtocheckthatthedescriptiondoesnotcontainacustomvalueanymore
        if($('td.o_data_cell:contains("Custom:anothernicecustomvalue")').length===0){
            $('td.o_data_cell:contains("CustomizableDesk(TEST)(Steel,Black)")').html('toursuccess');
        }
    }
},{
    trigger:'td.o_data_cell:contains("toursuccess")',
    extra_trigger:'div[name="order_line"]',
    run:function(){}
}]);

});
