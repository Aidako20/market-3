<?xmlversion="1.0"encoding="utf-8"?>
<flectra>
    <templateid="optional_products_modal"name="OptionalProducts">
        <mainclass="modal-body">
            <tt-call="sale_product_configurator.configure_optional_products"/>
        </main>
    </template>

    <!--backend-->
    <templateid="configure"name="Configure">
        <divclass="js_productmain_product">

            <tt-set="combination"t-value="product_combinationifproduct_combinationelseproduct._get_first_possible_combination()"/>
            <tt-set="combination_info"t-value="product._get_combination_info(combination,add_qty=add_qtyor1,pricelist=pricelist)"/>
            <tt-set="product_variant"t-value="product.env['product.product'].browse(combination_info['product_id'])"/>

            <inputtype="hidden"class="product_template_id"t-att-value="product.id"/>
            <inputtype="hidden"class="product_id"t-attf-name="product_id"t-att-value="product_variant.id"/>
            <divclass="col-lg-12text-centermt-5">
                <tt-if="product._is_add_to_cart_possible()">
                    <divclass="col-lg-5d-inline-blocktext-left">
                        <tt-if="combination"t-call="sale.variants">
                            <tt-set="parent_combination"t-value="None"/>
                        </t>
                        <h2>
                            <spant-attf-class="text-dangeroe_default_priceoe_striked_price{{''ifcombination_info['has_discounted_price']else'd-none'}}"
                                t-esc="combination_info['list_price']"
                                t-options='{
                                    "widget":"monetary",
                                    "display_currency":(pricelistorproduct).currency_id
                                }'/>
                            <spanclass="oe_priceproduct_idmt-3"style="white-space:nowrap;"
                                t-att-data-product-id="product.id"
                                t-esc="combination_info['price']"
                                t-options='{
                                    "widget":"monetary",
                                    "display_currency":(pricelistorproduct).currency_id
                                }'/>
                        </h2>
                        <divclass="css_quantityinput-group"t-if="product.visible_qty_configurator">
                            <divclass="input-group-prepend">
                                <buttont-attf-href="#"class="btnbtn-primaryjs_add_cart_jsond-noned-md-inline-block"aria-label="Removeone"title="Removeone">
                                    <iclass="fafa-minus"></i>
                                </button>
                            </div>
                            <inputtype="text"class="js_quantityform-controlquantity"data-min="1"name="add_qty"t-att-value="add_qtyor1"/>
                            <divclass="input-group-append">
                                <buttont-attf-href="#"class="btnbtn-primaryfloat_leftjs_add_cart_jsond-noned-md-inline-block"aria-label="Addone"title="Addone">
                                    <iclass="fafa-plus"></i>
                                </button>
                            </div>
                        </div>
                        <pclass="css_not_available_msgalertalert-warning">Thiscombinationdoesnotexist.</p>
                    </div>
                    <divclass="col-lg-1d-inline-block"></div>
                    <divclass="col-lg-5d-inline-blockalign-toptext-left">
                        <imgt-if="product_variant"t-att-src="'/web/image/product.product/%s/image_1024'%product_variant.id"class="d-blockproduct_detail_img"alt="ProductImage"/>
                        <imgt-else=""t-att-src="'/web/image/product.template/%s/image_1024'%product.id"class="d-blockproduct_detail_img"alt="ProductImage"/>
                    </div>
                </t>
                <tt-else="">
                    <divclass="col-lg-5d-inline-blocktext-left">
                        <pclass="alertalert-warning">Thisproducthasnovalidcombination.</p>
                    </div>
                </t>
            </div>
        </div>
    </template>

    <!--modal:fulltable,currencltyselectedproductsattop-->
    <templateid="configure_optional_products">
        <tableclass="tabletable-stripedtable-sm">
        <thead>
            <tr>
                <thclass="td-img">Product</th>
                <th></th>
                <thclass="text-centertd-qty">Quantity</th>
                <thclass="text-centertd-price">Price</th>
            </tr>
        </thead>
        <tbody>
            <trclass="js_productin_cartmain_product">

                <tt-set="combination_info"t-value="product.product_tmpl_id._get_combination_info(combination,product.id,add_qtyor1,pricelist)"/>
                <tt-set="product_variant"t-value="product.env['product.product'].browse(combination_info['product_id'])"/>

                <inputtype="hidden"class="product_template_id"t-att-value="product.product_tmpl_id.id"/>
                <inputtype="hidden"class="product_id"t-att-value="product_variant.id"/>
                <tdclass='td-img'>
                    <imgt-if="product_variant"t-att-src="'/web/image/product.product/%s/image_128'%product_variant.id"alt="ProductImage"/>
                    <imgt-else=""t-att-src="'/web/image/product.template/%s/image_128'%product.id"alt="ProductImage"/>
                </td>
                <tdclass='td-product_name'>
                    <strongt-esc="combination_info['display_name']"/>
                    <divclass="text-mutedsmall">
                        <divt-field="product.description_sale"/>
                        <divclass="js_attributes"/>
                    </div>
                </td>
                <tdclass="text-centertd-qty">
                    <divclass="css_quantityinput-group">
                        <divclass="input-group-prepend">
                            <buttont-attf-href="#"class="btnbtn-primaryjs_add_cart_jsond-noned-md-inline-block"aria-label="Removeone"title="Removeone">
                                <iclass="fafa-minus"></i>
                            </button>
                        </div>
                        <inputtype="text"class="js_quantityform-controlquantity"data-min="1"name="add_qty"t-att-value="add_qtyor1"/>
                        <divclass="input-group-append">
                            <buttont-attf-href="#"class="btnbtn-primaryfloat_leftjs_add_cart_jsond-noned-md-inline-block"aria-label="Addone"title="Addone">
                                <iclass="fafa-plus"></i>
                            </button>
                        </div>
                    </div>
                </td>
                <tdclass="text-centertd-price"name="price">
                    <ulclass="d-nonejs_add_cart_variants"t-att-data-attribute_exclusions="{'exclusions:[]'}"></ul>
                    <divclass="d-noneoe_unchanged_value_ids"t-att-data-unchanged_value_ids="variant_values"></div>
                    <divt-attf-class="text-dangeroe_default_priceoe_striked_price{{''ifcombination_info['has_discounted_price']else'd-none'}}"
                        t-esc="combination_info['list_price']"
                        t-options='{
                            "widget":"monetary",
                            "display_currency":(pricelistorproduct).currency_id
                        }'
                    />
                    <spanclass="oe_priceproduct_id"style="white-space:nowrap;"
                        t-att-data-product-id="product.id"
                        t-esc="combination_info['price']"
                        t-options='{
                            "widget":"monetary",
                            "display_currency":(pricelistorproduct).currency_id
                        }'/>
                    <spanclass="js_raw_priced-none"t-esc="product.price"/>
                </td>
            </tr>
            <trclass="o_total_row">
                <tdcolspan="4"class="text-right">
                    <strong>Total:</strong>
                    <spanclass="js_price_totalfont-weight-bold"style="white-space:nowrap;"
                        t-att-data-product-id="product.id"
                        t-esc="combination_info['price']*(add_qtyor1)"
                        t-options='{
                            "widget":"monetary",
                            "display_currency":(pricelistorproduct).currency_id
                        }'/>
                </td>
            </tr>
            <trt-if="product.optional_product_ids"class="o_select_options"><tdcolspan="4"><h4>AvailableOptions:</h4></td></tr>
            <tt-call="sale_product_configurator.optional_product_items">
                <tt-set="parent_combination"t-value="combination"/>
            </t>
        </tbody>
        </table>
    </template>

    <!--modal:optionalproducts-->
    <templateid="optional_product_items">
        <tt-foreach="product.optional_product_ids"t-as="product">
            <tt-set="combination"t-value="product._get_first_possible_combination(parent_combination)"/>
            <tt-if="product._is_add_to_cart_possible(parent_combination)">

                <tt-set="combination_info"t-value="product._get_combination_info(combination,add_qty=add_qtyor1,pricelist=pricelist)"/>
                <tt-set="product_variant"t-value="product.env['product.product'].browse(combination_info['product_id'])"/>

                <trclass="js_product">
                    <tdclass="td-img">
                        <inputtype="hidden"class="product_template_id"t-att-value="product.id"/>
                        <inputtype="hidden"class="product_id"t-attf-name="optional-product-#{product.id}"t-att-value="product_variant.id"/>
                        <imgt-if="product_variant"t-att-src="'/web/image/product.product/%s/image_128'%product_variant.id" class="variant_image"alt="ProductImage"/>
                        <imgt-else=""t-att-src="'/web/image/product.template/%s/image_128'%product.id" class="variant_image"alt="ProductImage"/>
                    </td>
                    <tdclass='td-product_name'colspan="2">
                        <divclass="float-left">
                            <strongclass="product-nameproduct_display_name"t-esc="combination_info['display_name']"/>
                            <divclass="text-mutedsmall"t-field="product.description_sale"/>
                        </div>
                        <divclass="float-right">
                            <tt-call="sale.variants"/>
                        </div>
                    </td>
                    <tdclass="text-centertd-qtyd-none">
                        <divclass="css_quantityinput-group">
                            <divclass="input-group-prepend">
                                <buttont-attf-href="#"class="btnbtn-primaryfloat_leftjs_add_cart_jsond-noned-md-inline-block"aria-label="Removeone"title="Removeone">
                                    <iclass="fafa-minus"></i>
                                </button>
                            </div>
                            <inputtype="text"class="js_quantityform-controlquantity"data-min="1"name="add_qty"t-att-value="add_qtyor1"/>
                            <divclass="input-group-append">
                                <buttont-attf-href="#"class="btnbtn-primaryfloat_leftjs_add_cart_jsond-noned-md-inline-block"aria-label="Addone"title="Addone">
                                    <iclass="fafa-plus"></i>
                                </button>
                            </div>
                        </div>
                    </td>
                    <tdclass="text-centertd-price">
                        <divt-attf-class="text-dangeroe_default_priceoe_optionaloe_striked_price{{''ifcombination_info['has_discounted_price']else'd-none'}}"
                            t-esc="combination_info['list_price']"
                            t-options='{
                                "widget":"monetary",
                                "display_currency":(pricelistorproduct).currency_id
                            }'/>
                        <divclass="oe_price"style="white-space:nowrap;"
                            t-esc="combination_info['price']"
                            t-options='{
                                "widget":"monetary",
                                "display_currency":(pricelistorproduct).currency_id
                            }'/>
                        <spanclass="js_raw_priced-none"t-esc="combination_info['price']"/>
                        <pclass="css_not_available_msgalertalert-warning">Optionnotavailable</p>

                        <arole="button"href="#"class="js_addbtnbtn-primarybtn-sm"><iclass="fafa-shopping-cartadd-optionnal-item"></i>Addtocart</a>
                        <spanclass="js_removed-none">
                            <arole="button"href="#"class="js_remove"><iclass="fafa-trash-oremove-optionnal-item"></i></a>
                        </span>
                    </td>
                </tr>
            </t>
        </t>
    </template>
</flectra>
