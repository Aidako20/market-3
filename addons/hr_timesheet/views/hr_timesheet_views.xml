<?xmlversion="1.0"encoding="utf-8"?>
<flectra>
    <data>

        <!--Timesheetrootmenus-->
        <menuitemid="timesheet_menu_root"
            name="Timesheets"
            sequence="55"
            groups="group_hr_timesheet_user"
            web_icon="hr_timesheet,static/description/icon_timesheet.png"/>

        <menuitemid="menu_hr_time_tracking"
            name="Timesheet"
            parent="timesheet_menu_root"
            sequence="5"/>

        <!--
            TimesheetlineViews
        -->
        <recordid="hr_timesheet_line_tree"model="ir.ui.view">
            <fieldname="name">account.analytic.line.tree.hr_timesheet</field>
            <fieldname="model">account.analytic.line</field>
            <fieldname="arch"type="xml">
                <treeeditable="top"string="TimesheetActivities"sample="1">
                    <fieldname="date"/>
                    <fieldname="employee_id"invisible="1"/>
                    <fieldname="project_id"required="1"options="{'no_create_edit':True}"context="{'form_view_ref':'project.project_project_view_form_simplified',}"/>
                    <fieldname="task_id"optional="show"options="{'no_create_edit':True,'no_open':True}"widget="task_with_hours"context="{'default_project_id':project_id}"domain="[('project_id','=',project_id)]"/>
                    <fieldname="name"optional="show"required="0"/>
                    <fieldname="unit_amount"optional="show"widget="timesheet_uom"sum="Total"decoration-danger="unit_amount&gt;24"/>
                    <fieldname="company_id"invisible="1"/>
                    <fieldname="user_id"invisible="1"/>
                </tree>
            </field>
        </record>

        <recordid="timesheet_view_tree_user"model="ir.ui.view">
            <fieldname="name">account.analytic.line.view.tree.with.user</field>
            <fieldname="model">account.analytic.line</field>
            <fieldname="inherit_id"ref="hr_timesheet_line_tree"/>
            <fieldname="mode">primary</field>
            <fieldname="priority">10</field>
            <fieldname="arch"type="xml">
                <xpathexpr="//field[@name='employee_id']"position="attributes">
                    <attributename="invisible">0</attribute>
                    <attributename="required">1</attribute>
                    <attributename="widget">many2one_avatar_employee</attribute>
                    <attributename="context">{'active_test':True}</attribute>
                </xpath>
            </field>
        </record>

        <recordid="view_hr_timesheet_line_pivot"model="ir.ui.view">
            <fieldname="name">account.analytic.line.pivot</field>
            <fieldname="model">account.analytic.line</field>
            <fieldname="arch"type="xml">
                <pivotstring="Timesheet"sample="1">
                    <fieldname="employee_id"type="row"/>
                    <fieldname="date"interval="month"type="col"/>
                    <fieldname="unit_amount"type="measure"widget="timesheet_uom"/>
                    <fieldname="amount"string="TimesheetCosts"/>
                </pivot>
            </field>
        </record>

        <recordid="view_hr_timesheet_line_graph"model="ir.ui.view">
            <fieldname="name">account.analytic.line.graph</field>
            <fieldname="model">account.analytic.line</field>
            <fieldname="arch"type="xml">
                <graphstring="Timesheet"sample="1">
                    <fieldname="task_id"type="row"/>
                    <fieldname="project_id"type="row"/>
                    <fieldname="unit_amount"type="measure"widget="timesheet_uom"/>
                    <fieldname="amount"string="TimesheetCosts"/>
                </graph>
            </field>
        </record>

        <recordid="hr_timesheet_line_form"model="ir.ui.view">
            <fieldname="name">account.analytic.line.form</field>
            <fieldname="model">account.analytic.line</field>
            <fieldname="priority">1</field>
            <fieldname="inherit_id"eval="False"/>
            <fieldname="arch"type="xml">
                <formstring="AnalyticEntry">
                    <sheetstring="AnalyticEntry">
                        <group>
                            <group>
                                <fieldname="date"/>
                                <fieldname="project_id"required="1"context="{'form_view_ref':'project.project_project_view_form_simplified',}"/>
                                <fieldname="task_id"widget="task_with_hours"context="{'default_project_id':project_id}"domain="[('project_id','=',project_id)]"/>
                                <fieldname="name"/>
                                <fieldname="company_id"groups="base.group_multi_company"/>
                            </group>
                            <group>
                                <fieldname="amount"/>
                                <fieldname="unit_amount"widget="timesheet_uom"decoration-danger="unit_amount&gt;24"/>
                                <fieldname="currency_id"invisible="1"/>
                            </group>
                        </group>
                    </sheet>
                </form>
            </field>
        </record>

        <recordid="timesheet_view_form_user"model="ir.ui.view">
            <fieldname="name">account.analytic.line.tree.with.user</field>
            <fieldname="model">account.analytic.line</field>
            <fieldname="inherit_id"ref="hr_timesheet.hr_timesheet_line_form"/>
            <fieldname="mode">primary</field>
            <fieldname="priority">10</field>
            <fieldname="arch"type="xml">
                <xpathexpr="//field[@name='company_id']"position="before">
                    <fieldname="employee_id"required="1"options='{"no_open":True}'context="{'active_test':True}"/>
                    <fieldname="user_id"invisible="1"/>
                </xpath>
            </field>
        </record>

        <recordid="hr_timesheet_line_search"model="ir.ui.view">
            <fieldname="name">account.analytic.line.search</field>
            <fieldname="model">account.analytic.line</field>
            <fieldname="arch"type="xml">
                <searchstring="Timesheet">
                    <fieldname="date"/>
                    <fieldname="employee_id"/>
                    <fieldname="department_id"/>
                    <fieldname="project_id"/>
                    <fieldname="task_id"/>
                    <fieldname="name"/>
                    <filtername="mine"string="MyTimesheets"domain="[('user_id','=',uid)]"/>
                    <separator/>
                    <filtername="month"string="Date"date="date"/>
                    <groupexpand="0"string="GroupBy">
                        <filterstring="Project"name="groupby_project"domain="[]"context="{'group_by':'project_id'}"/>
                        <filterstring="Task"name="groupby_task"domain="[]"context="{'group_by':'task_id'}"/>
                        <filterstring="Date"name="groupby_date"domain="[]"context="{'group_by':'date'}"help="TimesheetbyDate"/>
                        <filterstring="Department"name="groupby_department"domain="[]"context="{'group_by':'department_id'}"/>
                        <filterstring="Employee"name="groupby_employee"domain="[]"context="{'group_by':'employee_id'}"/>
                    </group>
                </search>
            </field>
        </record>

        <recordid="hr_timesheet_line_my_timesheet_search"model="ir.ui.view">
            <fieldname="name">view.search.my.timesheet.menu</field>
            <fieldname="model">account.analytic.line</field>
            <fieldname="inherit_id"ref="hr_timesheet_line_search"/>
            <fieldname="mode">primary</field>
            <fieldname="arch"type="xml">
                <fieldname="employee_id"position="replace"/>
                <fieldname="department_id"position="replace"/>
                <filtername="mine"position="replace"/>
                <filtername="groupby_department"position="replace"/>
                <filtername="groupby_employee"position="replace"/>
            </field>
        </record>

        <recordid="view_kanban_account_analytic_line"model="ir.ui.view">
            <fieldname="name">account.analytic.line.kanban</field>
            <fieldname="model">account.analytic.line</field>
            <fieldname="arch"type="xml">
                <kanbanclass="o_kanban_mobile"sample="1">
                    <fieldname="date"/>
                    <fieldname="employee_id"/>
                    <fieldname="user_id"/>
                    <fieldname="name"/>
                    <fieldname="project_id"/>
                    <fieldname="task_id"context="{'default_project_id':project_id}"domain="[('project_id','=',project_id)]"/>
                    <fieldname="unit_amount"widget="timesheet_uom"/>
                    <templates>
                        <tt-name="kanban-box">
                            <divt-attf-class="oe_kanban_global_click">
                                <divclass="row">
                                    <divclass="col-2">
                                        <imgt-att-src="kanban_image('hr.employee','image_128',record.employee_id.raw_value)"t-att-title="record.employee_id.value"t-att-alt="record.employee_id.value"class="o_image_40_coverfloat-left"/>
                                    </div>
                                    <divclass="col-10">
                                        <div>
                                            <strong><tt-esc="record.project_id.value"/></strong>
                                        </div>
                                        <divclass="text-muted">
                                            <span>
                                                <tt-esc="record.name.value"/>
                                            </span>
                                            <divclass="float-right"id="bottom_right"/>
                                        </div>
                                    </div>
                                </div>
                                <hrclass="mt4mb4"/>
                                <span>
                                    <iclass="fafa-calendar"role="img"aria-label="Date"title="Date"></i>
                                    <tt-esc="record.date.value"/>
                                </span>
                                <spanclass="float-right">
                                    <strong>Duration:</strong><fieldname="unit_amount"widget="timesheet_uom"decoration-danger="unit_amount&gt;24"/>
                                </span>
                            </div>
                        </t>
                    </templates>
                </kanban>
            </field>
        </record>

        <!--
            MenusandActions
        -->
        <recordid="act_hr_timesheet_line"model="ir.actions.act_window">
            <fieldname="name">MyTimesheets</field>
            <fieldname="res_model">account.analytic.line</field>
            <fieldname="view_mode">tree,form,kanban</field>
            <fieldname="domain">[('project_id','!=',False),('user_id','=',uid)]</field>
            <fieldname="context">{
                "search_default_week":1,
            }</field>
            <fieldname="search_view_id"ref="hr_timesheet_line_my_timesheet_search"/>
            <fieldname="help"type="html">
              <pclass="o_view_nocontent_smiling_face">
                Noactivitiesfound.Let'sstartanewone!
              </p>
              <p>
                Trackyourworkinghoursbyprojectseverydayandinvoicethistimetoyourcustomers.
              </p>
            </field>
        </record>

        <recordid="act_hr_timesheet_line_view_tree"model="ir.actions.act_window.view">
            <fieldname="view_mode">tree</field>
            <fieldname="sequence"eval="4"/>
            <fieldname="view_id"ref="hr_timesheet_line_tree"/>
            <fieldname="act_window_id"ref="act_hr_timesheet_line"/>
        </record>

        <recordid="act_hr_timesheet_line_view_form"model="ir.actions.act_window.view">
            <fieldname="view_mode">form</field>
            <fieldname="sequence"eval="5"/>
            <fieldname="view_id"ref="hr_timesheet_line_form"/>
            <fieldname="act_window_id"ref="act_hr_timesheet_line"/>
        </record>

        <recordid="act_hr_timesheet_line_view_kanban"model="ir.actions.act_window.view">
            <fieldname="view_mode">kanban</field>
            <fieldname="sequence">6</field>
            <fieldname="view_id"ref="hr_timesheet.view_kanban_account_analytic_line"/>
            <fieldname="act_window_id"ref="act_hr_timesheet_line"/>
        </record>

        <menuitemid="timesheet_menu_activity_mine"
            name="MyTimesheets"
            parent="menu_hr_time_tracking"
            action="act_hr_timesheet_line"/>

        <recordid="timesheet_action_task"model="ir.actions.act_window">
            <fieldname="name">Task'sTimesheets</field>
            <fieldname="res_model">account.analytic.line</field>
            <fieldname="domain">[('task_id','in',active_ids)]</field>
            <fieldname="view_mode">tree</field>
            <fieldname="view_id"ref="timesheet_view_tree_user"/>
        </record>

        <recordid="timesheet_action_project"model="ir.actions.act_window">
            <fieldname="name">Project'sTimesheets</field>
            <fieldname="res_model">account.analytic.line</field>
            <fieldname="domain">[('project_id','in',active_ids)]</field>
            <fieldname="view_mode">tree</field>
            <fieldname="view_id"ref="timesheet_view_tree_user"/>
        </record>

        <recordid="timesheet_action_all"model="ir.actions.act_window">
            <fieldname="name">AllTimesheets</field>
            <fieldname="res_model">account.analytic.line</field>
            <fieldname="view_mode">tree,form,pivot,kanban</field>
            <fieldname="search_view_id"ref="hr_timesheet_line_search"/>
            <fieldname="domain">[('project_id','!=',False)]</field>
            <fieldname="context">{
                'search_default_week':1,
            }</field>
            <fieldname="help"type="html">
                <pclass="o_view_nocontent_smiling_face">
                    Noactivitiesfound.Let'sstartanewone!
              </p>
              <p>
                Trackyourworkinghoursbyprojectseverydayandinvoicethistimetoyourcustomers.
              </p>
            </field>
        </record>

        <recordid="timesheet_action_view_all_tree"model="ir.actions.act_window.view">
            <fieldname="sequence"eval="4"/>
            <fieldname="view_mode">tree</field>
            <fieldname="view_id"ref="timesheet_view_tree_user"/>
            <fieldname="act_window_id"ref="timesheet_action_all"/>
        </record>

        <recordid="timesheet_action_view_all_form"model="ir.actions.act_window.view">
            <fieldname="sequence"eval="5"/>
            <fieldname="view_mode">form</field>
            <fieldname="view_id"ref="timesheet_view_form_user"/>
            <fieldname="act_window_id"ref="timesheet_action_all"/>
        </record>

        <recordid="timesheet_action_view_all_pivot"model="ir.actions.act_window.view">
            <fieldname="sequence"eval="6"/>
            <fieldname="view_mode">pivot</field>
            <fieldname="view_id"ref="view_hr_timesheet_line_pivot"/>
            <fieldname="act_window_id"ref="timesheet_action_all"/>
        </record>

        <recordid="timesheet_action_view_all_kanban"model="ir.actions.act_window.view">
            <fieldname="view_mode">kanban</field>
            <fieldname="sequence">7</field>
            <fieldname="view_id"ref="hr_timesheet.view_kanban_account_analytic_line"/>
            <fieldname="act_window_id"ref="timesheet_action_all"/>
        </record>

        <menuitemid="timesheet_menu_activity_all"
            name="AllTimesheets"
            parent="menu_hr_time_tracking"
            action="timesheet_action_all"
            groups="hr_timesheet.group_hr_timesheet_approver"/>

    </data>
</flectra>
