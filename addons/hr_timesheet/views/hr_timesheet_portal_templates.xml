<?xmlversion="1.0"encoding="utf-8"?>
<flectra>

    <templateid="portal_layout"name="Portallayout:timesheetmenuentry"inherit_id="portal.portal_breadcrumbs"priority="35">
        <xpathexpr="//ol[hasclass('o_portal_submenu')]"position="inside">
            <lit-if="page_name=='timesheet'ortimesheet"t-attf-class="breadcrumb-item#{'active'ifnottimesheetelse''}">
                <t>Timesheets</t>
            </li>
        </xpath>
    </template>

    <templateid="portal_my_home_timesheet"name="ShowTimesheets"customize_show="True" inherit_id="portal.portal_my_home"priority="45">
        <xpathexpr="//div[hasclass('o_portal_docs')]"position="inside">
            <tt-call="portal.portal_docs_entry">
                <tt-set="title">Timesheets</t>
                <tt-set="url"t-value="'/my/timesheets'"/>
                <tt-set="placeholder_count"t-value="'timesheet_count'"/>
            </t>
        </xpath>
    </template>

    <templateid="portal_my_timesheets"name="MyTimesheets">
        <tt-call="portal.portal_layout">
            <tt-set="breadcrumbs_searchbar"t-value="True"/>

            <tt-call="portal.portal_searchbar">
                <tt-set="title">Timesheets</t>
            </t>
            <tt-if="notgrouped_timesheets">
                <divclass="alertalert-warningmt8"role="alert">
                    Therearenotimesheets.
                </div>
            </t>
            <tt-if="grouped_timesheets">
                <tt-call="portal.portal_table">
                    <tt-foreach="grouped_timesheets"t-as="timesheets_with_hours">
                        <tt-set="timesheets"t-value="timesheets_with_hours[0]"/>
                        <tt-set="hours_spent"t-value="timesheets_with_hours[1]"/>
                        <theadstyle="font-size:0.8rem">
                            <trt-if="notgroupby=='none'"t-attf-class="{{'thead-light'}}">
                                <tt-if="groupby=='project'">
                                    <tht-if="groupby=='project'"colspan="5">
                                        <emclass="font-weight-normaltext-muted">Timesheetsforproject:</em>
                                        <spant-field="timesheets[0].project_id.name"/>
                                    </th>
                                    <thcolspan="1"class="text-righttext-muted">
                                        <tt-if="is_uom_day">
                                            Total:<spanclass="text-muted"t-esc="timesheets[0]._convert_hours_to_days(hours_spent)"t-options='{"widget":"timesheet_uom"}'/>
                                        </t>
                                        <tt-else="">
                                            Total:<spanclass="text-muted"t-esc="hours_spent"t-options='{"widget":"float_time"}'/>
                                        </t>
                                    </th>
                                </t>
                                <tt-elif="groupby=='task'">
                                    <thcolspan="5">
                                        <emclass="font-weight-normaltext-muted">Timesheetsfortask:</em>
                                        <spant-field="timesheets[0].task_id.name"/>
                                    </th>
                                    <thcolspan="1"class="text-righttext-muted">
                                        <tt-if="is_uom_day">
                                            Total:<spant-esc="timesheets[0]._convert_hours_to_days(hours_spent)"t-options='{"widget":"timesheet_uom"}'/>
                                        </t>
                                        <tt-else="">
                                            Total:<spant-esc="hours_spent"t-options='{"widget":"float_time"}'/>
                                        </t>
                                    </th>
                                </t>
                                <tt-elif="groupby=='date'">
                                    <thcolspan="5">
                                        <emclass="font-weight-normaltext-muted">Timesheetson</em>
                                        <spant-field="timesheets[0].date"/>
                                    </th>
                                    <thcolspan="1"class="text-righttext-muted">
                                        <tt-if="is_uom_day">
                                            Total:<spant-esc="timesheets[0]._convert_hours_to_days(hours_spent)"t-options='{"widget":"timesheet_uom"}'/>
                                        </t>
                                        <tt-else="">
                                            Total:<spant-esc="hours_spent"t-options='{"widget":"float_time"}'/>
                                        </t>
                                    </th>
                                </t>
                                <tt-elif="groupby=='employee'">
                                    <thcolspan="5">
                                        <emclass="font-weight-normaltext-muted">Timesheetsforemployee:</em>
                                        <spant-field="timesheets[0].employee_id.name"/>
                                    </th>
                                    <thcolspan="1"class="text-righttext-muted">
                                        <tt-if="is_uom_day">
                                            Total:<spant-esc="timesheets[0]._convert_hours_to_days(hours_spent)"t-options='{"widget":"timesheet_uom"}'/>
                                        </t>
                                        <tt-else="">
                                            Total:<spant-esc="hours_spent"t-options='{"widget":"float_time"}'/>
                                        </t>
                                    </th>
                                </t>
                            </tr>
                            <trt-else="">
                                <divstyle="text-align:right;"class="mr-2mb-1text-muted">
                                    <tt-if="is_uom_day">
                                        Total:<spant-esc="timesheets[0]._convert_hours_to_days(hours_spent)"t-options='{"widget":"timesheet_uom"}'/>
                                    </t>
                                    <tt-else="">
                                        Total:<spant-esc="hours_spent"t-options='{"widget":"float_time"}'/>
                                    </t>
                                </div>
                            </tr>
                            <tr>
                                <tht-if="notgroupby=='date'">Date</th>
                                <tht-if="notgroupby=='employee'">Employee</th>
                                <tht-if="notgroupby=='project'">Project</th>
                                <tht-if="notgroupby=='task'">Task</th>
                                <th>Description</th>
                                <tht-if="is_uom_day"class="text-right">DaysSpent</th>
                                <tht-else=""class="text-right">HoursSpent</th>
                            </tr>
                        </thead>
                        <tbodystyle="font-size:0.8rem">
                            <tt-foreach="timesheets"t-as="timesheet">
                                <tr>
                                    <tdt-if="notgroupby=='date'"><spant-field="timesheet.date"t-options='{"widget":"date"}'/></td>
                                    <tdt-if="notgroupby=='employee'"><spant-field="timesheet.employee_id"t-att-title="timesheet.employee_id.display_name"/></td>
                                    <tdt-if="notgroupby=='project'"><spant-field="timesheet.project_id"t-att-title="timesheet.project_id.display_name"/></td>
                                    <tdt-if="notgroupby=='task'"><spant-field="timesheet.task_id"t-att-title="timesheet.task_id.display_name"/></td>
                                    <td><spant-esc="timesheet.name"t-att-title="timesheet.name"/></td>
                                    <tdclass="text-right">
                                        <spant-if="is_uom_day"t-esc="timesheet._get_timesheet_time_day()"t-options='{"widget":"timesheet_uom"}'/>
                                        <spant-else=""t-field="timesheet.unit_amount"t-options='{"widget":"float_time"}'/>
                                    </td>
                                </tr>
                            </t>
                        </tbody>
                    </t>
                </t>
            </t>
        </t>
    </template>

</flectra>
