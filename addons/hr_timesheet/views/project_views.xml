<?xmlversion="1.0"encoding="utf-8"?>
<flectra>
    <data>
        <recordid="act_hr_timesheet_line_by_project"model="ir.actions.act_window">
            <fieldname="name">Timesheets</field>
            <fieldname="res_model">account.analytic.line</field>
            <fieldname="view_mode">tree,form</field>
            <fieldname="view_id"ref="timesheet_view_tree_user"/>
            <fieldname="domain">[('project_id','!=',False)]</field>
            <fieldname="context">{"default_project_id":active_id,"search_default_project_id":[active_id]}</field>
            <fieldname="search_view_id"ref="hr_timesheet_line_search"/>
            <fieldname="help"type="html">
              <pclass="o_view_nocontent_smiling_face">
                Recordanewactivity
              </p><p>
                Trackyourworkinghoursbyprojectseverydayandinvoicethistimetoyourcustomers.
              </p>
            </field>
        </record>

        <recordid="project_project_view_form_simplified_inherit_timesheet"model="ir.ui.view">
            <fieldname="name">project.project.view.form.simplified.inherit.timesheet</field>
            <fieldname="model">project.project</field>
            <fieldname="inherit_id"ref="project.project_project_view_form_simplified"/>
            <fieldname="priority">24</field>
            <fieldname="arch"type="xml">
                <fieldname="user_id"position="after">
                    <fieldname="allow_timesheets"/>
                </field>
            </field>
        </record>

        <recordid="project_invoice_form"model="ir.ui.view">
            <fieldname="name">Inheritprojectform:InvoicingData</field>
            <fieldname="model">project.project</field>
            <fieldname="inherit_id"ref="project.edit_project"/>
            <fieldname="priority">24</field>
            <fieldname="arch"type="xml">
                <divname="button_box"position="inside">
                    <buttonclass="oe_stat_button"name="%(act_hr_timesheet_line_by_project)d"type="action"icon="fa-calendar"attrs="{'invisible':[('allow_timesheets','=',False)]}"groups="hr_timesheet.group_hr_timesheet_user">
                        <divclass="o_field_widgeto_stat_info">
                            <divclass="oe_inline">
                                <spanclass="o_stat_valuemr-1">
                                    <fieldname="total_timesheet_time"widget="statinfo"nolabel="1"/>
                                </span>
                                <spanclass="o_stat_value">
                                    <fieldname="timesheet_encode_uom_id"class="o_stat_text"options="{'no_open':True}"/>
                                </span>
                            </div>
                            <spanclass="o_stat_text">Recorded</span>
                        </div>
                    </button>
                </div>
                <xpathexpr="//div[@id='rating_settings']/.."position="before">
                    <divclass="rowmt16o_settings_container">
                        <divclass="col-lg-6o_setting_box" id="timesheet_settings">
                            <divclass="o_setting_left_pane">
                                <fieldname="allow_timesheets"/>
                            </div>
                            <divclass="o_setting_right_pane">
                                <labelfor="allow_timesheets"string="Timesheets"/>
                                <divclass="text-muted">
                                    Logtimeontasks
                                </div>
                            </div>
                        </div>
                    </div>
                </xpath>
            </field>
        </record>

        <recordmodel="ir.ui.view"id="view_task_form2_inherited">
            <fieldname="name">project.task.form.inherited</field>
            <fieldname="model">project.task</field>
            <fieldname="inherit_id"ref="project.view_task_form2"/>
            <fieldname="groups_id"eval="[(6,0,(ref('hr_timesheet.group_hr_timesheet_user'),))]"/>
            <fieldname="arch"type="xml">
                <xpathexpr="//notebook/page[@name='description_page']"position="after">
                    <fieldname="analytic_account_active"invisible="1"/>
                    <fieldname="allow_timesheets"invisible="1"/>
                    <fieldname="allow_subtasks"invisible="1"/>
                    <fieldname="encode_uom_in_days"invisible="1"/>
                    <pagestring="Timesheets"id="timesheets_tab"attrs="{'invisible':[('allow_timesheets','=',False)]}">
                        <group>
                            <group>
                                <divclass="o_td_label">
                                    <labelfor="planned_hours"string="InitiallyPlannedHours"attrs="{'invisible':[('encode_uom_in_days','=',True)]}"/>
                                    <labelfor="planned_hours"string="InitiallyPlannedDays"attrs="{'invisible':[('encode_uom_in_days','=',False)]}"/>
                                </div>
                                <fieldname="planned_hours"widget="timesheet_uom_no_toggle"nolabel="1"/>
                                <divclass="o_td_label"groups="project.group_subtask_project"attrs="{'invisible':['|',('allow_subtasks','=',False),('subtask_count','=',0)]}">
                                    <labelfor="subtask_planned_hours"string="Sub-tasksPlannedHours"attrs="{'invisible':[('encode_uom_in_days','=',True)]}"/>
                                    <labelfor="subtask_planned_hours"string="Sub-tasksPlannedDays"attrs="{'invisible':[('encode_uom_in_days','=',False)]}"/>
                                </div>
                                <fieldname="subtask_planned_hours"widget="timesheet_uom_no_toggle"nolabel="1"groups="project.group_subtask_project"attrs="{'invisible':['|',('allow_subtasks','=',False),('subtask_count','=',0)]}"/>
                            </group>
                            <group>
                                <fieldname="progress"widget="progressbar"/>
                            </group>
                        </group>
                        <groupname="timesheet_error"attrs="{'invisible':[('analytic_account_active','!=',False)]}">
                            <divclass="alertalert-warning"role="alert">
                                Youcannotlogtimesheetsonthisprojectsinceitislinkedtoaninactiveanalyticaccount.Pleasechangethisaccount,orreactivatethecurrentonetotimesheetontheproject.
                            </div>
                        </group>
                    <fieldname="timesheet_ids"mode="tree,kanban"attrs="{'invisible':[('analytic_account_active','=',False)]}"context="{'default_project_id':project_id,'default_name':''}">
                        <treeeditable="bottom"string="TimesheetActivities"default_order="date">
                            <fieldname="date"/>
                            <fieldname="user_id"invisible="1"/>
                            <fieldname="employee_id"required="1"widget="many2one_avatar_employee"context="{'active_test':True}"/>
                            <fieldname="name"required="0"/>
                            <fieldname="unit_amount"widget="timesheet_uom"decoration-danger="unit_amount&gt;24"/>
                            <fieldname="project_id"invisible="1"/>
                            <fieldname="task_id"invisible="1"/>
                            <fieldname="company_id"invisible="1"/>
                        </tree>
                        <kanbanclass="o_kanban_mobile">
                            <fieldname="date"/>
                            <fieldname="user_id"/>
                            <fieldname="employee_id"widget="many2one_avatar_employee"context="{'active_test':True}"/>
                            <fieldname="name"/>
                            <fieldname="unit_amount"decoration-danger="unit_amount&gt;24"/>
                            <fieldname="project_id"/>
                            <fieldname="task_id"invisible="1"/>
                            <templates>
                                <tt-name="kanban-box">
                                    <divt-attf-class="oe_kanban_cardoe_kanban_global_click">
                                        <divclass="row">
                                            <divclass="col-6">
                                                <strong><span><tt-esc="record.employee_id.value"/></span></strong>
                                            </div>
                                            <divclass="col-6pull-righttext-right">
                                                <strong><tt-esc="record.date.value"/></strong>
                                            </div>
                                        </div>
                                        <divclass="row">
                                            <divclass="col-6text-muted">
                                                <span><tt-esc="record.name.value"/></span>
                                            </div>
                                            <divclass="col-6">
                                                <spanclass="pull-righttext-right">
                                                    <fieldname="unit_amount"widget="float_time"/>
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                </t>
                            </templates>
                        </kanban>
                        <form string="TimesheetActivities">
                            <sheet>
                                 <group>
                                    <fieldname="date"/>
                                    <fieldname="user_id"invisible="1"/>
                                    <fieldname="employee_id"required="1"widget="many2one_avatar_employee"context="{'active_test':True}"/>
                                    <fieldname="name"required="0"/>
                                    <fieldname="unit_amount"string="Duration"widget="float_time"decoration-danger="unit_amount&gt;24"/>
                                    <fieldname="project_id"invisible="1"/>
                                    <fieldname="task_id"invisible="1"/>
                                    <fieldname="company_id"invisible="1"/>
                                </group>
                            </sheet>
                        </form>
                    </field>
                    <groupattrs="{'invisible':[('analytic_account_active','=',False)]}">
                        <groupclass="oe_subtotal_footeroe_right"name="project_hours">
                            <span>
                                <labelclass="font-weight-bold"for="effective_hours"string="HoursSpent"attrs="{'invisible':[('encode_uom_in_days','=',True)]}"/>
                                <labelclass="font-weight-bold"for="effective_hours"string="DaysSpent"attrs="{'invisible':[('encode_uom_in_days','=',False)]}"/>
                            </span>
                            <fieldname="effective_hours"widget="timesheet_uom"nolabel="1"/>

                            <buttonname="action_view_subtask_timesheet"type="object"class="o_td_labelo_form_labelo_form_subtask_buttonoe_inlineoe_linkmr-0"attrs="{'invisible':['|',('allow_subtasks','=',False),('subtask_effective_hours','=',0.0)]}">
                                <spanclass="text-nowrap"attrs="{'invisible':[('encode_uom_in_days','=',True)]}">Sub-tasksHoursSpent</span>
                                <spanclass="text-nowrap"attrs="{'invisible':[('encode_uom_in_days','=',False)]}">Sub-tasksDaysSpent</span>
                            </button>
                            <fieldname="subtask_effective_hours"class="mt-2"widget="timesheet_uom"
                                   attrs="{'invisible':['|',('allow_subtasks','=',False),('subtask_effective_hours','=',0.0)]}"nolabel="1"/>
                            <span>
                                <labelclass="font-weight-bold"for="total_hours_spent"string="TotalHours"
                                       attrs="{'invisible':['|','|',('allow_subtasks','=',False),('subtask_effective_hours','=',0.0),('encode_uom_in_days','=',True)]}"/>
                                <labelclass="font-weight-bold"for="total_hours_spent"string="TotalDays"
                                       attrs="{'invisible':['|','|',('allow_subtasks','=',False),('subtask_effective_hours','=',0.0),('encode_uom_in_days','=',False)]}"/>
                            </span>
                            <fieldname="total_hours_spent"widget="timesheet_uom"class="oe_subtotal_footer_separator"nolabel="1"
                                   attrs="{'invisible':['|',('allow_subtasks','=',False),('subtask_effective_hours','=',0.0)]}"/>
                            <span>
                                <labelclass="font-weight-bold"for="remaining_hours"string="RemainingHours"
                                       attrs="{'invisible':['|',('planned_hours','=',0.0),('encode_uom_in_days','=',True)]}"/>
                                <labelclass="font-weight-bold"for="remaining_hours"string="RemainingDays"
                                       attrs="{'invisible':['|',('planned_hours','=',0.0),('encode_uom_in_days','=',False)]}"/>
                            </span>
                            <fieldname="remaining_hours"widget="timesheet_uom"class="oe_subtotal_footer_separator"
                                   attrs="{'invisible':[('planned_hours','=',0.0)]}"nolabel="1"/>
                        </group>
                    </group>
                </page>
                </xpath>
            </field>
        </record>

        <recordid="view_task_tree2_inherited"model="ir.ui.view">
            <fieldname="name">project.task.tree.inherited</field>
            <fieldname="model">project.task</field>
            <fieldname="inherit_id"ref="project.view_task_tree2"/>
            <fieldeval="2"name="priority"/>
            <fieldname="arch"type="xml">
                <fieldname="company_id"position="after">
                    <fieldname="allow_subtasks"invisible="1"/>
                    <fieldname="planned_hours"widget="timesheet_uom_no_toggle"sum="InitiallyPlannedHours"optional="hide"/>
                    <fieldname="effective_hours"widget="timesheet_uom"sum="EffectiveHours"optional="show"/>
                    <fieldname="remaining_hours"widget="timesheet_uom"sum="RemainingHours"optional="hide"decoration-danger="progress&gt;=100"decoration-warning="progress&gt;=80andprogress&lt;100"/>
                    <fieldname="subtask_effective_hours"widget="timesheet_uom"attrs="{'invisible':[('allow_subtasks','=',False)]}"optional="hide"/>
                    <fieldname="total_hours_spent"widget="timesheet_uom"attrs="{'invisible':[('allow_subtasks','=',False)]}"optional="hide"/>
                    <fieldname="progress"widget="progressbar"optional="show"groups="hr_timesheet.group_hr_timesheet_user"/>
                </field>
            </field>
        </record>

        <recordid="view_project_kanban_inherited"model="ir.ui.view">
            <fieldname="name">project.project.timesheet.kanban.inherited</field>
            <fieldname="model">project.project</field>
            <fieldname="inherit_id"ref="project.view_project_kanban"/>
            <fieldname="priority">24</field>
            <fieldname="arch"type="xml">
                <fieldname="partner_id"position="after">
                    <fieldname="allow_timesheets"invisible="1"/>
                </field>
                <xpathexpr="//div[hasclass('o_project_kanban_boxes')]"position="inside">
                    <at-if="record.allow_timesheets.raw_value"class="o_project_kanban_boxo_project_timesheet_box"name="%(act_hr_timesheet_line_by_project)d"type="action"groups="hr_timesheet.group_hr_timesheet_user">
                        <div>
                            <spanclass="o_label">Timesheets</span>
                        </div>
                    </a>
                </xpath>
                <xpathexpr="//a[@name='action_view_account_analytic_line']"position="attributes">
                    <attributename="t-if">record.analytic_account_id.raw_valueand!record.allow_timesheets.raw_value</attribute>
                </xpath>
            </field>
        </record>

        <recordid="view_task_kanban_inherited_progress"model="ir.ui.view">
            <fieldname="name">project.task.timesheet.kanban.inherited.progress</field>
            <fieldname="model">project.task</field>
            <fieldname="inherit_id"ref="project.view_task_kanban"/>
            <fieldname="arch"type="xml">
                <templatesposition="before">
                    <fieldname="progress"/>
                    <fieldname="remaining_hours"/>
                    <fieldname="planned_hours"/>
                    <fieldname="allow_timesheets"/>
                    <fieldname="encode_uom_in_days"invisible="1"/>
                </templates>
                <divclass="oe_kanban_bottom_left"position="inside">
                   <tname="planned_hours"t-if="record.planned_hours.raw_value&gt;0andrecord.allow_timesheets.raw_value">
                        <tt-set="badge"t-value=""/>
                        <tt-set="badge"t-value="'badge-warning'"t-if="record.progress.raw_value&gt;=80andrecord.progress.raw_value&lt;=100"/>
                        <tt-set="badge"t-value="'badge-danger'"t-if="record.remaining_hours.raw_value&lt;0"/>
                        <tt-set="title"t-value="'Remainingdays'"t-if="record.encode_uom_in_days.raw_value"/>
                        <tt-set="title"t-value="'Remaininghours'"t-else=""/>
                        <divt-attf-class="oe_kanban_alignbadge{{badge}}"t-att-title="title">
                            <fieldname="remaining_hours"widget="timesheet_uom"/>
                        </div>
                   </t>
                </div>
             </field>
         </record>

        <recordid="project_task_view_search"model="ir.ui.view">
            <fieldname="name">project.task.view.search.inherit.sale.timesheet.enterprise</field>
            <fieldname="model">project.task</field>
            <fieldname="inherit_id"ref="project.view_task_search_form"/>
            <fieldname="arch"type="xml">
                <xpathexpr="//filter[@name='late']"position='after'>
                    <filterstring="TasksinOvertime"name="overtime"domain="[('overtime','&gt;',0)]"/>
                </xpath>
            </field>
        </record>

    </data>
</flectra>
