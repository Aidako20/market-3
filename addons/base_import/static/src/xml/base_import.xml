<templates>
    <tt-name="base_import.ImportMenu"owl="1">
        <liclass="o_menu_itemo_import_menu"role="menuitem">
            <buttontype="button"class="dropdown-item"t-on-click="_onImportClick">
                Importrecords
            </button>
        </li>
    </t>

    <tt-name="ImportView">
        <tt-set="_id"t-value="_.uniqueId('export')"/>
        <formaction=""method="post"enctype="multipart/form-data"class="oe_import">
            <inputtype="hidden"name="csrf_token"t-att-value="csrf_token"/>
            <inputtype="hidden"name="import_id"/>
            <divclass="oe_import_boxd-none">
                <inputaccept=".csv,.xls,.xlsx,.xlsm,.ods"t-attf-id="file_#{_id}"
                      name="file"class="oe_import_file"type="file"style="display:none;"/>
                <divclass="oe_import_with_filerow">
                    <ahref="#"class="oe_import_togglecol-sm-12">
                        FormattingOptionsâ€¦</a>
                        <divclass="rowcol-sm-12">
                            <divclass="oe_import_toggledoe_import_optionsjs_import_optionscol-md-6col-lg-4">
                                <pt-foreach="widget.opts"t-as="option">
                                    <!--no@name,avoidsubmissionwhenfile_updatecalled-->
                                    <labelt-attf-for="#{option.name}_#{_id}">
                                        <tt-esc="option.label"/></label>
                                    <inputt-attf-id="#{option.name}_#{_id}"
                                           t-attf-class="oe_import_#{option.name}"
                                           style="width:50%;"
                                           t-att-value="option.value"/>
                                </p>
                            </div>
                            <divt-foreach="[widget.parse_opts_formats,widget.parse_opts_separators]"t-as="options"class="oe_import_toggledoe_import_optionscol-md-6col-lg-4">
                                <pt-foreach="options"t-as="option">
                                    <!--no@name,avoidsubmissionwhenfile_updatecalled-->
                                    <labelt-attf-for="#{option.name}_#{_id}">
                                        <tt-esc="option.label"/></label>
                                    <inputt-attf-id="#{option.name}_#{_id}"
                                           t-attf-class="oe_import_#{option.name}"
                                           style="width:50%;"
                                           t-att-value="option.value"/>
                                </p>
                            </div>
                        </div>
                </div>
            </div>
            <divclass="o_import_batch_alertalertalert-warningd-none">
                Duetoitslargesize,thefilewillbeimportedbybatches.
            </div>
            <divclass="o_import_partial_alertalertalert-warningd-none">
                Click'Resume'toproceedwiththeimport,resumingatline
                <spanclass="o_import_partial_count">0</span>.<br/>
                Youcantestorreloadyourfilebeforeresumingtheimport.
            </div>

            <divclass="oe_import_with_filed-none">
                <h2>Mapyourcolumnstoimport</h2>
                <divclass="oe_import_debug_options">
                    <divtitle="Ifthemodelusesopenchatter,historytrackingwillsetupsubscriptionsandsendnotificationsduringtheimport,butleadtoaslowerimport."class="oe_import_debug_option">
                        <inputtype="checkbox"id="oe_import_tracking"/>
                        <labelfor="oe_import_tracking">
                            Trackhistoryduringimport
                        </label>
                    </div>

                    <divclass="oe_import_has_multiple_sheetsjs_import_options">
                        <labelfor="oe_import_sheet">SelectedSheet:</label>
                        <inputclass="oe_import_sheet"id="oe_import_sheet"/>
                    </div>

                    <div>
                        <inputtype="checkbox"class="oe_import_has_header"
                               id="oe_import_has_header"checked="checked"/>
                        <labelfor="oe_import_has_header">Thefirstrow
                         containsthelabelofthecolumn</label>
                    </div>
                    <divclass="js_import_optionsoe_import_debug_optionoe_import_batch_limit">
                        <labelfor="oe_import_batch_limit">Batchlimit</label>
                        <inputid="oe_import_batch_limit"value="2000"/>
                    </div>
                    <divclass="js_import_optionsoe_import_debug_option"title="Warning:ignoresthelabelsline,emptylinesand
                            linescomposedonlyofemptycells">
                        <labelfor="oe_import_row_start">Startatline</label>
                        <inputid="oe_import_row_start"value="1"/>
                    </div>
                    <divclass="oe_import_debug_option">
                        <inputtype="checkbox"class="oe_import_advanced_mode"checked="checked"
                               id="oe_import_advanced_mode"/>
                        <labelfor="oe_import_advanced_mode">Showfieldsofrelationfields(advanced)</label>
                    </div>
                </div>
                <pclass="oe_import_noheaderstext-muted">Ifthefilecontains
                thecolumnnames,Flectracantryauto-detectingthe
                fieldcorrespondingtothecolumn.Thismakesimports
                simplerespeciallywhenthefilehasmanycolumns.</p>

                <divclass="oe_import_error_report"></div>
                <divclass="table-responsive">
                    <tableclass="table-stripedtable-borderedoe_import_gridbg-white"/>
                </div>
                <h6class="oe_padding">Thisisapreviewofthefirst10rowsofyourfile</h6>
            </div>
            <divclass="o_view_nocontent">
                <divclass="o_nocontent_help">
                    <pclass="o_view_nocontent_smiling_face">
                        SelectaCSVorExcelfiletoimport.
                    </p>
                    <p>
                        Excelfilesarerecommendedasfieldsformattingisautomatic.
                    </p>
                    <divclass="mt16mb4">NeedHelp?</div>
                    <divt-foreach="widget.importTemplates"t-as="template">
                        <at-att-href="template.template"aria-label="Download"title="Download">
                            <iclass="fafa-download"/><span><tt-esc="template.label"/></span>
                        </a>
                    </div>
                    <ahref="https://doc.flectrahq.com/2.0/applications/general/base_import/import_faq.html"target="new">ImportFAQ</a>
                </div>
            </div>
        </form>
    </t>

    <tt-name="ImportView.buttons">
        <buttontype="button"class="btnbtn-primaryo_import_importo_import_import_fulld-none">Import</button>
        <buttontype="button"class="btnbtn-primaryo_import_importo_import_import_partiald-none">Resume</button>
        <buttontype="button"class="btnbtn-secondaryo_import_validated-none">Test</button>
        <buttontype="button"class="btnbtn-primaryoe_import_file">LoadFile</button>
        <buttontype="button"class="btnbtn-secondaryo_import_cancel">Cancel</button>
    </t>

    <tt-name="ImportView.create_record_option">
        <divclass="mt4">
            <labeltitle="Createsnewrecordsiftheycan'tbefound(insteadoffailingtoimport).Notethatthevalueinthecolumnwillbeusedasthenewrecord's'name',andassumesthisissufficienttocreatetherecord.">
                <inputtype="checkbox"class="o_import_create_option"/>
                Createifdoesn'texist
            </label>
        </div>
    </t>

    <tt-name="ImportView.preview">
        <thead>
            <trt-if="headers"class="oe_import_grid-header">
                <tdt-foreach="headers"t-as="header"class="oe_import_grid-cell"
                    ><spanclass="o_import_header_nameo_single_line_text"t-att-title="header"><tt-esc="header"/></span></td>
            </tr>
            <trclass="oe_import_fields">
                <!--Iterateonfirstrowtoensurewehaveallcolumns-->
                <tdt-foreach="preview[0]"t-as="column">
                    <inputclass="oe_import_match_field"/>
                </td>
            </tr>
        </thead>
        <tbody>
            <trt-foreach="preview"t-as="row"class="oe_import_grid-row">
                <tdt-foreach="row"t-as="cell"class="oe_import_grid-cell">
                    <!--contentcanbedisplayedonseverallinesifitcontainswhitespaces-->
                    <!--inthatcase,weonlydisplaythe120firstcharacters-->
                    <!--otherwise,weletthetext-overflow:ellipsisdothejob-->
                    <tt-set="multiline"t-value="cell.includes('')"/>
                    <tt-set="content"t-value="(multiline&amp;&amp;cell.length&gt;120)?(cell.substring(0,120)+'...'):cell"/>
                    <spant-attf-class="#{multiline?'o_multi_line_text':'o_single_line_text'}">
                        <tt-esc="content"/>
                    </span>
                </td>
            </tr>
        </tbody>
    </t>
    <tt-name="ImportView.preview.error">
        <divclass="oe_import_reportalertalert-danger">
            <p>Importpreviewfaileddueto:<tt-esc="error"/>.</p>
            <p>ForCSVfiles,youmayneedtoselectthecorrectseparator.</p>
            <pt-if="preview">Hereisthestartofthefilewecouldnotimport:</p>
        </div>
        <pret-if="preview"><tt-esc="preview"/></pre>
    </t>
    <ult-name="ImportView.error">
        <lit-foreach="errors"t-as="error"
            t-attf-class="oe_import_reportalertalert-#{error_value[0].type}">
            <tt-if="error_value.lengthgt1">
                <tt-call="ImportView.error.multi.header">
                    <tt-set="error"t-value="error_value[0]"/>
                    <tt-set="error_length"t-value="error_value.length"/>
                </t>
                <ul>
                    <tt-foreach="error_value.length"t-as="index">
                        <lit-att-class="indexgt4?'oe_import_report_more':''">
                            <tt-call="ImportView.error.multi.body">
                                <tt-set="error"t-value="error_value[index]"/>
                                <tt-set="index"t-value="index"/>
                            </t>
                        </li>
                        <lit-if="error_value.lengthgt5andindex==4"style="display:block;">
                            <ahref="#"class="oe_import_report_count">
                                <tt-esc="more(error_value.length-5)"/>
                            </a>
                        </li>
                    </t>
                </ul>
                <tt-if="error_value[0].moreinfo"t-raw="info(error_value[0].moreinfo)"/>

            </t>
            <tt-else="">
                <tt-call="ImportView.error.single">
                    <tt-set="error"t-value="error_value[0]"/>
                </t>
            </t>
        </li>
    </ul>
    <tt-name="ImportView.error.multi.header">
        <spanclass="oe_import_report_message">
            <tt-esc="error.message"/>
            <tt-esc="at_multi_header(error_length)"/>
        </span>
    </t>
    <tt-name="ImportView.error.multi.body">
        <spanclass="oe_import_report_message"t-if="error.rows">
            <tt-esc="at_multi(error.rows)"/>
        </span>
    </t>
    <tt-name="ImportView.error.single">
        <spanclass="oe_import_report_message">
            <tt-esc="error.message"/>
        </span>
        <tt-if="error.rows" t-esc="at(error.rows)"/>
        <tt-if="error.moreinfo"t-raw="info(error.moreinfo)"/>
    </t>
</templates>
