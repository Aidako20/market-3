{%extends"layout.html"%}
{%blockhead%}
<style>
    table{
        width:100%;
        border-collapse:collapse;
    }
    tabletr{
        border-bottom:1pxsolid#f1f1f1;
    }
    tabletr:last-child{
        border-width:0px;
    }
    tabletd{
        padding:8px;
        border-left:1pxsolid#f1f1f1;
    }
    tabletd:first-child{
        border-left:0;
    }
    td.heading{
        font-weight:bold;
        vertical-align:top;
        width:30%;
        text-align:left;
    }
    .device-status{
        margin:6px0;
    }
    .device-status.identifier{
        font-size:0.8rem;
        max-width:350px;
    }
    .device-status.indicator{
        margin-left:4px;
        font-size:0.7rem;
        text-transform:uppercase;
    }
    .device-status.device{
        font-weight:500;
    }
    .collapse.collapsible{
        border:1pxsolid#f1f1f1;
    }
    .collapse.title{
        position:relative;
        color:#00a09d;
        cursor:pointer;
        padding:8px;
    }
    .collapse .active,.collapse.title:hover{
        background-color:#f1f1f1;
        color:#006d6b;
    }
    .collapse .content{
        padding:08px;
        max-height:0;
        overflow:hidden;
        transition:max-height0.2sease-out;
    }
    .arrow-down::after{
        content:'\25bc';
        padding:010px;
        position:absolute;
        right:0;
    }
    .arrow-up::after{
        content:'\25b2';
        padding:010px;
        position:absolute;
        right:0;
    }
    .warn-tr{
        color:#856404;
        background-color:#fff3cd;
        border:2pxsolid#f3e4ce;
    }
</style>
<script>
    $(document).ready(function(){
        $('.collapsible.title').on('click',function(ev){
            $(ev.target).toggleClass('active');
            $(ev.target).toggleClass('arrow-downarrow-up');
            varcontent=$(ev.target).next('.content');
            varmaxHeight=(content.css('max-height')==='0px'?content.prop('scrollHeight'):0)+'px';
            content.css('max-height',maxHeight);
        });
    });
</script>
{%endblock%}
{%blockcontent%}
    <h2class="text-centertext-green">YourIoTBoxisupandrunning</h2>
    <tablealign="center"cellpadding="3">
        <tr>
            <tdclass="heading">Name</td>
            <td>{{hostname}}<aclass="btnbtn-smfloat-right"href='/server'>configure</a></td>
        </tr>
        <tr>
            <tdclass="heading">Version</td>
            <td>{{version}}<aclass="btnbtn-smfloat-right"href='/hw_proxy/upgrade/'>update</a></td>
        </tr>
        <tr>
            <tdclass="heading">IPAddress</td>
            <td>{{ip}}</a></td>
        </tr>
        <tr>
            <tdclass="heading">MacAddress</td>
            <td>{{mac}}</td>
        </tr>
        <tr>
            <tdclass="heading">Network</td>
            <td>{{network_status}}<aclass="btnbtn-smfloat-right"href='/wifi'>configurewifi</a></td>
        </tr>
        <tr>
            <tdclass="heading">Server</td>
            <td><ahref='{{server_status}}'target=_blank>{{server_status}}<aclass="btnbtn-smfloat-right"href='/server'>configure</a></td>
        </tr>
        <trclass="{{'warn-tr'ifnotis_certificate_ok}}">
            <tdclass="heading">HTTPScertificate</td>
            <td>
                {%ifis_certificate_ok%}
                    <details>
                        <summary>OK</summary>
                        <code>{{certificate_details}}</code>
                    </details>
                {%else%}
                    Errorcode:
                    {%seterror_code=certificate_details.split('')|first|replace("_","-")|lower%}
                    {%setdoc_url='https://www.flectrahq.com/documentation/master/applications/productivity/iot/config/https_certificate_iot.html#'~error_code%}
                    <atarget="_blank"class="btnbtn-smfloat-right"href="{{doc_url}}">help</a>
                    <br/>
                    <codestyle="white-space:pre-wrap;">{{certificate_details}}</code>
                {%endif%}
            </td>
        </tr>
        {%ifserver_status!="NotConfigured"%}
        <tr>
            <tdclass="heading">Sixpaymentterminal</td>
            <td>{{six_terminal}}<aclass="btnbtn-smfloat-right"href='/six_payment_terminal'>configure</a></td>
        </tr>
        {%endif%}
        <tr>
            <tdclass="heading">IOTDevice</td>
            <td>
                <divclass="collapse">
                    {%ifiot_device_status|length==0%}
                        NoDeviceFound
                    {%endif%}
                    {%foriot_devicesiniot_device_status|groupby('type')%}
                        <divclass="collapsible">
                            <divclass="titlearrow-down">{{iot_devices.grouper|capitalize}}s</div>
                            <divclass="content">
                                {%fordeviceiniot_devices.list%}
                                    <divclass="device-status">
                                        <spanclass="device">{{device['name']}}</span>
                                        <divclass="identifier">{{device['identifier']}}</div>
                                    </div>
                                {%endfor%}
                            </div>
                        </div>
                    {%endfor%}
                </div>
                <br><center><aclass="btnbtn-sm"href='/list_handlers'>handlerslist</a></center>
            </td>
        </tr>
    </table>
    <divstyle="margin:20pxauto10pxauto;"class="text-center">
        <aclass="btn"href='/point_of_sale/display'>POSDisplay</a>
        <aclass="btn"style="margin-left:10px;"href='/remote_connect'>RemoteDebug</a>
        <atarget="_blank"class="btn"style="margin-left:10px;"href="http://{{ip}}:631">Printersserver</a>
        {%ifserver_status!="NotConfigured"%}
        <aclass="btn"style="margin-left:10px;"href='/list_credential'>Credential</a>
        {%endif%}
    </div>
{%endblock%}
