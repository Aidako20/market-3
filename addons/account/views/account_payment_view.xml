<?xmlversion="1.0"encoding="utf-8"?>
<flectra>
    <data>

        <!--VIEWS-->

        <recordid="view_account_payment_tree"model="ir.ui.view">
            <fieldname="name">account.payment.tree</field>
            <fieldname="model">account.payment</field>
            <fieldname="arch"type="xml">
                <treeedit="false"sample="1">
                    <header>
                        <buttonname="action_post"type="object"string="Confirm"/>
                    </header>
                    <fieldname="date"/>
                    <fieldname="name"/>
                    <fieldname="journal_id"/>
                    <fieldname="payment_method_id"/>
                    <fieldname="partner_id"string="Customer"/>
                    <fieldname="company_id"groups="base.group_multi_company"/>
                    <fieldname="amount"sum="Amount"/>
                    <fieldname="state"widget="badge"decoration-info="state=='draft'"decoration-success="state=='posted'"/>
                    <fieldname="currency_id"groups="base.group_multi_currency"/>
                </tree>
            </field>
        </record>

        <recordid="view_account_supplier_payment_tree"model="ir.ui.view">
            <fieldname="name">account.supplier.payment.tree</field>
            <fieldname="model">account.payment</field>
            <fieldname="inherit_id"ref="account.view_account_payment_tree"/>
            <fieldname="mode">primary</field>
            <fieldname="arch"type="xml">
                <fieldname="partner_id"position="attributes">
                    <attributename="string">Vendor</attribute>
                </field>
            </field>
        </record>

        <recordid="view_account_payment_kanban"model="ir.ui.view">
            <fieldname="name">account.payment.kanban</field>
            <fieldname="model">account.payment</field>
            <fieldname="arch"type="xml">
                <kanbanclass="o_kanban_mobile"create="0"group_create="0"sample="1">
                    <fieldname="name"/>
                    <fieldname="partner_id"/>
                    <fieldname="date"/>
                    <fieldname="state"/>
                    <templates>
                        <tt-name="kanban-box">
                            <divt-attf-class="oe_kanban_global_click">
                                <divclass="rowmb4">
                                    <divclass="col-6">
                                        <strong><span><fieldname="name"/></span></strong>
                                    </div>
                                    <divclass="col-6text-right">
                                        <strong><iclass="fafa-clock-o"role="img"aria-label="Date"title="Date"/><tt-esc="record.date.value"/></strong>
                                    </div>
                                </div>
                                <divclass="row">
                                    <divclass="col-12">
                                        <span><fieldname="partner_id"/></span>
                                    </div>
                                </div>
                                <divclass="row">
                                    <divclass="col-6">
                                        <fieldname="amount"widget='monetary'/>
                                        <fieldname="currency_id"invisible="1"/>
                                    </div>
                                    <divclass="col-6">
                                        <spanclass="float-right">
                                            <fieldname="state"widget="label_selection"options="{'classes':{'draft':'secondary','sent':'success'}}"/>
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </t>
                    </templates>
                </kanban>
            </field>
        </record>

        <recordid="view_account_payment_search"model="ir.ui.view">
            <fieldname="name">account.payment.search</field>
            <fieldname="model">account.payment</field>
            <fieldname="arch"type="xml">
                <searchstring="Payments">
                    <fieldname="name"string="Payment"
                        filter_domain="['|','|',('name','ilike',self),('partner_id','ilike',self),('ref','ilike',self)]"/>
                    <fieldname="partner_id"string="Customer/Vendor"/>
                    <fieldname="journal_id"/>
                    <fieldname="is_internal_transfer"/>
                    <separator/>
                    <filterstring="CustomerPayments"
                            name="inbound_filter"
                            domain="[('partner_type','=','customer'),('is_internal_transfer','=',False)]"/>
                    <filterstring="VendorPayments"
                            name="outbound_filter"
                            domain="[('partner_type','=','supplier'),('is_internal_transfer','=',False)]"/>
                    <filterstring="Transfers"name="transfers_filter"domain="[('is_internal_transfer','=',True)]"/>
                    <separator/>
                    <filterstring="Draft"name="state_draft"domain="[('state','=','draft')]"/>
                    <filterstring="Posted"name="state_posted"domain="[('state','=','posted')]"/>
                    <separator/>
                    <filterstring="Sent"name="state_sent"domain="[('is_move_sent','=',True)]"/>
                    <filterstring="BankMatched"name="matched"domain="[('is_matched','=',True)]"/>
                    <filterstring="Reconciled"name="reconciled"domain="[('is_reconciled','=',True)]"/>
                    <separator/>
                    <filterstring="PaymentDate"name="date"date="date"/>
                    <separator/>
                    <fieldname="company_id"groups="base.group_multi_company"/>
                    <filterstring="Customer/Vendor"name="partner"domain="[]"context="{'group_by':'partner_id'}"/>
                    <filterstring="Journal"name="journal"domain="[]"context="{'group_by':'journal_id'}"/>
                    <filterstring="PaymentMethod"name="paymentmethod"domain="[]"context="{'group_by':'payment_method_id'}"/>
                    <filterstring="Status"name="state"domain="[]"context="{'group_by':'state'}"/>
                    <filterstring="PaymentDate"name="groupby_date"domain="[]"context="{'group_by':'date'}"/>
                    <filterstring="Currency"name="currency"domain="[]"context="{'group_by':'currency_id'}"groups="base.group_multi_currency"/>
                    <filterstring="Company"name="company"domain="[]"context="{'group_by':'company_id'}"groups="base.group_multi_company"/>
                    <separator/>
                    <filterinvisible="1"string="LateActivities"name="activities_overdue"
                        domain="[('my_activity_date_deadline','&lt;',context_today().strftime('%Y-%m-%d'))]"
                        help="Showallrecordswhichhasnextactiondateisbeforetoday"/>
                    <filterinvisible="1"string="TodayActivities"name="activities_today"
                        domain="[('my_activity_date_deadline','=',context_today().strftime('%Y-%m-%d'))]"/>
                    <filterinvisible="1"string="FutureActivities"name="activities_upcoming_all"
                        domain="[('my_activity_date_deadline','&gt;',context_today().strftime('%Y-%m-%d'))]"/>
                </search>
            </field>
        </record>

        <recordid="view_account_payment_form"model="ir.ui.view">
            <fieldname="name">account.payment.form</field>
            <fieldname="model">account.payment</field>
            <fieldname="arch"type="xml">
                <formstring="RegisterPayment">
                    <header>
                        <buttonname="action_post"string="Confirm"type="object"class="oe_highlight"
                                attrs="{'invisible':[('state','!=','draft')]}"/>
                        <buttonname="action_draft"string="ResetToDraft"type="object"class="btnbtn-secondary"
                                attrs="{'invisible':[('state','notin',('posted','cancel'))]}"
                                groups="account.group_account_invoice"/>
                        <buttonname="action_cancel"string="Cancel"type="object"
                                attrs="{'invisible':[('state','!=','draft')]}"/>
                        <buttonname="mark_as_sent"string="MarkasSent"type="object"
                                attrs="{'invisible':['|','|',('state','!=','posted'),('is_move_sent','=',True),('payment_method_code','!=','manual')]}"/>
                        <buttonname="unmark_as_sent" string="UnmarkasSent"type="object"
                                attrs="{'invisible':['|','|',('state','!=','posted'),('is_move_sent','=',False),('payment_method_code','!=','manual')]}"/>
                        <fieldname="state"widget="statusbar"statusbar_visible="draft,posted"/>
                    </header>

                    <sheet>
                        <!--Invisiblefields-->
                        <fieldname="id"invisible="1"/>
                        <fieldname="is_move_sent"invisible="1"/>
                        <fieldname="is_reconciled"invisible="1"/>
                        <fieldname="is_matched"invisible="1"/>
                        <fieldname="payment_method_code"invisible="1"/>
                        <fieldname="show_partner_bank_account"invisible="1"/>
                        <fieldname="require_partner_bank_account"invisible="1"/>
                        <fieldname="hide_payment_method"invisible="1"/>
                        <fieldname="available_partner_bank_ids"invisible="1"/>
                        <fieldname="available_payment_method_ids"invisible="1"/>
                        <fieldname="suitable_journal_ids"invisible="1"/>
                        <fieldname="country_code"invisible="1"/>

                        <divclass="oe_button_box"name="button_box">
                            <!--Invoicestatbutton-->
                            <buttonname="button_open_invoices"type="object"
                                    class="oe_stat_button"icon="fa-bars"
                                    attrs="{'invisible':[('reconciled_invoices_count','=',0)]}">
                                <fieldname="reconciled_invoices_count"/>
                                <spanattrs="{'invisible':[('reconciled_invoices_count','&gt;',1)]}">Invoice</span>
                                <spanattrs="{'invisible':[('reconciled_invoices_count','&lt;=',1)]}">Invoices</span>
                            </button>

                            <!--Billstatbutton-->
                            <buttonname="button_open_bills"type="object"
                                    class="oe_stat_button"icon="fa-bars"
                                    attrs="{'invisible':[('reconciled_bills_count','=',0)]}">
                                <fieldname="reconciled_bills_count"/>
                                <spanattrs="{'invisible':[('reconciled_bills_count','&gt;',1)]}">Bill</span>
                                <spanattrs="{'invisible':[('reconciled_bills_count','&lt;=',1)]}">Bills</span>
                            </button>

                            <!--Statementstatbutton-->
                            <buttonname="button_open_statements"type="object"
                                    class="oe_stat_button"icon="fa-bars"
                                    attrs="{'invisible':[('reconciled_statements_count','=',0)]}">
                                <fieldname="reconciled_statements_count"/>
                                <spanattrs="{'invisible':[('reconciled_statements_count','&gt;',1)]}">Statement</span>
                                <spanattrs="{'invisible':[('reconciled_statements_count','&lt;=',1)]}">Statements</span>
                            </button>
                        </div>

                        <widgetname="web_ribbon"text="InvoicingAppLegacy"
                                bg_color="bg-info"
                                attrs="{'invisible':[('state','!=','invoicing_legacy')]}"
                                tooltip="ThispaymenthasbeengeneratedthroughtheInvoicingapp,beforeinstallingAccounting.Ithasbeendisabledbythe'InvoicingSwitchThresholdDate'settingsothatitdoesnotimpactyouraccounting."
                        />

                        <divclass="oe_title"attrs="{'invisible':[('state','=','draft')]}">
                            <h1><fieldname="name"attrs="{'readonly':[('state','!=','draft')]}"/></h1>
                        </div>

                        <group>
                            <groupname="group1">
                                <fieldname="payment_type"widget="radio"
                                       attrs="{'readonly':[('state','!=','draft')]}"/>
                                <fieldname="partner_type"widget="selection"
                                       attrs="{'readonly':[('state','!=','draft')],'invisible':[('is_internal_transfer','=',True)]}"/>
                                <fieldname="partner_id"context="{'default_is_company':True}"
                                       attrs="{'readonly':['|',('state','!=','draft'),('is_internal_transfer','=',True)]}"/>
                                <fieldname="destination_account_id"
                                       options="{'no_create':True}"required="1"
                                       attrs="{'readonly':['|',('state','!=','draft'),('is_internal_transfer','=',True)]}"/>
                                <fieldname="is_internal_transfer"
                                       attrs="{'readonly':[('state','!=','draft')]}"/>
                                <fieldname="company_id"groups="base.group_multi_company"/>
                            </group>
                            <groupname="group2">
                                <fieldname="journal_id"
                                       widget="selection"
                                       domain="[('type','in',('bank','cash'))]"
                                       attrs="{'readonly':[('state','!=','draft')]}"/>
                                <fieldname="payment_method_id"widget="radio"
                                       required="1"
                                       attrs="{'readonly':[('state','!=','draft')],'invisible':[('hide_payment_method','=',True)]}"/>
                                <fieldname="partner_bank_id"context="{'default_partner_id':partner_id}"
                                       attrs="{'invisible':[('show_partner_bank_account','=',False)],'required':[('require_partner_bank_account','=',True)],'readonly':[('state','!=','draft')]}"/>

                                <!--/!\Requiredduetothe_inheritsbutmustnotberequiredwhensavinganew
                                record.Using'required':[('id','!=',False)]isnotworkingduetothegroupsseton
                                thefield.
                                -->
                                <fieldname="move_id"
                                       required="0"
                                       attrs="{'invisible':[('id','=',False)]}"
                                       groups="account.group_account_readonly"/>
                            </group>
                            <groupname="group3">
                                <labelfor="amount"/>
                                <divname="amount_div"class="o_row">
                                    <fieldname="amount"
                                           attrs="{'readonly':[('state','!=','draft')]}"/>
                                    <fieldname="currency_id"
                                           options="{'no_create':True,'no_open':True}"
                                           required="1"
                                           attrs="{'readonly':[('state','!=','draft')]}"
                                           groups="base.group_multi_currency"/>
                                </div>
                                <fieldname="date"
                                       attrs="{'readonly':[('state','!=','draft')]}"/>
                                <fieldname="ref"string="Memo"/>
                            </group>

                            <group>
                                <fieldname="qr_code"invisible="1"/>
                                <divattrs="{'invisible':[('qr_code','=',False)]}"colspan="2"class="text-center">
                                    <fieldname="qr_code"widget="html"/>
                                </div>
                            </group>
                        </group>
                    </sheet>
                    <divclass="o_attachment_preview"/>
                    <divclass="oe_chatter">
                        <fieldname="message_follower_ids"groups="base.group_user"/>
                        <fieldname="activity_ids"/>
                        <fieldname="message_ids"/>
                    </div>
                </form>
            </field>
        </record>

        <recordid="view_account_payment_graph"model="ir.ui.view">
            <fieldname="name">account.payment.graph</field>
            <fieldname="model">account.payment</field>
            <fieldname="arch"type="xml">
                <graphstring="Invoices"type="bar"stacked="1"sample="1">
                    <fieldname="payment_type"/>
                    <fieldname="journal_id"/>
                    <fieldname="amount"type="measure"/>
                </graph>
            </field>
        </record>

        <!--ACTIONS-->

        <recordid="action_account_payments"model="ir.actions.act_window">
            <fieldname="name">Payments</field>
            <fieldname="res_model">account.payment</field>
            <fieldname="view_mode">tree,kanban,form,graph</field>
            <fieldname="context">{
                'default_payment_type':'inbound',
                'default_partner_type':'customer',
                'search_default_inbound_filter':1,
                'default_move_journal_types':('bank','cash'),
            }</field>
            <fieldname="view_id"ref="view_account_payment_tree"/>
            <fieldname="help"type="html">
                <pclass="o_view_nocontent_smiling_face">
                  Registerapayment
                </p><p>
                  Paymentsareusedtoregisterliquiditymovements.Youcanprocessthosepaymentsbyyourownmeansorbyusinginstalledfacilities.
                </p>
            </field>
        </record>

        <recordid="action_account_payments_payable"model="ir.actions.act_window">
            <fieldname="name">Payments</field>
            <fieldname="res_model">account.payment</field>
            <fieldname="view_mode">tree,kanban,form,graph</field>
            <fieldname="context">{
                'default_payment_type':'outbound',
                'default_partner_type':'supplier',
                'search_default_outbound_filter':1,
                'default_move_journal_types':('bank','cash'),
            }</field>
            <fieldname="view_id"ref="view_account_supplier_payment_tree"/>
            <fieldname="help"type="html">
                <pclass="o_view_nocontent_smiling_face">
                  Registerapayment
                </p><p>
                  Paymentsareusedtoregisterliquiditymovements.Youcanprocessthosepaymentsbyyourownmeansorbyusinginstalledfacilities.
                </p>
            </field>
        </record>

        <recordid="action_account_payments_transfer"model="ir.actions.act_window">
            <fieldname="name">InternalTransfers</field>
            <fieldname="res_model">account.payment</field>
            <fieldname="view_mode">tree,kanban,form,graph</field>
            <fieldname="context">{'default_payment_type':'outbound','search_default_transfers_filter':1}</field>
            <fieldname="domain">[]</field>
            <fieldname="view_id"ref="view_account_supplier_payment_tree"/>
            <fieldname="help"type="html">
                <pclass="o_view_nocontent_smiling_face">
                  Registerapayment
                </p><p>
                  Paymentsareusedtoregisterliquiditymovements.Youcanprocessthosepaymentsbyyourownmeansorbyusinginstalledfacilities.
                </p>
            </field>
        </record>

        <recordid="action_account_invoice_from_list"model="ir.actions.server">
            <fieldname="name">RegisterPayment</field>
            <fieldname="groups_id"eval="[(4,ref('account.group_account_invoice'))]"/>
            <fieldname="model_id"ref="account.model_account_move"/>
            <fieldname="binding_model_id"ref="account.model_account_move"/>
            <fieldname="binding_view_types">list</field>
            <fieldname="state">code</field>
            <fieldname="code">
                ifrecords:
                    action=records.action_register_payment()
            </field>
        </record>

        <!--Actionconfirm_paymentsformulti-->
        <recordid="action_account_confirm_payments"model="ir.actions.server">
            <fieldname="name">PostPayments</field>
            <fieldname="type">ir.actions.server</field>
            <fieldname="state">code</field>
            <fieldname="groups_id"eval="[(4,ref('account.group_account_invoice'))]"/>
            <fieldname="model_id"ref="account.model_account_payment"/>
            <fieldname="binding_model_id"ref="account.model_account_payment"/>
            <fieldname="binding_view_types">list</field>
            <fieldname="code">
                records.action_post()
            </field>
        </record>

    </data>
</flectra>
