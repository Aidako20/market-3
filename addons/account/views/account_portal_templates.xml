<flectra>
    <templateid="portal_my_home_menu_invoice"name="Portallayout:invoicemenuentries"inherit_id="portal.portal_breadcrumbs"priority="30">
        <xpathexpr="//ol[hasclass('o_portal_submenu')]"position="inside">
            <lit-if="page_name=='invoice'"t-attf-class="breadcrumb-item#{'active'ifnotinvoiceelse''}">
                <at-if="invoice"t-attf-href="/my/invoices?{{keep_query()}}">Invoices&amp;Bills</a>
                <tt-else="">Invoices&amp;Bills</t>
            </li>
            <lit-if="invoice"class="breadcrumb-itemactive">
                <tt-esc="invoice.name"t-if="invoice.name!='/'"/>
                <tt-else=""><em>DraftInvoice</em></t>
            </li>
        </xpath>
    </template>

    <templateid="portal_my_home_invoice"name="ShowInvoices&amp;Bills"inherit_id="portal.portal_my_home"customize_show="True"priority="30">
        <xpathexpr="//div[hasclass('o_portal_docs')]"position="inside">
            <tt-call="portal.portal_docs_entry">
                <tt-set="title">Invoices&amp;Bills</t>
                <tt-set="url"t-value="'/my/invoices'"/>
                <tt-set="placeholder_count"t-value="'invoice_count'"/>
            </t>
        </xpath>
    </template>

    <templateid="portal_my_invoices"name="MyInvoicesandPayments">
      <tt-call="portal.portal_layout">
        <tt-set="breadcrumbs_searchbar"t-value="True"/>

        <tt-call="portal.portal_searchbar">
            <tt-set="title">Invoices</t>
        </t>
        <tt-if="notinvoices">
            <p>Therearecurrentlynoinvoicesandpaymentsforyouraccount.</p>
        </t>
        <tt-if="invoices"t-call="portal.portal_table">
            <thead>
                <trclass="active">
                    <th>Invoice#</th>
                    <th>InvoiceDate</th>
                    <thclass='d-noned-md-table-cell'>DueDate</th>
                    <th/>
                    <thclass="text-right">AmountDue</th>
                </tr>
            </thead>
            <tbody>
                <tt-foreach="invoices"t-as="invoice">
                    <tr>
                        <td>
                            <at-att-href="invoice.get_portal_url()"t-att-title="invoice.name">
                                <tt-esc="invoice.name"t-if="invoice.name!='/'"/>
                                <emt-else="">DraftInvoice</em>
                            </a>
                        </td>
                        <td><spant-field="invoice.invoice_date"/></td>
                        <tdclass='d-noned-md-table-cell'><spant-field="invoice.invoice_date_due"/></td>
                        <tdclass="tx_status">
                            <tt-if="invoice.state=='posted'andinvoice.payment_statenotin('in_payment','paid','reversed')">
                                <spanclass="badgebadge-pillbadge-info"><iclass="fafa-fwfa-clock-o"aria-label="Opened"title="Opened"role="img"></i><spanclass="d-noned-md-inline">WaitingforPayment</span></span>
                            </t>
                            <tt-if="invoice.state=='posted'andinvoice.payment_statein('paid','in_payment')">
                                <spanclass="badgebadge-pillbadge-success"><iclass="fafa-fwfa-check"aria-label="Paid"title="Paid"role="img"></i><spanclass="d-noned-md-inline">Paid</span></span>
                            </t>
                            <tt-if="invoice.state=='posted'andinvoice.payment_state=='reversed'">
                                <spanclass="badgebadge-pillbadge-success"><iclass="fafa-fwfa-check"aria-label="Reversed"title="Reversed"role="img"></i><spanclass="d-noned-md-inline">Reversed</span></span>
                            </t>
                            <tt-if="invoice.state=='cancel'">
                                <spanclass="badgebadge-pillbadge-warning"><iclass="fafa-fwfa-remove"aria-label="Cancelled"title="Cancelled"role="img"></i><spanclass="d-noned-md-inline">Cancelled</span></span>
                            </t>
                        </td>
                        <tdclass="text-right"><spant-esc="-invoice.amount_residualifinvoice.move_type=='out_refund'elseinvoice.amount_residual"t-options='{"widget":"monetary","display_currency":invoice.currency_id}'/></td>
                    </tr>
                </t>
            </tbody>
        </t>
      </t>
    </template>

    <templateid="portal_invoice_page"name="InvoicePortalTemplate"inherit_id="portal.portal_sidebar"primary="True">
        <xpathexpr="//div[hasclass('o_portal_sidebar')]"position="inside">
            <tt-set="o_portal_fullwidth_alert"groups="sales_team.group_sale_salesman,account.group_account_invoice,account.group_account_readonly">
                <tt-call="portal.portal_back_in_edit_mode">
                    <tt-set="backend_url"t-value="'/web#model=%s&amp;id=%s&amp;action=%s&amp;view_type=form'%(invoice._name,invoice.id,invoice.env.ref('account.action_move_out_invoice_type').id)"/>
                </t>
            </t>

            <divclass="rowmt16o_portal_invoice_sidebar">
                <!--Sidebar-->
                <tt-call="portal.portal_record_sidebar">
                    <tt-set="classes"t-value="'col-lg-autod-print-none'"/>
                    <tt-set="title">
                        <h2class="mb-0">
                            <bt-if="invoice.amount_residual>0"t-field="invoice.amount_residual"/>
                            <bt-else="1"t-field="invoice.amount_total"/>
                        </h2>
                        <divclass="small"t-if="invoice.payment_statenotin('paid','in_payment')andinvoice.move_type=='out_invoice'"><iclass="fafa-clock-o"/><spanclass="o_portal_sidebar_timeagoml4"t-att-datetime="invoice.invoice_date_due"/></div>
                    </t>

                    <tt-set="entries">
                        <ulclass="list-grouplist-group-flushflex-wrapflex-rowflex-lg-column">
                            <liclass="list-group-itemflex-grow-1">
                                <divclass="o_download_pdfbtn-toolbarflex-sm-nowrap">
                                    <divclass="btn-group flex-grow-1mr-1mb-1">
                                        <aclass="btnbtn-secondarybtn-blocko_download_btn"t-att-href="invoice.get_portal_url(report_type='pdf',download=True)"title="Download"><iclass="fafa-download"/>Download</a>
                                    </div>
                                    <divclass="btn-groupflex-grow-1mb-1">
                                        <aclass="btnbtn-secondarybtn-blocko_print_btno_portal_invoice_print"t-att-href="invoice.get_portal_url(report_type='pdf')"id="print_invoice_report"title="Print"target="_blank"><iclass="fafa-print"/>Print</a>
                                    </div>
                                </div>
                            </li>
                            <lit-if="invoice.invoice_user_id"class="list-group-itemflex-grow-1">
                                <divclass="smallmb-1"><strongclass="text-muted">
                                    <tt-if="invoice.move_type=='out_invoice'">
                                        Salesperson
                                    </t>
                                    <tt-if="invoice.move_type=='in_invoice'">
                                        PurchaseRepresentative
                                    </t>
                                </strong></div>
                                <divclass="row">
                                    <divclass="colflex-grow-0pr-2">
                                        <imgt-if="invoice.invoice_user_id.image_1024"class="rounded-circlemt-1o_portal_contact_img"t-att-src="image_data_uri(invoice.invoice_user_id.image_1024)"alt="Contact"/>
                                        <imgt-else=""class="rounded-circlemt-1o_portal_contact_img"src="/web/static/src/img/user_menu_avatar.png"alt="Contact"/>
                                    </div>
                                    <divclass="colpl-0">
                                        <spant-field="invoice.invoice_user_id"t-options='{"widget":"contact","fields":["name","phone"],"no_marker":True}'/>
                                        <ahref="#discussion"class="small"><iclass="fafa-fwfa-comments"/><b>Sendmessage</b></a>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </t>
                </t>

                <!--PageContent-->
                <divid="invoice_content"class="col-12col-lg">
                    <tt-if="errororwarning"t-call="account.portal_invoice_error"/>
                    <tt-if="successand(noterrorandnotwarning)"t-call="account.portal_invoice_success"/>

                    <divclass="o_portal_html_viewshadowp-3">
                        <divclass="o_portal_html_loadertext-center">
                            <iclass="fafa-circle-o-notchfa-spinfa-2xfa-fwtext-black-50"></i>
                        </div>
                        <iframeid="invoice_html"class="mt8mb8"width="100%"height="100%"frameborder="0"scrolling="no"t-att-src="invoice.get_portal_url(report_type='html')"/>
                    </div>
                    <!--chatter-->
                    <divid="invoice_communication"class="mt-4">
                        <h2>History</h2>
                        <tt-call="portal.message_thread">
                            <tt-set="object"t-value="invoice"/>
                        </t>
                    </div>
                </div>
            </div>
        </xpath>
    </template>

    <templateid="portal_invoice_error"name="Invoiceerror/warningdisplay">
        <divclass="rowmr16">
            <divt-attf-class="'col-lg-12mr16ml16alertalert-dismissable'#{'alert-danger'iferrorelse'alert-warning'}"role="alert">
                <ahref="#"class="close"data-dismiss="alert"aria-label="close"title="close">×</a>
                <tt-if="error=='generic'"name="generic">
                    Therewasanerrorprocessingthispage.
                </t>
            </div>
        </div>
    </template>

    <templateid="portal_invoice_success"name="Invoicesuccessdisplay">
        <divclass="rowmr16">
            <divclass="col-lg-12mr16ml16alertalert-dismissablealert-success"role="status">
                <ahref="#"class="close"data-dismiss="alert"aria-label="close"title="close">×</a>
            </div>
        </div>
    </template>
</flectra>
