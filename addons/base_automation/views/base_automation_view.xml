<?xmlversion="1.0"encoding="utf-8"?>
<flectra>

        <!--AutomationFormView-->
        <recordid="view_base_automation_form"model="ir.ui.view">
            <fieldname="name">Automations</field>
            <fieldname="model">base.automation</field>
            <fieldname="mode">primary</field>
            <fieldname="inherit_id"ref="base.view_server_action_form"/>
            <fieldname="arch"type="xml">
                <xpathexpr="//button[@name='create_action']"position="replace">
                </xpath>
                <xpathexpr="//button[@name='unlink_action']"position="replace">
                </xpath>
                <xpathexpr="//button[@name='run']"position="replace">
                </xpath>
                <xpathexpr="//field[@name='partner_ids']"position='attributes'>
                    <attributename="options">{'no_create':True}</attribute>
                </xpath>
                <xpathexpr="//field[@name='channel_ids']"position='attributes'>
                    <attributename="options">{'no_create':True}</attribute>
                </xpath>
                <xpathexpr="//field[@name='template_id']"position='attributes'>
                    <attributename="context">{'default_model_id':model_id}</attribute>
                </xpath>
                <xpathexpr="//page[@name='security']"position='attributes'>
                    <attributename='invisible'>1</attribute>
                </xpath>
                <xpathexpr="//group[@name='action_content']"position="inside">
                    <fieldname="active"widget="boolean_toggle"/>
                    <fieldname="trigger"/>
                    <fieldname="trigger_field_ids"domain="[('model_id','=',model_id)]"attrs="{'invisible':[('trigger','notin',['on_write','on_create_or_write'])]}"widget="many2many_tags"/>
                    <fieldname="on_change_field_ids"string="TriggerFields"domain="[('model_id','=',model_id)]"
                        attrs="{'invisible':[('trigger','!=','on_change')],'required':[('trigger','=','on_change')]}"
                        widget='many2many_tags'options="{'no_create':True}"/>

                    <fieldname="filter_pre_domain"widget="domain"options="{'model':'model_name','in_dialog':True}"attrs="{'invisible':[('trigger','notin',['on_write','on_create_or_write'])]}"/>
                    <fieldname="filter_domain"widget="domain"options="{'model':'model_name','in_dialog':True}"/>
                    <fieldname="trg_date_id"
                        attrs="{'invisible':[('trigger','!=','on_time')],'required':[('trigger','=','on_time')]}"/>
                    <labelfor="trg_date_range"
                        attrs="{'invisible':[('trigger','!=','on_time')]}"/>
                    <divclass="o_row"attrs="{'invisible':[('trigger','!=','on_time')]}">
                        <fieldname="trg_date_range"attrs="{'required':[('trigger','=','on_time')]}"/>
                        <fieldname="trg_date_range_type"attrs="{'required':[('trigger','=','on_time')]}"/>
                    </div>
                    <fieldname="trg_date_calendar_id"
                        attrs="{'invisible':['|',('trg_date_id','=',False),('trg_date_range_type','!=','day')]}"/>
                </xpath>
                <xpathexpr="//group[@name='action_wrapper']"position="after">
                    <divclass="alertalert-info"role="alert"attrs="{'invisible':[('trigger','!=','on_time')]}">
                        <fieldname="least_delay_msg"/>
                    </div>
                </xpath>
            </field>
        </record>

        <!--automationTreeView-->
        <recordid="view_base_automation_tree"model="ir.ui.view">
            <fieldname="name">base.automation.tree</field>
            <fieldname="model">base.automation</field>
            <fieldname="arch"type="xml">
                <treestring="Automation">
                    <fieldname="sequence"widget="handle"/>
                    <fieldname="name"/>
                    <fieldname="trigger"/>
                    <fieldname="model_id"/>
                </tree>
            </field>
        </record>

        <recordid="view_base_automation_search"model="ir.ui.view">
            <fieldname="name">base.automation.search</field>
            <fieldname="model">base.automation</field>
            <fieldname="arch"type="xml">
                <search>
                    <fieldname="name"/>
                    <fieldname="model_id"/>
                    <separator/>
                    <filterstring="Archived"name="inactive"domain="[('active','=',False)]"/>
                </search>
            </field>
        </record>

        <!--automationAction-->
        <recordid="base_automation_act"model="ir.actions.act_window">
            <fieldname="name">AutomatedActions</field>
            <fieldname="res_model">base.automation</field>
            <fieldname="view_mode">tree,form</field>
            <fieldname="view_id"ref="view_base_automation_tree"/>
            <fieldname="help"type="html">
              <pclass="o_view_nocontent_smiling_face">
                Setupanewautomatedautomation
              </p><p>
                Useautomatedactionstoautomaticallytriggeractionsfor
                variousscreens.Example:aleadcreatedbyaspecificusermay
                beautomaticallysettoaspecificSalesTeam,oran
                opportunitywhichstillhasstatuspendingafter14daysmight
                triggeranautomaticreminderemail.
              </p>
            </field>
        </record>

        <menuitemid="menu_base_automation_form"
            parent="base.menu_automation"action="base_automation_act"sequence="1"/>

        <templateid="assets_backend"name="base_automationassets"inherit_id="web.assets_backend">
            <xpathexpr="."position="inside">
                <scripttype="text/javascript"src="/base_automation/static/src/js/base_automation_error_dialog.js"/>
            </xpath>
        </template>

        <templateid="qunit_suite"name="base_automation_tests"inherit_id="web.qunit_suite_tests">
            <xpathexpr="."position="inside">
                <scripttype="text/javascript"src="/base_automation/static/tests/base_automation_error_dialog.js"/>
            </xpath>
        </template>

</flectra>
