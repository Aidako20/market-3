<?xmlversion="1.0"encoding="utf-8"?>
<flectra>
    <!-- MAILINGCONTACTSUBSCRIPTION-->
    <recordmodel="ir.ui.view"id="mailing_contact_subscription_view_form">
        <fieldname="name">mailing.contact.subscription.view.form</field>
        <fieldname="model">mailing.contact.subscription</field>
        <fieldname="priority">10</field>
        <fieldname="arch"type="xml">
            <formstring="MailingListSubscription">
                <sheet>
                    <group>
                        <fieldname="list_id"/>
                        <fieldname="is_blacklisted"invisible="1"/>
                        <labelfor="contact_id"class="oe_inline"/>
                        <divclass="o_rowo_row_readonly">
                            <iclass="fafa-bantext-danger"role="img"title="Thisemailisblacklistedformassmailings"
                                aria-label="Blacklisted"attrs="{'invisible':[('is_blacklisted','=',False)]}"groups="base.group_user"></i>
                            <fieldname="contact_id"/>
                        </div>
                        <fieldname="unsubscription_date"readonly="1"/>
                        <fieldname="opt_out"/>
                        <fieldname="message_bounce"readonly="1"/>
                    </group>
                </sheet>
            </form>
        </field>
    </record>

    <recordmodel="ir.ui.view"id="mailing_contact_subscription_view_tree">
        <fieldname="name">mailing.contact.subscription.view.tree</field>
        <fieldname="model">mailing.contact.subscription</field>
        <fieldname="arch"type="xml">
            <treestring="MailingListSubscriptions">
                <fieldname="contact_id"/>
                <fieldname="unsubscription_date"/>
                <fieldname="opt_out"/>
                <fieldname="message_bounce"/>
                <fieldname="is_blacklisted"/>
            </tree>
        </field>
    </record>

    <recordmodel="ir.ui.view"id="mailing_contact_subscription_view_search">
        <fieldname="name">mailing.contact.subscription.view.search</field>
        <fieldname="model">mailing.contact.subscription</field>
        <fieldname="arch"type="xml">
           <searchstring="MailingListSubscriptions">
                <fieldname="contact_id"/>
                <fieldname="opt_out"/>
                <fieldname="list_id"/>
            </search>
        </field>
    </record>

    <recordid="mailing_contact_view_search"model="ir.ui.view">
        <fieldname="name">mailing.contact.view.search</field>
        <fieldname="model">mailing.contact</field>
        <fieldname="arch"type="xml">
           <searchstring="MailingListContacts">
                <fieldname="name"
                    filter_domain="['|','|',('name','ilike',self),('company_name','ilike',self),('email_normalized','ilike',self)]"
                    string="Name/Email"/>
                <fieldname="tag_ids"/>
                <fieldname="list_ids"/>
                <separator/>
                <filterstring="ValidEmailRecipients"
                    name="filter_valid_email_recipient"
                    domain="[('opt_out','=',False),('is_blacklisted','=',False),('email_normalized','!=',False)]"
                    invisible="notcontext.get('default_list_ids')"/>
                <separator/>
                <filterstring="ExcludeBlacklistedEmails"
                    name="filter_not_email_bl"
                    domain="[('is_blacklisted','=',False)]"/>
                <separator/>
                <filterstring="ExcludeOptOut"
                    name="filter_not_optout"
                    domain="[('opt_out','=',False)]"
                    invisible="notcontext.get('default_list_ids')"/>
                <groupexpand="0"string="GroupBy">
                    <filterstring="CreationDate"name="group_create_date"
                        context="{'group_by':'create_date'}"/>
                </group>
            </search>
        </field>
    </record>

    <recordid="mailing_contact_view_tree"model="ir.ui.view">
        <fieldname="name">mailing.contact.view.tree</field>
        <fieldname="model">mailing.contact</field>
        <fieldname="priority">10</field>
        <fieldname="arch"type="xml">
            <treestring="MailingListContacts"sample="1">
                <fieldname="create_date"/>
                <fieldname="name"/>
                <fieldname="company_name"/>
                <fieldname="email"/>
                <fieldname="is_blacklisted"string="EmailBlacklisted"/>
                <fieldname="message_bounce"sum="TotalBounces"/>
                <fieldname="opt_out"invisible="'default_list_ids'notincontext"/>
            </tree>
        </field>
    </record>

    <recordid="mailing_contact_view_kanban"model="ir.ui.view">
        <fieldname="name">mailing.contact.view.kanban</field>
        <fieldname="model">mailing.contact</field>
        <fieldname="arch"type="xml">
            <kanbansample="1">
                <fieldname="name"/>
                <fieldname="company_name"/>
                <fieldname="email"/>
                <fieldname="message_bounce"/>
                <templates>
                    <tt-name="kanban-box">
                        <divt-attf-class="oe_kanban_global_click">
                            <divclass="o_kanban_record_top">
                                <divclass="o_kanban_record_headings">
                                    <strongclass="o_kanban_record_title">
                                        <tt-esc="record.name.value"/>
                                    </strong>
                                </div>
                                <spanclass="badgebadge-pill"title="Numberofbouncedemail.">
                                    <iclass="fafa-exclamation-triangle"role="img"aria-label="Warning"title="Warning"/><tt-esc="record.message_bounce.value"title=""/>
                                </span>
                            </div>
                            <divclass="o_kanban_record_body">
                                <fieldname="tag_ids"/>
                            </div>
                            <divclass="o_kanban_record_bottom">
                                <divclass="oe_kanban_bottom_left">
                                    <strong>
                                        <tt-esc="record.email.value"/>
                                    </strong>
                                </div>
                                <divclass="oe_kanban_bottom_right">
                                    <tt-esc="record.company_name.value"/>
                                </div>
                            </div>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>

    <recordid="mailing_contact_view_form"model="ir.ui.view">
        <fieldname="name">mailing.contact.view.form</field>
        <fieldname="model">mailing.contact</field>
        <fieldname="priority">10</field>
        <fieldname="arch"type="xml">
            <formstring="MailingListContacts">
                <sheet>
                    <divclass="oe_title">
                        <labelfor="name"class="oe_edit_only"/>
                        <h1>
                            <fieldname="name"placeholder="e.g.JohnSmith"/>
                        </h1>
                        <labelfor="tag_ids"class="oe_edit_only"/>
                        <div>
                            <fieldname="tag_ids"widget="many2many_tags"style="width:100%%"/>
                        </div>
                    </div>
                    <group>
                        <group>
                            <labelfor="email"class="oe_inline"/>
                            <divclass="o_rowo_row_readonly"name="email_details">
                                 <buttonname="mail_action_blacklist_remove"class="fafa-bantext-danger"
                                    title="Thisemailisblacklistedformassmailings.Clicktounblacklist."
                                    type="object"context="{'default_email':email}"groups="base.group_user"
                                    attrs="{'invisible':[('is_blacklisted','=',False)]}"/>
                                <fieldname="email"widget="email"/>
                                <fieldname="is_blacklisted"invisible="1"/>
                            </div>
                            <fieldname="title_id"/>
                            <fieldname="company_name"/>
                            <fieldname="country_id"/>
                        </group>
                        <group>
                            <fieldname="create_date"readonly="1"/>
                            <fieldname="message_bounce"/>
                        </group>
                    </group>
                    <fieldname="subscription_list_ids">
                        <treeeditable="bottom">
                           <fieldname="list_id"/>
                           <fieldname="unsubscription_date"/>
                           <fieldname="opt_out"/>
                        </tree>
                    </field>
                </sheet>
                <divclass="oe_chatter">
                    <fieldname="message_follower_ids"/>
                    <fieldname="message_ids"/>
                </div>
            </form>
        </field>
    </record>

    <recordid="mailing_contact_view_pivot"model="ir.ui.view">
        <fieldname="name">mailing.contact.pivot</field>
        <fieldname="model">mailing.contact</field>
        <fieldname="priority">10</field>
        <fieldname="arch"type="xml">
            <pivotstring="MailingListContacts"stacked="True"sample="1">
                <fieldname="create_date"type="row"/>
            </pivot>
        </field>
    </record>

    <recordid="mailing_contact_view_graph"model="ir.ui.view">
        <fieldname="name">mailing.contact.view.graph</field>
        <fieldname="model">mailing.contact</field>
        <fieldname="priority">10</field>
        <fieldname="arch"type="xml">
            <graphstring="MailingListContacts"stacked="True"sample="1">
                <fieldname="create_date"type="row"/>
            </graph>
        </field>
    </record>

    <recordmodel="ir.actions.act_window"id="action_view_mass_mailing_contacts">
        <fieldname="name">MailingListContacts</field>
        <fieldname="res_model">mailing.contact</field>
        <fieldname="view_mode">tree,kanban,form,graph,pivot</field>
        <fieldname="context">{'search_default_filter_not_email_bl':1}</field>
        <fieldname="help"type="html">
            <pclass="o_view_nocontent_smiling_face">
                Createamailingcontact
            </p><p>
                Mailingcontactsallowyoutoseparateyourmarketingaudiencefromyourbusinesscontactdirectory.
            </p>
        </field>
    </record>

    <menuitemname="MailingListContacts"id="menu_email_mass_mailing_contacts"
        parent="mass_mailing_mailing_list_menu"sequence="4"
        action="action_view_mass_mailing_contacts"/>
</flectra>
