<?xmlversion="1.0"encoding="utf-8"?>
<flectra>
    <!-- MAILINGTRACE!-->
    <recordmodel="ir.ui.view"id="mailing_trace_view_search">
        <fieldname="name">mailing.trace.search</field>
        <fieldname="model">mailing.trace</field>
        <fieldname="arch"type="xml">
           <searchstring="MailStatistics">
                <fieldname="mail_mail_id_int"/>
                <fieldname="message_id"/>
                <fieldname="email"/>
                <fieldname="mass_mailing_id"/>
                <filterstring="Scheduled"name="filter_scheduled"domain="[('scheduled','!=',False),('sent','=',False),('exception','=',False),('ignored','=',False),('bounced','=',False)]"/>
                <filterstring="Ignored"name="filter_ignored"domain="[('scheduled','!=',False),('sent','=',False),('exception','=',False),('ignored','!=',False)]"/>
                <filterstring="Sent"name="filter_sent"domain="[('sent','!=',False)]"/>
                <filterstring="Delivered"name="filter_delivered"domain="[('sent','!=',False),('exception','=',False),('bounced','=',False)]"/>
                <separator/>
                <filterstring="Opened"name="filter_opened"domain="[('opened','!=',False)]"/>
                <filterstring="Clicked"name="filter_clicked"domain="[('clicked','!=',False)]"/>
                <filterstring="Replied"name="filter_replied"domain="[('replied','!=',False)]"/>
                <filterstring="Bounced"name="filter_bounced"domain="[('bounced','!=',False)]"/>
                <filterstring="Failed"name="filter_failed"domain="[('exception','!=',False)]"/>
                <groupexpand="0"string="GroupBy">
                    <filterstring="State"name="state"domain="[]"context="{'group_by':'state'}"/>
                    <filterstring="OpenDate"name="group_open_date"context="{'group_by':'opened:day'}"/>
                    <filterstring="ReplyDate"name="group_reply_date"context="{'group_by':'replied:day'}"/>
                    <filterstring="LastStateUpdate"name="state_update"domain="[]"context="{'group_by':'state_update'}"/>
                    <filterstring="MassMailing" name="mass_mailing"domain="[]"context="{'group_by':'mass_mailing_id'}"/>
                </group>
            </search>
        </field>
    </record>

    <recordmodel="ir.ui.view"id="mailing_trace_view_tree">
        <fieldname="name">mailing.trace.tree</field>
        <fieldname="model">mailing.trace</field>
        <fieldname="arch"type="xml">
            <treestring="MailStatistics"create="0">
                <fieldname="mass_mailing_id"/>
                <fieldname="email"/>
                <fieldname="state"/>
                <fieldname="message_id"/>
                <fieldname="scheduled"/>
                <fieldname="sent"/>
                <fieldname="exception"/>
                <fieldname="opened"/>
                <fieldname="clicked"/>
                <fieldname="replied"/>
                <fieldname="bounced"/>
                <fieldname="ignored"/>
            </tree>
        </field>
    </record>

    <recordmodel="ir.ui.view"id="mailing_trace_view_form">
        <fieldname="name">mailing.trace.form</field>
        <fieldname="model">mailing.trace</field>
        <fieldname="arch"type="xml">
            <formstring="MailStatistics"create="0">
                <header>
                    <fieldname="state"widget="statusbar"/>
                </header>
                <sheet>
                    <divclass="alertalert-infotext-center"role="alert"name="alert_mail_exception"
                        attrs="{'invisible':[('exception','=',False),('bounced','=',False)]}">
                        <p>
                            <strong><spanname="trace_type_name_mail">Thisemail</span>
                            <spanattrs="{'invisible':[('exception','=',False)]}">couldnotbesent</span>
                            <spanattrs="{'invisible':[('bounced','=',False)]}">appearstobeinvalid</span>
                            </strong>
                        </p>
                    </div>
                    <group>
                        <groupstring="Recipient">
                            <fieldname="trace_type"invisible="1"/>
                            <fieldname="email"/>
                            <fieldname="mail_mail_id_int"/>
                            <fieldname="message_id"/>
                        </group>
                        <groupstring="Document">
                            <fieldname="model"/>
                            <fieldname="res_id"/>
                            <fieldname="state_update"/>
                        </group>
                    </group>
                    <groupstring="Marketing">
                        <group>
                            <fieldname="mass_mailing_id"/>
                            <fieldname="campaign_id"/>
                            <fieldname="sent"/>
                            <fieldname="opened"/>
                            <fieldname="clicked"/>
                            <fieldname="replied"/>
                        </group>
                        <group>
                            <fieldname="exception"/>
                            <fieldname="ignored"/>
                            <fieldname="bounced"/>
                            <fieldname="failure_type"/>
                        </group>
                    </group>
                </sheet>
            </form>
        </field>
    </record>

    <recordid="view_mail_mail_statistics_graph"model="ir.ui.view">
        <fieldname="name">MailStatisticsGraph</field>
        <fieldname="model">mailing.trace</field>
        <fieldname="arch"type="xml">
            <graphstring="MailStatistics"type="bar"stacked="True"interval="day"sample="1">
                <fieldname="state_update"type="row"interval="day"/>
                <fieldname="state"type="row"/>
            </graph>
        </field>
    </record>

    <recordid="mailing_trace_action"model="ir.actions.act_window">
        <fieldname="name">MailingTraces</field>
        <fieldname="res_model">mailing.trace</field>
        <fieldname="view_mode">tree,form,graph,pivot</field>
        <fieldname="domain">[]</field>
    </record>

    <recordid="action_view_mail_mail_statistics_mailing"model="ir.actions.act_window">
        <fieldname="name">MailStatistics</field>
        <fieldname="res_model">mailing.trace</field>
        <fieldname="view_mode">graph,tree,form,pivot</field>
        <fieldname="domain">[]</field>
        <fieldname="context">{'search_default_mass_mailing_id':active_id}</field>
        <fieldname="help"type="html">
            <pclass="o_view_nocontent_smiling_face">
                Nodatayet!
            </p>
        </field>
    </record>

    <!--AddinTechnical/Email-->
    <menuitemid="menu_email_statistics"
        name="MailingTraces"
        parent="mass_mailing.mailing_mailing_menu_technical"sequence="2"
        action="mailing_trace_action"/>
</flectra>
