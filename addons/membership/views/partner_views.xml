<?xmlversion="1.0"encoding="utf-8"?>
<flectra>
        <!--MEMBERSHIP/CURRENTMEMBERS-->

        <recordmodel="ir.ui.view"id="membership_members_tree">
            <fieldname="name">Members</field>
            <fieldname="model">res.partner</field>
            <fieldname="arch"type="xml">
                <treestring="Members">
                    <fieldname="name"/>
                    <fieldname="membership_state"/>
                    <fieldname="associate_member"/>
                    <fieldname="membership_start"/>
                    <fieldname="membership_stop"/>
                    <fieldname="user_id"invisible="1"/>
                    <fieldname="company_id"groups="base.group_multi_company"/>
                </tree>
            </field>
        </record>

        <recordid="view_res_partner_member_filter"model="ir.ui.view">
            <fieldname="name">res.partner.select</field>
            <fieldname="model">res.partner</field>
            <fieldname="priority">50</field>
            <fieldname="arch"type="xml">
                <searchstring="MembershipPartners">
                    <fieldname="name"
                       filter_domain="['|','|',('name','ilike',self),('parent_id','ilike',self),('ref','=',self)]"/>
                    <fieldname="category_id"/>
                    <fieldname="membership_start"invisible="1"/>
                    <fieldname="membership_stop"string="EndMembershipDate"/>
                    <filtername="customer"string="Customers"domain="[('customer_rank','>',0)]"/>
                    <filtername="supplier"string="Vendors"domain="[('supplier_rank','>',0)]"/>
                    <separator/>
                    <filtername="all_members"string="Members"domain="[('membership_state','in',['invoiced','paid','free'])]"help="Invoiced/Paid/Free"/>
                    <separator/>
                    <filterstring="StartDate"name="start_date"date="membership_start"/>
                    <filterstring="EndDate"name="end_date"date="membership_stop"/>
                    <groupexpand="0"string="GroupBy"colspan="10"col="8">
                        <filterstring="Salesperson"name="salesperson"domain="[]"context="{'group_by':'user_id'}"/>
                        <filterstring="AssociateMember"name="associate"domain="[]"context="{'group_by':'associate_member'}"/>
                        <filterstring="MembershipState"name="membership_state"domain="[]"context="{'group_by':'membership_state'}"/>
                        <filterstring="StartDate"name="start_month"help="StartingDateOfMembership"domain="[]"context="{'group_by':'membership_start'}"/>
                        <filterstring="EndDate"name="end_month"help="EndingDateOfMembership"domain="[]"context="{'group_by':'membership_stop'}"/>
                    </group>
                </search>
            </field>
        </record>

        <recordmodel="ir.actions.act_window"id="action_membership_members">
            <fieldname="name">Members</field>
            <fieldname="res_model">res.partner</field>
            <fieldname="view_mode">kanban,tree,form,activity</field>
            <fieldname="search_view_id"ref="view_res_partner_member_filter"/>
            <fieldname="context">{"search_default_all_members":1,"default_free_member":True}</field>
            <fieldname="help"type="html">
                <pclass="o_view_nocontent_smiling_face">
                  Addanewmember
                </p><p>
                  Flectrahelpsyoueasilytrackallactivitiesrelatedtoamember:
                  CurrentMembershipStatus,DiscussionsandHistoryofMembership,etc.
                </p>
            </field>
        </record>

        <recordmodel="ir.actions.act_window.view"id="action_membership_members_view_tree">
            <fieldname="sequence"eval="2"/>
            <fieldname="view_mode">tree</field>
            <fieldname="view_id"ref="membership_members_tree"/>
            <fieldname="act_window_id"ref="action_membership_members"/>
        </record>

        <recordmodel="ir.actions.act_window.view"id="action_membership_members_view_form">
            <fieldname="sequence"eval="3"/>
            <fieldname="view_mode">form</field>
            <fieldname="view_id"ref="base.view_partner_form"/>
            <fieldname="act_window_id"ref="action_membership_members"/>
        </record>
         <recordmodel="ir.actions.act_window.view"id="action_membership_members_view_kanban">
            <fieldname="sequence"eval="1"/>
            <fieldname="view_mode">kanban</field>
            <fieldname="view_id"ref="base.res_partner_kanban_view"/>
            <fieldname="act_window_id"ref="action_membership_members"/>
        </record>
        <menuitemname="Members"id="menu_membership"sequence="0"parent="menu_association"action="action_membership_members"/>

        <!--PARTNERS-->

        <recordmodel="ir.ui.view"id="view_partner_tree">
            <fieldname="name">res.partner.tree.form.inherit</field>
            <fieldname="model">res.partner</field>
            <fieldname="inherit_id"ref="base.view_partner_tree"/>
            <fieldname="arch"type="xml">
                <fieldname="category_id"position="after">
                    <fieldname="membership_state"optional="hide"/>
                </field>
            </field>
        </record>

        <recordmodel="ir.ui.view"id="view_partner_form">
            <fieldname="name">res.partner.form.inherit</field>
            <fieldname="model">res.partner</field>
            <fieldname="inherit_id"ref="base.view_partner_form"/>
            <fieldname="arch"type="xml">
                <notebookposition="inside">
                    <pagestring="Membership"name="membership">
                        <group>
                            <group>
                                <fieldname="free_member"/>
                                <labelfor="membership_state"/>
                                <div>
                                    <fieldname="membership_state"/>
                                    <buttonname="%(action_membership_invoice_view)d"type="action"string="BuyMembership"
                                        attrs="{'invisible':[('free_member','=',True)]}"class="oe_link"/>
                                </div>
                            </group>
                            <group>
                                <fieldname="associate_member"attrs="{'invisible':[('free_member','=',True)]}"/>
                                <fieldname="membership_start"attrs="{'invisible':[('membership_start','=',False)]}"/>
                                <fieldname="membership_stop"attrs="{'invisible':[('membership_stop','=',False)]}"/>
                                <fieldname="membership_cancel"attrs="{'invisible':[('membership_cancel','=',False)]}"/>
                            </group>
                        </group>
                        <fieldname="member_lines"nolabel="1"colspan="4"readonly="1">
                            <treestring="Memberships">
                                <fieldname="date"/>
                                <fieldname="membership_id"/>
                                <fieldname="member_price"/>
                                <fieldname="account_invoice_id"/>
                                <fieldname="state"/>
                            </tree>
                            <formstring="Memberships">
                                <groupcol="2">
                                    <group>
                                        <fieldname="membership_id"/>
                                        <fieldname="date"/>
                                        <fieldname="state"/>
                                    </group>
                                    <group>
                                        <fieldname="member_price"/>
                                        <fieldname="account_invoice_id"context="{'form_view_ref':'account.view_move_form'}"/>
                                    </group>
                                </group>
                            </form>
                        </field>

                    </page>
                </notebook>
            </field>
        </record>
</flectra>
