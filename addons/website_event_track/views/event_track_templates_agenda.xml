<?xmlversion="1.0"encoding="utf-8"?>
<flectra>

<!--Revampedagenda:Willneedtoreplaceagenda_onlinefromwebsite_event_trackinmaster-->
<templateid="agenda_online"name="TrackOnline:Agenda">
    <tt-call="website_event.layout">
        <divclass="o_wevent_onlineo_weagenda_index">
            <!--Options-->
            <tt-set="option_track_wishlist"t-value="notevent.is_doneandis_view_active('website_event_track.agenda_topbar_wishlist')"/>
            <!--Topbar-->
            <tt-call="website_event_track.agenda_topbar"/>
            <!--Drag/DropArea-->
            <divclass="oe_structure"id="oe_structure_website_event_track_agenda_1"/>
            <!--Content-->
            <divclass="container">
                <divclass="rowmb-5">
                    <tt-call="website_event_track.agenda_main"/>
                </div>
            </div>
            <!--Drag/DropArea-->
            <divclass="oe_structure"id="oe_structure_website_event_track_agenda_2"/>
        </div>
    </t>
</template>

<!--============================================================-->
<!--TOPBAR:BASENAVIGATION-->
<!--============================================================-->

<!--Maintopbar-->
<templateid="agenda_topbar"name="AgendaTools">
    <navclass="navbarnavbar-lightborder-topshadow-smd-print-none">
        <divclass="container">
            <divclass="d-flexflex-columnflex-sm-rowjustify-content-betweenw-100">
                <ulclass="o_weagenda_topbar_filterso_wevent_index_topbar_filtersnav">
                </ul>
                <divclass="form-inlinepl-sm-3pr-0">
                    <labelclass="invisibletext-mutedmr-2"id="search_summary"><spanid="search_number"class="mr-1">0</span>Results</label>
                    <inputtype="text"class="form-control"placeholder="FilterTracks..."id="event_track_search"/>
                </div>
            </div>
        </div>
    </nav>
</template>

<!--Option:Tracksdisplay:optionalwishlist-->
<templateid="agenda_topbar_wishlist"
    inherit_id="website_event_track.agenda_topbar"
    name="AllowWishlists"
    active="True"
    customize_show="True">
    <xpathexpr="//ul[hasclass('o_weagenda_topbar_filters')]"position="inside">
    </xpath>
</template>

<!--============================================================-->
<!--CONTENT:MAINTEMPLATES-->
<!--============================================================-->

<!--AgendaMainDisplay-->
<templateid="agenda_main"name="Tracks:MainDisplay">
    <!--Notracks-->
    <divclass="col-12"t-if="nottracks_by_days">
        <divclass="h2mb-3">Notrackfound.</div>
        <divt-if="search_key"class="alertalert-infotext-center">
            <pclass="m-0">Wedidnotfindanytrackmatchingyour<strongt-esc="search_key"/>search.</p>
        </div>
        <divt-else=""class="alertalert-infotext-center"groups="event.group_event_manager">
            <pclass="m-0">Schedulesometrackstogetstarted!</p>
        </div>
    </div>

    <sectiont-else=""class="col-12"t-foreach="days"t-as="day">
        <!--DAYHEADER-->
        <divclass="o_we_track_day_headermt-3w-100d-flexjustify-content-betweenalign-items-center">
            <divclass="d-flex">
                <spanclass="h1m-0font-weight-bold"t-esc="day"
                    t-options="{'widget':'date','format':'EEEEdd'}"/>
                <divclass="d-flexflex-columnml-2">
                    <spanclass="font-weight-bold"t-esc="day"
                        t-options="{'widget':'date','format':'MMMM'}"/>
                    <spanclass="font-weight-bold"t-esc="day"
                        t-options="{'widget':'date','format':'YYYY'}"/>
                </div>
            </div>
            <smallclass="float-righttext-mutedalign-self-end"><tt-esc="tracks_by_days[day]"/>tracks</small>
        </div>
        <hrclass="mt-2pb-1mb-1"/>

        <!--DayAgenda-->
        <divclass="o_we_online_agenda">
        <tableid="table_search"class="tabletable-smborder-0h-100">
            <!--Header-->
            <tr>
                <thclass="border-0bg-whiteposition-sticky"/>
                <tt-foreach="locations"t-as="location">
                    <tht-if="location"class="activetext-center">
                        <spant-esc="locationandlocation.nameor'Unknown'"/>
                    </th>
                </t>
            </tr>

            <!--TimeSlots-->
            <tt-set="used_cells"t-value="[]"/>
            <tt-foreach="time_slots[day]"t-as="time_slot">
                <tt-set="is_round_hour"t-value="time_slot==time_slot.replace(minute=0)"/>
                <tt-set="is_half_hour"t-value="time_slot==time_slot.replace(minute=30)"/>

                <trt-att-class="'%s'%('active'ifis_round_hourelse'')">
                    <tdclass="active">
                        <bt-if="is_round_hour"t-esc="time_slots[day][time_slot]['formatted_time']"/>
                    </td>

                    <tt-foreach="locations"t-as="location">
                        <tt-set="tracks"t-value="time_slots[day][time_slot].get(location,{})"/>
                        <tt-if="tracks">
                            <tt-foreach="tracks"t-as="track">
                                <tt-set="_classes"
                                    t-value="'text-center%s%s%s'%(
                                        'event_color_%s'%(track.color)iftrack.colorelse'bg-100',
                                        'event_trackh-100'iftrackelse'',
                                        'o_location_size_%d'%len(locations),
                                    )"/>
                                <tt-if="track.location_idandtrack.location_id==location">
                                    <tdt-att-rowspan="tracks[track]['rowspan']"
                                        t-att-class="_classes">
                                        <tt-call="website_event_track.agenda_main_track"/>
                                    </td>
                                </t>
                                <tt-else="">
                                    <tdt-att-colspan="len(locations)-1"
                                        t-att-rowspan="tracks[track]['rowspan']"
                                        t-att-class="_classes">
                                        <tt-call="website_event_track.agenda_main_track"/>
                                    </td>
                                </t>
                                <tt-set="used_cells"t-value="used_cells+tracks[track]['occupied_cells']"/>
                            </t>
                        </t>
                        <tt-elif="locationand(time_slot,location)notinused_cells">
                            <tdt-att-rowspan="1"
                                t-att-class="'o_location_size_%s%s'%(len(locations),
                                    'o_we_agenda_time_slot_half'ifis_half_hourelse
                                    'o_we_agenda_time_slot_main'ifis_round_hourelse
                                    ''
                                )"><div/></td>
                        </t>
                    </t>
                </tr>
            </t>
        </table>
        </div>
    </section>
</template>

<templateid="agenda_main_track"name="TrackAgenda:Track">
    <divclass="d-flexflex-columnh-100">
        <divclass="d-flexjustify-content-endflex-wrap-reversealign-items-centero_weagenda_track_badges">
            <smallt-if="track.is_track_liveandnottrack.is_track_doneandtrack.website_published"
                class="mx-1badgebadge-danger">Live
            </small>
            <smallt-if="nottrack.website_publishedanduser_event_managerandtrack.stage_id.is_accepted"
                   title="Unpublished"
                   class="ml-1badgebadge-dangero_wevent_online_badge_unpublished">Unpublished</small>
            <smallt-if="nottrack.stage_id.is_accepted"title="NotAccepted"
                   class="ml-1badgebadge-dangero_wevent_online_badge_unpublished">NotAccepted</small>
            <spant-if="option_track_wishlist">
                <tt-call="website_event_track.track_widget_reminder">
                    <tt-set="reminder_light"t-value="True"/>
                    <tt-set="reminder_small"t-value="True"/>
                    <tt-set="light_theme"t-value="False"/>
                </t>
            </span>
        </div>

        <divclass="o_we_agenda_card_contentd-flexflex-columnjustify-content-centermy-1">
            <divt-att-class="'text-black'iftrack.website_publishedoruser_event_managerelse'text-muted'"
                 t-att-onclick="'window.location=\'/event/%s/track/%s\''%(slug(event),slug(track))
                    iftrack.website_publishedoruser_event_managerelse''">
                <spanclass="o_we_agenda_card_titletext-bold"t-esc="track.name"/>
            </div>
            <divclass="text-mutedtext-center">
                <smallt-if="track.partner_idortrack.partner_name">
                    <tt-esc="track.partner_id.sudo().nameortrack.partner_name"/></small>
            </div>
            <divclass="d-flexjustify-content-centerflex-wrap">
                <tt-foreach="track.tag_ids"t-as="tag">
                    <spant-if="tag.color"t-att-title="tag.name"
                          t-attf-class="mr-1mt-1badge#{'o_tag_color_'+str(tag.color)}"t-esc="tag.name"
                          t-attf-onclick="
                            varvalue='#{tag.name}';
                            vartarget=$('#event_track_search');
                            if(target.val()==value){target.val('');}else{target.val(value);}
                            target.trigger('input');
                          "
                    />
                </t>
            </div>
        </div>
    </div>
</template>

</flectra>
