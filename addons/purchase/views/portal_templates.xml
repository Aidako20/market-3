<?xmlversion="1.0"encoding="utf-8"?>
<flectra>

  <templateid="portal_my_home_menu_purchase"name="Portallayout:purchasemenuentries"inherit_id="portal.portal_breadcrumbs"priority="25">
    <xpathexpr="//ol[hasclass('o_portal_submenu')]"position="inside">
      <lit-if="page_name=='purchase'orpurchase_order"t-attf-class="breadcrumb-item#{'active'ifnotpurchase_orderelse''}">
        <at-if="purchase_order"t-attf-href="/my/purchase?{{keep_query()}}">PurchaseOrders</a>
        <tt-else="">PurchaseOrders</t>
      </li>
      <lit-if="purchase_order"class="breadcrumb-itemactive">
        <tt-esc="purchase_order.name"/>
      </li>
    </xpath>
  </template>

  <templateid="portal_my_home_purchase"name="ShowPurchaseOrders"customize_show="True"inherit_id="portal.portal_my_home"priority="25">
    <xpathexpr="//div[hasclass('o_portal_docs')]"position="inside">
        <tt-call="portal.portal_docs_entry">
            <tt-set="title">PurchaseOrders</t>
            <tt-set="url"t-value="'/my/purchase'"/>
            <tt-set="placeholder_count"t-value="'purchase_count'"/>
        </t>
    </xpath>
  </template>

  <templateid="portal_my_purchase_orders"name="Portal:MyPurchaseOrders">
    <tt-call="portal.portal_layout">
      <tt-set="breadcrumbs_searchbar"t-value="True"/>
      <tt-call="portal.portal_searchbar"/>
      <tt-if="orders"t-call="portal.portal_table">
        <thead>
          <trclass="active">
            <th>PurchaseOrders#</th>
            <thclass="text-right">ConfirmationDate</th>
            <th></th>
            <thclass="text-right">Total</th>
          </tr>
        </thead>
        <tbody>
          <tt-foreach="orders"t-as="order">
            <tr>
              <td>
                <at-att-href="order.get_portal_url()">
                  <tt-esc="order.name"/>
               </a>
              </td>
              <tdclass="text-right">
                <spant-field="order.date_approve"/>
              </td>
              <td>
                <tt-if="order.invoice_status=='toinvoice'">
                  <spanclass="badgebadge-info"><iclass="fafa-fwfa-file-text"/>WaitingforBill</span>
                </t>
                <tt-if="order.state=='cancel'">
                  <spanclass="badgebadge-secondary"><iclass="fafa-fwfa-remove"/>Cancelled</span>
                </t>
              </td>
              <tdclass="text-right">
                <spant-field="order.amount_total"t-options='{"widget":"monetary","display_currency":order.currency_id}'/>
              </td>
            </tr>
          </t>
        </tbody>
      </t>
    </t>
  </template>

  <templateid="portal_my_purchase_order"name="Portal:MyPurchaseOrder">
    <tt-call="portal.portal_layout">
      <tt-set="purchase_order"t-value="order"/>
      <tt-set="o_portal_fullwidth_alert"groups="purchase.group_purchase_manager">
        <tt-call="portal.portal_back_in_edit_mode">
          <tt-set="backend_url"t-value="'/web#return_label=Website&amp;model=%s&amp;id=%s&amp;action=%s&amp;view_type=form'%(purchase_order._name,purchase_order.id,purchase_order.env.ref('purchase.purchase_rfq').id)"/>
        </t>
      </t>
      <divid="optional_placeholder"></div>
      <divclass="container">
        <divclass="rowmt16o_portal_purchase_sidebar">
          <!--Sidebar-->
          <tt-call="portal.portal_record_sidebar">
            <tt-set="classes"t-value="'col-lg-autod-print-none'"/>
              <tt-set="title">
                <h2class="mb-0">
                  <bt-field="purchase_order.amount_total"data-id="total_amount"/>
                </h2>
              </t>
            <tt-set="entries">
              <ulclass="list-grouplist-group-flushflex-wrapflex-rowflex-lg-column">
                <liclass="list-group-itemflex-grow-1">
                  <divclass="o_download_pdfbtn-toolbarflex-sm-nowrap">
                    <divclass="btn-groupflex-grow-1mr-1mb-1">
                      <aclass="btnbtn-secondarybtn-blocko_download_btn"t-att-href="purchase_order.get_portal_url(report_type='pdf',download=True)"title="Download"><iclass="fafa-download"/>Download</a>
                    </div>
                    <divclass="btn-groupflex-grow-1mb-1">
                        <aclass="btnbtn-secondarybtn-blocko_print_btno_portal_invoice_print"t-att-href="purchase_order.get_portal_url(report_type='pdf')"id="print_invoice_report"title="Print"target="_blank"><iclass="fafa-print"/>Print</a>
                    </div>
                  </div>
                </li>

                <lit-if="purchase_order.user_id"class="list-group-itemflex-grow-1">
                  <divclass="smallmb-1">
                    <strongclass="text-muted">PurchaseRepresentative</strong>
                  </div>
                  <divclass="rowflex-nowrap">
                    <divclass="colflex-grow-0pr-2">
                      <imgclass="rounded-circlemr4float-lefto_portal_contact_img"t-if="purchase_order.user_id.image_1024"t-att-src="image_data_uri(purchase_order.user_id.image_1024)"alt="Contact"/>
                      <imgclass="rounded-circlemr4float-lefto_portal_contact_img"t-if="notpurchase_order.user_id.image_1024"src="/web/static/src/img/placeholder.png"alt="Contact"/>
                    </div>
                    <divclass="colpl-0"style="min-width:150px">
                      <spant-field="purchase_order.user_id"t-options='{"widget":"contact","fields":["name","phone"],"no_marker":True}'/>
                      <ahref="#discussion"class="small"><iclass="fafa-comment"></i>Sendmessage</a>
                    </div>
                  </div>
                </li>
              </ul>
            </t>
          </t>
          <divclass="col-lgcol-12justify-content-endw-100">
            <divclass="cardpb-5">
              <divclass="card-headerbg-whitepb-1">
                <divclass="row">
                  <divclass="col-lg-12">
                    <h2class="font-weight-normal">
                      <tt-if="order.statein['draft','sent']">RequestforQuotation</t>
                      <tt-else="1">
                        PurchaseOrder
                      </t>
                      <spanclass="font-italic"t-esc="order.name"/>
                    </h2>
                  </div>
                </div>
              </div>
              <divclass="card-body">
                <divclass="mb-4">
                  <strongclass="d-blockmb-1">From:</strong>
                  <addresst-field="order.company_id.partner_id"t-options='{"widget":"contact","fields":["address","name"],"no_marker":True}'/>
                  <strong>ConfirmationDate:</strong><spant-field="order.date_approve"t-options='{"widget":"date"}'/><br/>
                  <divt-att-class="'d-inline'iforder.date_plannedelse'd-none'">
                    <strong>ReceiptDate:</strong><spanclass="ml-1"t-field="order.date_planned"t-options='{"widget":"date"}'/>
                  </div>
                </div>
                <h3class="font-weight-normal">Pricing</h3>
                <divclass="table-responsive">
                  <tableclass="tabletable-sm">
                    <theadclass="bg-100">
                      <tr>
                        <th>Products</th>
                        <thclass="text-rightd-noned-sm-table-cell"t-if="order.statein['purchase','done']">UnitPrice</th>
                        <thclass="text-right">Quantity</th>
                        <thclass="text-right"t-if="order.statein['purchase','done']">Subtotal</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tt-foreach="order.order_line"t-as="ol">
                        <trt-att-class="'bg-200font-weight-boldo_line_section'ifol.display_type=='line_section'else'font-italico_line_note'ifol.display_type=='line_note'else''">
                          <tt-if="notol.display_type">
                            <td>
                              <imgt-att-src="image_data_uri(resize_to_48(ol.product_id.image_1024))"alt="Product"class="d-noned-lg-inline"/>
                              <spant-esc="ol.name"/>
                            </td>
                            <tdclass="text-rightd-noned-sm-table-cell"t-if="order.statein['purchase','done']">
                              <spant-field="ol.price_unit"t-options='{"widget":"monetary","display_currency":order.currency_id}'/>
                            </td>
                            <tdclass="text-right">
                              <spant-esc="ol.product_qty"/>
                            </td>
                            <tdclass="text-right"t-if="order.statein['purchase','done']">
                              <spant-field="ol.price_subtotal"t-options='{"widget":"monetary","display_currency":order.currency_id}'/>
                            </td>
                          </t>
                          <tt-if="ol.display_type=='line_section'">
                              <tdcolspan="99">
                                  <spant-field="ol.name"/>
                              </td>
                              <tt-set="current_section"t-value="line"/>
                              <tt-set="current_subtotal"t-value="0"/>
                          </t>
                          <tt-if="ol.display_type=='line_note'">
                              <tdcolspan="99">
                                  <spant-field="ol.name"/>
                              </td>
                          </t>
                        </tr>
                      </t>
                    </tbody>
                  </table>
                </div>
                <divclass="row"t-if="order.statein['purchase','done']">
                  <divclass="col-sm-7col-md-5ml-auto">
                    <tableclass="tabletable-sm">
                      <tbody>
                        <tr>
                          <td>
                            <strong>UntaxedAmount:</strong>
                          </td>
                          <tdclass="text-right">
                            <spant-field="order.amount_untaxed"t-options='{"widget":"monetary","display_currency":order.currency_id}'/>
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <strong>Taxes:</strong>
                          </td>
                          <tdclass="text-right">
                            <spant-field="order.amount_tax"t-options='{"widget":"monetary","display_currency":order.currency_id}'/>
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <strong>Total:</strong>
                          </td>
                          <tdclass="text-right">
                            <spant-field="order.amount_total"t-options='{"widget":"monetary","display_currency":order.currency_id}'/>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
            <divid="purchase_order_communication"class="mt-4">
              <h2>History</h2>
              <tt-call="portal.message_thread">
                <tt-set="object"t-value="purchase_order"/>
              </t>
            </div>
          </div>
        </div>
      </div>
      <divclass="oe_structuremb32"/>
    </t>
  </template>

  <templateid="portal_my_purchase_order_update_date"name="Portal:MyPurchaseOrderUpdateDates"inherit_id="purchase.portal_my_purchase_order"primary="True">
    <xpathexpr="//div[hasclass('card-body')]"position="replace">
      <divclass="card-body">
        <divclass="mb-4">
          <strong>ConfirmationDate:</strong><spant-field="order.date_approve"t-options='{"widget":"date"}'/><br/>
          <divt-att-class="'d-inline'iforder.date_plannedelse'd-none'">
            <strong>ReceiptDate:</strong><spanclass="ml-1"t-field="order.date_planned"t-options='{"widget":"date"}'/>
          </div>
        </div>
        <h3class="font-weight-normal">Pricing</h3>
          <divclass="table-responsive">
            <tableclass="tabletable-sm">
              <theadclass="bg-100">
                <tr>
                  <th>Products</th>
                  <thclass="text-rightd-noned-sm-table-cell">UnitPrice</th>
                  <thclass="text-right">Quantity</th>
                  <thclass="text-right">ScheduledDate</th>
                  <thclass="text-right"style="color:#3aadaa"><strong>UpdateDatesHere</strong></th>
                  <thclass="text-right">Subtotal</th>
                </tr>
              </thead>
              <tbody>
                <tt-foreach="order.order_line"t-as="ol">
                  <tt-if="notol.display_type">
                    <tr>
                      <td>
                        <imgt-att-src="image_data_uri(resize_to_48(ol.product_id.image_1024))"alt="Product"class="d-noned-lg-inline"/>
                        <spant-esc="ol.name"/>
                      </td>
                      <tdclass="text-rightd-noned-sm-table-cell">
                        <spant-field="ol.price_unit"t-options='{"widget":"monetary","display_currency":order.currency_id}'/>
                      </td>
                      <tdclass="text-right">
                        <spant-esc="ol.product_qty"/>
                      </td>
                      <tdclass="text-right">
                        <spant-esc="ol.date_planned.date()"/>
                      </td>
                      <tdclass="text-right">
                        <formt-attf-action="/my/purchase/#{order.id}/update?access_token=#{order.access_token}"method="post">
                          <inputtype="hidden"name="csrf_token"t-att-value="request.csrf_token()"/>
                          <divclass="container">
                            <divclass="form-group">
                              <divclass="input-groupdate">
                                  <inputtype="text"class="form-controldatetimepicker-inputo-purchase-datetimepicker"t-attf-id="datetimepicker_#{ol.id}"t-att-name="ol.id"
                                    data-toggle="datetimepicker"data-date-format="YYYY-MM-DD"t-attf-data-target="#datetimepicker_#{ol.id}"/>
                              </div>
                            </div>
                          </div>
                        </form>
                      </td>
                      <tdclass="text-right">
                        <spant-field="ol.price_subtotal"t-options='{"widget":"monetary","display_currency":order.currency_id}'/>
                      </td>
                    </tr>
                  </t>
                  <tt-if="ol.display_type">
                    <tr>
                      <tdcolspan="99">
                        <spant-esc="ol.name"/>
                      </td>
                    </tr>
                  </t>
                </t>
              </tbody>
            </table>
          </div>
          <divclass="row">
            <divclass="col-sm-7col-md-5ml-auto">
              <tableclass="tabletable-sm">
                <tbody>
                  <tr>
                    <td>
                      <strong>UntaxedAmount:</strong>
                    </td>
                    <tdclass="text-right">
                      <spant-field="order.amount_untaxed"t-options='{"widget":"monetary","display_currency":order.currency_id}'/>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <strong>Taxes:</strong>
                    </td>
                    <tdclass="text-right">
                      <spant-field="order.amount_tax"t-options='{"widget":"monetary","display_currency":order.currency_id}'/>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <strong>Total:</strong>
                    </td>
                    <tdclass="text-right">
                      <spant-field="order.amount_total"t-options='{"widget":"monetary","display_currency":order.currency_id}'/>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
      </div>
    </xpath>
  </template>

</flectra>
