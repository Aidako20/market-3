<?xmlversion="1.0"encoding="UTF-8"?>
<templates>
    <spant-name="LunchWidget">
        <tt-foreach="widget.alerts"t-as="alert">
            <divclass="alertalert-warningmb-0"role="alert">
                <tt-raw="alert.message"/><!--alert.messageiscomingfromafields.Htmlsoitshouldbesafe-->
            </div>
        </t>
        <divclass="o_lunch_bannercontainer-fluid">
            <divclass="o_lunch_widgetrowpy-3py-md-0">
                <divclass="o_lunch_widget_infocol-12col-md-4cardborder-0">
                    <divclass="card-bodyrowno-guttersalign-items-center">
                        <divclass="col-3col-md-6col-lg-3">
                            <imgclass="o_image_64_coverrounded-circle"t-attf-src="{{widget.userimage}}"/>
                        </div>
                        <divclass="col-9col-md-6col-lg-9">
                            <divclass="pl-3">
                                <divclass="o_lunch_user_fieldpy-1"/>
                                <divclass="o_lunch_location_fieldpy-1"/>
                                <divclass="d-flexflex-rowpy-1">
                                    <spanclass="flex-grow-1">YourAccount</span>
                                    <tt-call="currency_field">
                                        <tt-set="value"t-value="widget.wallet"/>
                                        <tt-set="currency"t-value="widget.currency"/>
                                    </t>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <divclass="o_lunch_widget_infocol-12col-md-4cardborder-0">
                    <tt-if="!_.isEmpty(widget.lines)">
                        <tt-if="widget.raw_state=='ordered'">
                            <tt-set="state_class"t-value="'badge-warningo_lunch_ordered'"/>
                        </t>
                        <tt-else="widget.raw_state=='confirmed'">
                            <tt-set="state_class"t-value="'badge-successo_lunch_confirmed'"/>
                        </t>
                        <divclass="card-body">
                            <h4class="card-title">
                                Yourorder
                                <buttont-if="widget.raw_state!='confirmed'"class="btnbtn-smbtn-iconbtn-linkfafa-trasho_lunch_widget_unlink"/>
                                <spant-if="widget.raw_state!='new'"t-esc="widget.state"t-attf-class="badgebadge-pill{{state_class}}"/>
                            </h4>
                            <ulclass="list-unstyledo_lunch_widget_lines">
                                <lit-foreach="widget.lines"t-as="line">
                                    <divclass="d-flexalign-items-center">
                                        <divclass="flex-grow-0flex-shrink-0o_lunch_product_quantity">
                                            <buttonclass="btnbtn-smbtn-iconbtn-linkfafa-minus-circleo_remove_product"t-if="widget.raw_state!='confirmed'"t-attf-data-id="{{line.id}}"/>
                                            <spant-esc="line.quantity"/>
                                            <buttonclass="btnbtn-smbtn-iconbtn-linkfafa-plus-circleo_add_product"t-if="widget.raw_state!='confirmed'"t-attf-data-id="{{line.id}}"/>
                                        </div>
                                        <divclass="flex-grow-1pl-2">
                                            <buttont-esc="line.product[1]"class="btnbtn-linko_lunch_open_wizard"t-attf-data-product-id="{{line.product[0]}}"t-attf-data-id="{{line.id}}"/>
                                        </div>
                                        <divclass="flex-grow-0">
                                            <tt-call="currency_field">
                                                <tt-set="value"t-value="line.product[2]"/>
                                                <tt-set="currency"t-value="widget.currency"/>
                                            </t>
                                        </div>
                                    </div>
                                    <divt-foreach="line.toppings"t-as="topping"class="d-flexflex-row">
                                        <divclass="flex-grow-1pl-5">
                                            <span>+<tt-esc="topping[0]"/></span>
                                        </div>
                                        <divclass="flex-grow-0">
                                            <tt-call="currency_field">
                                                <tt-set="value"t-value="topping[1]"/>
                                                <tt-set="currency"t-value="widget.currency"/>
                                            </t>
                                        </div>
                                    </div>
                                    <spant-if="line.note"t-esc="line.note"class="text-mutedpl-5"/>
                                </li>
                            </ul>
                        </div>
                    </t>
                </div>
                <divclass="o_lunch_widget_infocol-12col-md-4cardborder-0">
                    <tt-if="!_.isEmpty(widget.lines)&amp;&amp;widget.raw_state=='new'">
                        <divclass="card-bodyd-flexflex-columnjustify-content-between">
                            <h4class="card-titled-flexpy-1">
                                <spanclass="flex-grow-1">Total</span>
                                <tt-call="currency_field">
                                    <tt-set="value"t-value="widget.total"/>
                                    <tt-set="currency"t-value="widget.currency"/>
                                </t>
                            </h4>
                            <buttont-if="widget.raw_state=='new'"class="btnbtn-primaryw-100o_lunch_widget_order_button">Ordernow</button>
                        </div>
                    </t>
                </div>
            </div>
        </div>
    </span>

    <spant-name="currency_field"class="o_field_monetaryo_field_numbero_field_widget">
        <tt-js="ctx">
            ctx.value=_.str.sprintf('%.2f',parseFloat(ctx.value));
        </t>
        <tt-if="currency">
            <tt-if="currency.position=='after'">
                <tt-esc="value"/><tt-esc="currency.symbol"/>
            </t>
            <tt-else="">
                <tt-esc="currency.symbol"/><tt-esc="value"/>
            </t>
        </t>
        <tt-else="">
            <tt-esc="value"/>
        </t>
    </span>

    <divt-name="lunch.LunchPaymentDialog">
        <spant-esc="widget.message"/>
    </div>

    <tt-name="LunchWidgetMobile">
        <detailsclass="fixed-bottom"t-attf-open="#{widget.keepOpen}">
            <summaryclass="o_lunch_toggle_cartbtnbtn-primaryw-100">
                <iclass="fafa-fwfa-shopping-cart"/>
                Yourcart
                (<tt-call="currency_field">
                    <tt-set="value"t-value="widget.total"/>
                    <tt-set="currency"t-value="widget.currency"/>
                </t>)
            </summary>
            <tt-call="LunchWidget"/>
        </details>
    </t>
</templates>
