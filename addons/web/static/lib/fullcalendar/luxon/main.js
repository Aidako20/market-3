/*!
FullCalendarLuxonPluginv4.4.0
Docs&License:https://fullcalendar.io/
(c)2019AdamShaw
*/

(function(global,factory){
    typeofexports==='object'&&typeofmodule!=='undefined'?factory(exports,require('luxon'),require('@fullcalendar/core')):
    typeofdefine==='function'&&define.amd?define(['exports','luxon','@fullcalendar/core'],factory):
    (global=global||self,factory(global.FullCalendarLuxon={},global.luxon,global.FullCalendar));
}(this,function(exports,luxon,core){'usestrict';

    /*!*****************************************************************************
    Copyright(c)MicrosoftCorporation.Allrightsreserved.
    LicensedundertheApacheLicense,Version2.0(the"License");youmaynotuse
    thisfileexceptincompliancewiththeLicense.Youmayobtainacopyofthe
    Licenseathttp://www.apache.org/licenses/LICENSE-2.0

    THISCODEISPROVIDEDONAN*ASIS*BASIS,WITHOUTWARRANTIESORCONDITIONSOFANY
    KIND,EITHEREXPRESSORIMPLIED,INCLUDINGWITHOUTLIMITATIONANYIMPLIED
    WARRANTIESORCONDITIONSOFTITLE,FITNESSFORAPARTICULARPURPOSE,
    MERCHANTABLITYORNON-INFRINGEMENT.

    SeetheApacheVersion2.0Licenseforspecificlanguagegoverningpermissions
    andlimitationsundertheLicense.
    ******************************************************************************/
    /*globalReflect,Promise*/

    varextendStatics=function(d,b){
        extendStatics=Object.setPrototypeOf||
            ({__proto__:[]}instanceofArray&&function(d,b){d.__proto__=b;})||
            function(d,b){for(varpinb)if(b.hasOwnProperty(p))d[p]=b[p];};
        returnextendStatics(d,b);
    };

    function__extends(d,b){
        extendStatics(d,b);
        function__(){this.constructor=d;}
        d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new__());
    }

    var__assign=function(){
        __assign=Object.assign||function__assign(t){
            for(vars,i=1,n=arguments.length;i<n;i++){
                s=arguments[i];
                for(varpins)if(Object.prototype.hasOwnProperty.call(s,p))t[p]=s[p];
            }
            returnt;
        };
        return__assign.apply(this,arguments);
    };

    functiontoDateTime(date,calendar){
        if(!(calendarinstanceofcore.Calendar)){
            thrownewError('mustsupplyaCalendarinstance');
        }
        returnluxon.DateTime.fromJSDate(date,{
            zone:calendar.dateEnv.timeZone,
            locale:calendar.dateEnv.locale.codes[0]
        });
    }
    functiontoDuration(duration,calendar){
        if(!(calendarinstanceofcore.Calendar)){
            thrownewError('mustsupplyaCalendarinstance');
        }
        returnluxon.Duration.fromObject(__assign({},duration,{locale:calendar.dateEnv.locale.codes[0]}));
    }
    varLuxonNamedTimeZone=/**@class*/(function(_super){
        __extends(LuxonNamedTimeZone,_super);
        functionLuxonNamedTimeZone(){
            return_super!==null&&_super.apply(this,arguments)||this;
        }
        LuxonNamedTimeZone.prototype.offsetForArray=function(a){
            returnarrayToLuxon(a,this.timeZoneName).offset;
        };
        LuxonNamedTimeZone.prototype.timestampToArray=function(ms){
            returnluxonToArray(luxon.DateTime.fromMillis(ms,{
                zone:this.timeZoneName
            }));
        };
        returnLuxonNamedTimeZone;
    }(core.NamedTimeZoneImpl));
    functionformatWithCmdStr(cmdStr,arg){
        varcmd=parseCmdStr(cmdStr);
        if(arg.end){
            varstart=arrayToLuxon(arg.start.array,arg.timeZone,arg.localeCodes[0]);
            varend=arrayToLuxon(arg.end.array,arg.timeZone,arg.localeCodes[0]);
            returnformatRange(cmd,start.toFormat.bind(start),end.toFormat.bind(end),arg.separator);
        }
        returnarrayToLuxon(arg.date.array,arg.timeZone,arg.localeCodes[0]).toFormat(cmd.whole);
    }
    varmain=core.createPlugin({
        cmdFormatter:formatWithCmdStr,
        namedTimeZonedImpl:LuxonNamedTimeZone
    });
    functionluxonToArray(datetime){
        return[
            datetime.year,
            datetime.month-1,
            datetime.day,
            datetime.hour,
            datetime.minute,
            datetime.second,
            datetime.millisecond
        ];
    }
    functionarrayToLuxon(arr,timeZone,locale){
        returnluxon.DateTime.fromObject({
            zone:timeZone,
            locale:locale,
            year:arr[0],
            month:arr[1]+1,
            day:arr[2],
            hour:arr[3],
            minute:arr[4],
            second:arr[5],
            millisecond:arr[6]
        });
    }
    functionparseCmdStr(cmdStr){
        varparts=cmdStr.match(/^(.*?)\{(.*)\}(.*)$/);//TODO:lookbehindsforescapecharacters
        if(parts){
            varmiddle=parseCmdStr(parts[2]);
            return{
                head:parts[1],
                middle:middle,
                tail:parts[3],
                whole:parts[1]+middle.whole+parts[3]
            };
        }
        else{
            return{
                head:null,
                middle:null,
                tail:null,
                whole:cmdStr
            };
        }
    }
    functionformatRange(cmd,formatStart,formatEnd,separator){
        if(cmd.middle){
            varstartHead=formatStart(cmd.head);
            varstartMiddle=formatRange(cmd.middle,formatStart,formatEnd,separator);
            varstartTail=formatStart(cmd.tail);
            varendHead=formatEnd(cmd.head);
            varendMiddle=formatRange(cmd.middle,formatStart,formatEnd,separator);
            varendTail=formatEnd(cmd.tail);
            if(startHead===endHead&&startTail===endTail){
                returnstartHead+
                    (startMiddle===endMiddle?startMiddle:startMiddle+separator+endMiddle)+
                    startTail;
            }
        }
        varstartWhole=formatStart(cmd.whole);
        varendWhole=formatEnd(cmd.whole);
        if(startWhole===endWhole){
            returnstartWhole;
        }
        else{
            returnstartWhole+separator+endWhole;
        }
    }

    exports.default=main;
    exports.toDateTime=toDateTime;
    exports.toDuration=toDuration;

    Object.defineProperty(exports,'__esModule',{value:true});

}));
