(function(){
    /**
     *SymbolusedinComponentWrappertoredirectOwleventstoFlectralegacy
     *events.
     */
    flectra.widgetSymbol=Symbol('widget');

    /**
     *AddanewmethodtoowlComponentstoensurethatnoperformedRPCis
     *resolved/rejectedwhenthecomponentisdestroyed.
     */
    owl.Component.prototype.rpc=function(){
        returnnewPromise((resolve,reject)=>{
            returnthis.env.services.rpc(...arguments)
                .then(result=>{
                    if(this.__owl__.status!==5/*notdestroyed*/){
                        resolve(result);
                    }
                })
                .catch(reason=>{
                    if(this.__owl__.status!==5)/*notdestroyed*/{
                        reject(reason);
                    }
                });
        });
    };

    /**
     *Patchowl.Component.__triggermethodtocallahookthataddsalistener
     *forthetriggeredeventjustbeforetriggeringit.Thisisusefulif
     *therearelegacywidgetsintheancestors.Inthatcase,therewouldbe
     *awidgetSymbolkeyintheenvironment,correspondingtothehooktocall
     *(seeComponentWrapper).
     */
    constoriginalTrigger=owl.Component.prototype.__trigger;
    owl.Component.prototype.__trigger=function(component,evType,payload){
        if(this.env[flectra.widgetSymbol]){
            this.env[flectra.widgetSymbol](evType);
        }
        originalTrigger.call(this,component,evType,payload);
    };
})();
