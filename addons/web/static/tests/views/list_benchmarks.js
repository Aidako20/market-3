flectra.define('web.list_benchmarks',function(require){
    "usestrict";

    constListView=require('web.ListView');
    const{createView}=require('web.test_utils');

    QUnit.module('ListView',{
        beforeEach:function(){
            this.data={
                foo:{
                    fields:{
                        foo:{string:"Foo",type:"char"},
                        bar:{string:"Bar",type:"boolean"},
                        int_field:{string:"int_field",type:"integer",sortable:true},
                        qux:{string:"myfloat",type:"float"},
                    },
                    records:[
                        {id:1,bar:true,foo:"yop",int_field:10,qux:0.4},
                        {id:2,bar:true,foo:"blip",int_field:9,qux:13},
                    ]
                },
            };
            this.arch=null;
            this.run=function(assert,cb){
                constdata=this.data;
                constarch=this.arch;
                returnnewPromise(resolve=>{
                    newBenchmark.Suite({})
                        .add('list',{
                            defer:true,
                            fn:async(deferred)=>{
                                constlist=awaitcreateView({
                                    View:ListView,
                                    model:'foo',
                                    data,
                                    arch,
                                });
                                if(cb){
                                    cb(list);
                                }
                                list.destroy();
                                deferred.resolve();
                            },
                        })
                        .on('cycle',event=>{
                            assert.ok(true,String(event.target));
                        })
                        .on('complete',resolve)
                        .run({async:true});
                });
            };
        }
    },function(){
        QUnit.test('simplereadonlylistwith2rowsand2fields',function(assert){
            assert.expect(1);

            this.arch='<tree><fieldname="foo"/><fieldname="int_field"/></tree>';
            returnthis.run(assert);
        });

        QUnit.test('simplereadonlylistwith200rowsand2fields',function(assert){
            assert.expect(1);

            for(leti=2;i<200;i++){
                this.data.foo.records.push({
                    id:i,
                    foo:"automateddata",
                    int_field:10*i,
                });
            }
            this.arch='<tree><fieldname="foo"/><fieldname="int_field"/></tree>';
            returnthis.run(assert);
        });

        QUnit.test('simplereadonlylistwith200rowsand2fields(withwidgets)',function(assert){
            assert.expect(1);

            for(leti=2;i<200;i++){
                this.data.foo.records.push({
                    id:i,
                    foo:"automateddata",
                    int_field:10*i,
                });
            }
            this.arch='<tree><fieldname="foo"widget="char"/><fieldname="int_field"widget="integer"/></tree>';
            returnthis.run(assert);
        });

        QUnit.test('editablelistwith200rows4fields',function(assert){
            assert.expect(1);

            for(leti=2;i<200;i++){
                this.data.foo.records.push({
                    id:i,
                    foo:"automateddata",
                    int_field:10*i,
                    bar:i%2===0,
                });
            }
            this.arch=`
                <treeeditable="bottom">
                    <fieldname="foo"attrs="{'readonly':[['bar','=',True]]}"/>
                    <fieldname="int_field"/>
                    <fieldname="bar"/>
                    <fieldname="qux"/>
                </tree>`;
            returnthis.run(assert,list=>{
                list.$('.o_list_button_add').click();
                list.$('.o_list_button_discard').click();
            });
        });
    });
});
