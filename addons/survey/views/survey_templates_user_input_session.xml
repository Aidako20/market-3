<?xmlversion="1.0"encoding="utf-8"?>
<flectra>
<data>
    <templateid="user_input_session"name="SurveyUserInputSession"inherit_id="web.frontend_layout"primary="True">
        <xpathexpr="//div[@id='wrapwrap']"position="before">
            <!--TODODBEFixme:Ifoneday,thereisasurvey_livechatbridgemodule,putthisinthatmodule-->
            <tt-set="no_livechat"t-value="True"/>
        </xpath>
        <xpathexpr="//div[@id='wrapwrap']"position="attributes">
            <attributename="t-att-style"add="('height:100%;overflow:auto;background:url('+'/web/image/survey.survey/%s/background_image'%survey.id+')no-repeatfixedcenter;box-shadow:inset00010000pxrgba(255,255,255,.7);background-size:cover;')ifsurveyandsurvey.background_imageelse'height:100%;overflow:auto;'"/>
        </xpath>
        <xpathexpr="//head/t[@t-call-assets][last()]"position="after">
            <tt-call-assets="survey.survey_assets"lazy_load="True"/>
            <tt-call-assets="survey.survey_user_input_session_assets"lazy_load="True"/>
        </xpath>
        <xpathexpr="//header"position="before">
            <tt-set="no_header"t-value="True"/>
            <tt-set="no_footer"t-value="True"/>
        </xpath>
        <xpathexpr="//header"position="after">
            <divid="wrap"class="oe_structureoe_empty"/>
        </xpath>
    </template>

    <templateid="user_input_session_open"name="Survey:OpenSession">
        <tt-call="survey.user_input_session">
            <divclass="wrappy-3min-vh-100align-items-centerjustify-content-centerd-flexo_survey_session_openo_survey_session_manage"
                t-att-data-survey-access-token="survey.access_token"
                t-att-data-survey-id="survey.id"
                t-att-data-is-start-screen="True">
                <divclass="w-75p-4">
                    <divclass="text-center">
                        <h1class="mb-4"t-field="survey.title"/>
                        <h2class="mb-5font-weight-normal">
                            <span>Goto<at-att-href="survey.session_link"t-esc="survey.session_link"target="_blank"/></span>
                            <iclass="fafa-copyfont-weight-normalml-3o_survey_session_copy"/>
                            <inputclass="o_survey_session_copy_urld-none"type="text"t-att-value="survey.session_link"/>
                        </h2>
                        <h2class="font-weight-normal"><span>Waitingforattendees...</span>
                            <spanclass="ml-1font-weight-boldo_survey_session_attendees_count"t-esc="survey.session_answer_count"/>
                        </h2>
                    </div>
                    <arole="button"
                        class="font-weight-boldfafa-chevron-righto_survey_session_navigationo_survey_session_navigation_nextp-3"/>
                </div>
            </div>
        </t>
    </template>

    <templateid="user_input_session_manage"name="Survey:ManageSession">
        <tt-call="survey.user_input_session">
            <tt-call="survey.user_input_session_manage_content"/>
        </t>
    </template>

    <templateid="user_input_session_manage_content"name="SurveyUserInputSessionManage">
        <tt-set="question"t-value="survey.session_question_id"/>
        <tt-set="is_scored_question"t-value="any(answer.answer_scoreforanswerinquestion.suggested_answer_ids)"/>
        <tt-set="show_bar_chart"t-value="question.question_typein['simple_choice','multiple_choice']"/>
        <tt-set="show_text_answers"t-value="question.question_typein['char_box','date','datetime']andnotquestion.save_as_emailandnotquestion.save_as_nickname"/>
        <divclass="wrapmin-vh-100align-items-centerjustify-content-centerd-flexflex-columno_survey_session_manage"
            t-att-style="'display:none;'ifis_rpc_callelse''"
            t-att-data-is-rpc-call="is_rpc_call"
            t-att-data-survey-id="survey.id"
            t-att-data-attendees-count="survey.session_answer_count"
            t-att-data-survey-access-token="survey.access_token"
            t-att-data-timer="survey.session_question_start_time.isoformat()"
            t-att-data-time-limit-minutes="question.time_limit/60"
            t-att-data-is-scored-question="is_scored_question"
            t-att-data-session-show-leaderboard="survey.session_show_leaderboard"
            t-att-data-question-statistics="question_statistics_graph"
            t-att-data-question-type="question.question_type"
            t-att-data-has-correct-answers="any(answer.is_correctforanswerinquestion.suggested_answer_ids)"
            t-att-data-answers-validity="answers_validity"
            t-att-data-is-last-question="is_last_question"
            t-att-data-current-screen="'question'ifis_scored_questionelse'userInputs'"
            t-att-data-show-bar-chart="show_bar_chart"
            t-att-data-show-text-answers="show_text_answers">
            <divclass="o_survey_question_headerflex-wrappx-3w-100d-flexjustify-content-betweenalign-items-centerposition-absolute">
                <h3>
                    <span>Goto<at-att-href="survey.session_link"t-esc="survey.session_link"target="_blank"/></span>
                    <iclass="fafa-copyfont-weight-normalml-3mr-1o_survey_session_copy"/>
                    <inputclass="o_survey_session_copy_urld-none"type="text"t-att-value="survey.session_link"/>
                </h3>
                <h1t-if="question.is_time_limited"class="o_survey_timer_container">
                    <spanclass="o_survey_timerd-inline-block"/>
                </h1>
                <divclass="text-rightd-flexflex-columnjustify-content-center">
                    <divt-if="show_bar_chartorshow_text_answers">
                        <divclass="progress"title="Attendeesareansweringthequestion...">
                            <divclass="progress-baro_survey_session_progress_smallfont-weight-bold"
                                role="progressbar"aria-valuenow="0"aria-valuemin="0"aria-valuemax="100">
                                <spanclass="px-2">0/<tt-esc="survey.session_answer_count"/></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <divclass="containerpx-4pb-3pt96d-flexflex-columno_survey_session_manage_container">
                <arole="button"
                    class="font-weight-boldfafa-chevron-righto_survey_session_navigationo_survey_session_navigation_nextp-3"/>
                <arole="button"
                    class="font-weight-boldfafa-chevron-lefto_survey_session_navigationo_survey_session_navigation_previousp-3d-none"/>
                <divclass="o_survey_session_resultsflex-columnflex-grow-1">
                    <divclass="row">
                        <divclass="col-lg-12"><h1t-esc="question.title"></h1></div>
                    </div>
                    <divt-attf-class="d-flexflex-columnflex-grow-1#{'justify-content-center'ifnotshow_text_answerselse''}#{'align-items-center'ifshow_bar_chartelse''}">
                        <!--Hastostayin'style'attributeforChartjs-->
                        <divt-if="show_bar_chart"class="p-2o_survey_session_chart"
                            style="position:relative;width:75vw;height:70vh;">
                            <!--canvaselementfordrawingbarchart-->
                            <canvas/>
                        </div>
                        <divt-elif="show_text_answers"class="p-2pt-4o_survey_session_text_answers_container">
                        </div>
                        <divt-elif="question.is_pageandnotis_html_empty(question.description)"class="mb-6o_survey_manage_fontsize_14"t-field="question.description"/>
                        <divt-else=""class="mb-6">
                            <h2class="font-weight-normalmb-3">
                                <span>Waitingforattendees...</span>
                                <span>
                                    <spanclass="o_survey_session_answer_count">0</span>
                                     /
                                    <spant-esc="survey.session_answer_count"/>
                                </span>
                            </h2>
                            <divclass="progress">
                                <divclass="progress-barfont-weight-bold"role="progressbar"aria-valuenow="0"aria-valuemin="0"aria-valuemax="100"></div>
                            </div>
                            <fieldsetdisabled="disabled"class="mt-5"t-if="question.question_type=='matrix'"t-call="survey.question_container">
                                <tt-set="hide_question_title"t-value="true"/>
                                <tt-set="answer"t-value="env['survey.user_input']"/>
                                <tt-set="survey_form_readonly"t-value="True"/>
                            </fieldset>
                        </div>
                    </div>
                </div>
                <divclass="o_survey_session_leaderboardw-100flex-columnflex-grow-1"style="display:none;">
                    <divclass="d-flex">
                        <h1class="o_survey_session_leaderboard_titleflex-grow-1">
                            <spant-if="is_last_question">FinalLeaderboard</span>
                            <spant-else="">Leaderboard</span>
                        </h1>
                        <divt-att-class="'o_survey_leaderboard_buttonsfont-weight-bold%s'%'d-none'ifnotis_last_questionelse''">
                            <ahref="#"role="button"class="o_survey_session_closebtnbtn-primarymr-4"><iclass="fafa-close"/>Close</a>
                            <ahref="#"role="button"class="o_survey_session_closebtnbtn-primary"t-att-data-show-results="True"><iclass="fafa-bar-chart"/>Results</a>
                        </div>
                    </div>
                    <divclass="justify-content-centerd-flexflex-columnflex-grow-1mt-5mb-5pb-5o_survey_session_leaderboard_container"/>
                </div>
            </div>
        </div>
    </template>

    <templateid="user_input_session_leaderboard"name="SurveyUserInputLeaderboard">
        <divt-if="leaderboard"class="position-relativemb-5"t-attf-style="height:calc(3.8rem*#{len(leaderboard)});">
            <tt-set="max_score"t-value="max(score.get('scoring_total',1)forscoreinleaderboard)or1"/>
            <tt-set="max_updated_score"t-value="max(score.get('updated_score',1)forscoreinleaderboard)"/>
            <tt-foreach="leaderboard"t-as="score">
                <divclass="o_survey_session_leaderboard_itemml-2d-flexposition-absolute"
                    t-attf-style="top:calc(#{score_index}*3.8rem);"
                    t-att-data-current-position="str(score_index)"
                    t-att-data-new-position="str(score.get('leaderboard_position',score_index))"
                    t-att-data-question-score="str(round(score.get('question_score',0)))"
                    t-att-data-current-score="str(round(score.get('scoring_total',0)))"
                    t-att-data-updated-score="str(round(score.get('updated_score',0)))"
                    t-att-data-max-question-score="round(score.get('max_question_score',1))"
                    t-att-data-max-updated-score="round(max_updated_score)">
                    <divclass="d-inline-blockfont-weight-boldalign-top">
                        <divclass="d-inline-blockmr-2o_survey_session_leaderboard_score"t-esc="'%.0fp'%score['scoring_total']"/>
                    </div>
                    <!--Wekeep"18rem"ofspacetodisplaythepoints/nickname.
                    Then,thelengthofthebarisapercentageoftheattendee'sscorecomparedtothemax_score.-->
                    <tt-set="width_ratio"t-value="round(round(score['scoring_total'])/round(max_score),3)"/>
                    <tt-set="width_ratio_question"t-value="str(round(round(score.get('question_score',0))/round(score.get('max_question_score',1)),3))"/>
                    <divclass="o_survey_session_leaderboard_barml-2align-topd-inline-blocktext-rightfont-weight-bold"
                        t-att-style="'width:calc(calc(%s-18rem)*%s)'%('100%',width_ratio)"
                        t-att-data-width-ratio="width_ratio">
                    </div>
                    <divclass="o_survey_session_leaderboard_bar_questionmr-2align-topd-inline-blocktext-rightfont-weight-boldposition-relative"
                        style="width:0px;"
                        t-att-data-width-ratio="width_ratio_question"
                        t-att-data-max-question-score="str(score.get('max_question_score',1))"
                        t-att-data-question-score="str(score.get('question_score',0))">
                        <divclass="o_survey_session_leaderboard_bar_question_scoreposition-absolute"></div>
                    </div>
                    <divclass="o_survey_session_leaderboard_named-inline-block">
                        <spant-if="score.get('nickname')"t-esc="score['nickname']"/>
                        <spant-else="">Anonymous</span>
                    </div>
                </div>
            </t>
        </div>
    </template>
</data>
</flectra>
