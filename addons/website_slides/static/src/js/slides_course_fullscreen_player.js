varonYouTubeIframeAPIReady=undefined;

flectra.define('website_slides.fullscreen',function(require){
    'usestrict';

    varpublicWidget=require('web.public.widget');
    varcore=require('web.core');
    varconfig=require('web.config');
    varQWeb=core.qweb;
    var_t=core._t;

    varsession=require('web.session');

    varQuiz=require('website_slides.quiz').Quiz;

    varDialog=require('web.Dialog');

    require('website_slides.course.join.widget');

    /**
     *Helper:Gettheslidedictmatchingthegivencriteria
     *
     *@private
     *@param{Array<Object>}slideListListofdictreprensentingaslide
     *@param{Object}matcher(seehttps://underscorejs.org/#matcher)
     */
    varfindSlide=function(slideList,matcher){
        varslideMatch=_.matcher(matcher);
        return_.find(slideList,slideMatch);
    };

    /**
     *ThiswidgetisresponsibleofdisplayYoutubePlayer
     *
     *Thewidgetwilltriggeranevent`change_slide`whenthevideoisat
     *itsend,and`slide_completed`whentheplayerisat30secbeforethe
     *endofthevideo(30secbeforeisconsideredascompleted).
     */
    varVideoPlayer=publicWidget.Widget.extend({
        template:'website.slides.fullscreen.video',
        youtubeUrl:'https://www.youtube.com/iframe_api',

        init:function(parent,slide){
            this.slide=slide;
            returnthis._super.apply(this,arguments);
        },
        start:function(){
            varself=this;
            returnPromise.all([this._super.apply(this,arguments),this._loadYoutubeAPI()]).then(function(){
                self._setupYoutubePlayer();
            });
        },
        _loadYoutubeAPI:function(){
            varself=this;
            varprom=newPromise(function(resolve,reject){
                if($(document).find('script[src="'+self.youtubeUrl+'"]').length===0){
                    var$youtubeElement=$('<script/>',{src:self.youtubeUrl});
                    $(document.head).append($youtubeElement);

                    //functioncalledwhentheYoutubeassetisloaded
                    //seehttps://developers.google.com/youtube/iframe_api_reference#Requirements
                    onYouTubeIframeAPIReady=function(){
                        resolve();
                    };
                }else{
                    resolve();
                }
            });
            returnprom;
        },
        /**
         *Linkstheyoutubeapitotheiframepresentinthetemplate
         *
         *@private
         */
        _setupYoutubePlayer:function(){
            this.player=newYT.Player('youtube-player'+this.slide.id,{
                playerVars:{
                    'autoplay':1,
                    'origin':window.location.origin
                },
                events:{
                    'onStateChange':this._onPlayerStateChange.bind(this)
                }
            });
        },
        /**
         *Specificmethodoftheyoutubeapi.
         *Whenevertheplayerstartsplaying/pausing/buffering/...,asetintervaliscreated.
         *Thissetintervalisusedtocheckteuser'sprogressinthevideo.
         *Oncetheuserreachesaparticulartimeinthevideo(30sbeforeend),theslidewillbeconsideredascompleted
         *ifthevideodoesn'thaveamini-quiz.
         *Thismethodalsoallowstoautomaticallygotothenextslide(orthequizassociatedtothecurrent
         *video)oncethevideoisover
         *
         *@private
         *@param{*}event
         */
        _onPlayerStateChange:function(event){
            varself=this;

            if(self.slide.completed){
                return;
            }

            if(event.data!==YT.PlayerState.ENDED){
                if(!event.target.getCurrentTime){
                    return;
                }

                if(self.tid){
                    clearInterval(self.tid);
                }

                self.currentVideoTime=event.target.getCurrentTime();
                self.totalVideoTime=event.target.getDuration();
                self.tid=setInterval(function(){
                    self.currentVideoTime+=1;
                    if(self.totalVideoTime&&self.currentVideoTime>self.totalVideoTime-30){
                        clearInterval(self.tid);
                        if(!self.slide.hasQuestion&&!self.slide.completed){
                            self.trigger_up('slide_to_complete',self.slide);
                        }
                    }
                },1000);
            }else{
                if(self.tid){
                    clearInterval(self.tid);
                }
                this.player=undefined;
                if(this.slide.hasNext){
                    this.trigger_up('slide_go_next');
                }
            }
        },
    });


    /**
     *Thiswidgetisresponsibleofnavigationforoneslidetoanother:
     * -byclickingonanyslidelistentry
     * -bymouseclick(next/prev)
     * -byrecievingtheordertogotoprev/nextslide(`goPrevious`and`goNext`publicmethods)
     *
     *Thewidgetwilltriggeranevent`change_slide`with
     *the`slideId`and`isMiniQuiz`asdata.
     */
    varSidebar=publicWidget.Widget.extend({
        events:{
            "click.o_wslides_fs_sidebar_list_item":'_onClickTab',
        },
        init:function(parent,slideList,defaultSlide){
            varresult=this._super.apply(this,arguments);
            this.slideEntries=slideList;
            this.set('slideEntry',defaultSlide);
            returnresult;
        },
        start:function(){
            varself=this;
            this.on('change:slideEntry',this,this._onChangeCurrentSlide);
            returnthis._super.apply(this,arguments).then(function(){
                $(document).keydown(self._onKeyDown.bind(self));
            });
        },
        destroy:function(){
            $(document).unbind('keydown',this._onKeyDown.bind(this));
            returnthis._super.apply(this,arguments);
        },
        //--------------------------------------------------------------------------
        //Public
        //--------------------------------------------------------------------------
        /**
         *Changethecurrentslidewiththenextone(ifthereisone).
         *
         *@public
         */
        goNext:function(){
            varcurrentIndex=this._getCurrentIndex();
            if(currentIndex<this.slideEntries.length-1){
                this.set('slideEntry',this.slideEntries[currentIndex+1]);
            }
        },
        /**
         *Changethecurrentslidewiththepreviousone(ifthereisone).
         *
         *@public
         */
        goPrevious:function(){
            varcurrentIndex=this._getCurrentIndex();
            if(currentIndex>=1){
                this.set('slideEntry',this.slideEntries[currentIndex-1]);
            }
        },
        /**
         *Greensupthebulletwhentheslideiscompleted
         *
         *@public
         *@param{Integer}slideId
         */
        setSlideCompleted:function(slideId){
            var$elem=this.$('.fa-circle-thin[data-slide-id="'+slideId+'"]');
            $elem.removeClass('fa-circle-thin').addClass('fa-checktext-successo_wslides_slide_completed');
        },
        /**
         *Updatestheprogressbarwheneveralessoniscompleted
         *
         *@public
         *@param{*}channelCompletion
         */
        updateProgressbar:function(channelCompletion){
            varcompletion=Math.min(100,channelCompletion);
            this.$('.progress-bar').css('width',completion+"%");
            this.$('.o_wslides_progress_percentage').text(completion);
        },

        //--------------------------------------------------------------------------
        //Private
        //--------------------------------------------------------------------------
        /**
         *Gettheindexofthecurrentslideentry(slideand/orquiz)
         */
        _getCurrentIndex:function(){
            varslide=this.get('slideEntry');
            varcurrentIndex=_.findIndex(this.slideEntries,function(entry){
                returnentry.id===slide.id&&entry.isQuiz===slide.isQuiz;
            });
            returncurrentIndex;
        },
        //--------------------------------------------------------------------------
        //Handler
        //--------------------------------------------------------------------------
        /**
         *Handlercalledwhenevertheuserclicksonasub-quizwhichislinkedtoaslide.
         *ThisdoesNOThandlethecaseofaslideoftype"quiz".
         *Bygoingthroughthishandler,thewidgetwillbeabletodeterminethatithastorender
         *theassociatedquizandnotthemaincontent.
         *
         *@private
         *@param{*}ev
         */
        _onClickMiniQuiz:function(ev){
            varslideID=parseInt($(ev.currentTarget).data().slide_id);
            this.set('slideEntry',{
                slideID:slideID,
                isMiniQuiz:true
            });
            this.trigger_up('change_slide',this.get('slideEntry'));
        },
        /**
         *Handlercalledwhentheuserclicksonanormalslidetab
         *
         *@private
         *@param{*}ev
         */
        _onClickTab:function(ev){
            ev.stopPropagation();
            var$elem=$(ev.currentTarget);
            if($elem.data('canAccess')==='True'){
                varisQuiz=$elem.data('isQuiz');
                varslideID=parseInt($elem.data('id'));
                varslide=findSlide(this.slideEntries,{id:slideID,isQuiz:isQuiz});
                this.set('slideEntry',slide);
            }
        },
        /**
         *Activelychangestheactivetabinthesidebarsothatitcorresponds
         *theslidecurrentlydisplayed
         *
         *@private
         */
        _onChangeCurrentSlide:function(){
            varslide=this.get('slideEntry');
            this.$('.o_wslides_fs_sidebar_list_item.active').removeClass('active');
            varselector='.o_wslides_fs_sidebar_list_item[data-id='+slide.id+'][data-is-quiz!="1"]';

            this.$(selector).addClass('active');
            this.trigger_up('change_slide',this.get('slideEntry'));
        },

        /**
         *Bindsleftandrightarrowtoallowtheusertonavigatebetweenslides
         *
         *@param{*}ev
         *@private
         */
        _onKeyDown:function(ev){
            switch(ev.key){
                case"ArrowLeft":
                    this.goPrevious();
                    break;
                case"ArrowRight":
                    this.goNext();
                    break;
            }
        },
    });

    varShareDialog=Dialog.extend({
        template:'website.slide.share.modal',
        events:{
            'click.o_wslides_js_share_emailbutton':'_onShareByEmailClick',
            'clicka.o_wslides_js_social_share':'_onSlidesSocialShare',
            'click.o_clipboard_button':'_onShareLinkCopy',
        },

        init:function(parent,options,slide){
            options=_.defaults(options||{},{
                title:"Share",
                buttons:[{text:"Cancel",close:true}],
                size:'medium',
            });
            this._super(parent,options);
            this.slide=slide;
            this.session=session;
        },

        _onShareByEmailClick:function(){
            varform=this.$('.o_wslides_js_share_email');
            varinput=form.find('input');
            varslideID=form.find('button').data('slide-id');
            if(input.val()&&input[0].checkValidity()){
                form.removeClass('o_has_error').find('.form-control,.custom-select').removeClass('is-invalid');
                this._rpc({
                    route:'/slides/slide/send_share_email',
                    params:{
                        slide_id:slideID,
                        email:input.val(),
                        fullscreen:true
                    },
                }).then(function(){
                    form.html('<divclass="alertalert-info"role="alert">'+_t('<strong>Thankyou!</strong>Mailhasbeensent.')+'</div>');
                });
            }else{
                form.addClass('o_has_error').find('.form-control,.custom-select').addClass('is-invalid');
                input.focus();
            }
        },

        _onSlidesSocialShare:function(ev){
            ev.preventDefault();
            varpopUpURL=$(ev.currentTarget).attr('href');
            window.open(popUpURL,'ShareDialog','width=626,height=436');
        },

        _onShareLinkCopy:function(ev){
            ev.preventDefault();
            var$clipboardBtn=this.$('.o_clipboard_button');
            $clipboardBtn.tooltip({title:"Copied!",trigger:"manual",placement:"bottom"});
            varself=this;
            varclipboard=newClipboardJS('.o_clipboard_button',{
                target:function(){
                    returnself.$('.o_wslides_js_share_link')[0];
                },
                container:this.el
            });
            clipboard.on('success',function(){
                clipboard.destroy();
                $clipboardBtn.tooltip('show');
                _.delay(function(){
                    $clipboardBtn.tooltip("hide");
                },800);
            });
            clipboard.on('error',function(e){
                clipboard.destroy();
            })
        },

    });

    varShareButton=publicWidget.Widget.extend({
        events:{
            "click.o_wslides_fs_share":'_onClickShareSlide'
        },

        init:function(el,slide){
            varresult=this._super.apply(this,arguments);
            this.slide=slide;
            returnresult;
        },

        _openDialog:function(){
            returnnewShareDialog(this,{},this.slide).open();
        },

        _onClickShareSlide:function(ev){
            ev.preventDefault();
            this._openDialog();
        },

        _onChangeSlide:function(currentSlide){
            this.slide=currentSlide;
        }

    });

    /**
     *Thiswidget'spurposeistoshowcontentofacourse,naviguatingthroughcontents
     *andcorrecltydisplayit.Italsohandleslidecompletion,courseprogress,...
     *
     *Thiswidgetisrenderedseverside,andattachedtotheexistingDOM.
     */
    varFullscreen=publicWidget.Widget.extend({
        events:{
            "click.o_wslides_fs_toggle_sidebar":'_onClickToggleSidebar',
        },
        custom_events:{
            'change_slide':'_onChangeSlideRequest',
            'slide_to_complete':'_onSlideToComplete',
            'slide_completed':'_onSlideCompleted',
            'slide_go_next':'_onSlideGoToNext',
        },
        /**
        *@override
        *@param{Object}el
        *@param{Object}slidesContainsthelistofallslidesofthecourse
        *@param{integer}defaultSlideIdContainstheIDofthesliderequestedbytheuser
        */
        init:function(parent,slides,defaultSlideId,channelData){
            varresult=this._super.apply(this,arguments);
            this.initialSlideID=defaultSlideId;
            this.slides=this._preprocessSlideData(slides);
            this.channel=channelData;
            varslide;
            varurlParams=$.deparam.querystring();
            if(defaultSlideId){
                slide=findSlide(this.slides,{id:defaultSlideId,isQuiz:urlParams.quiz==="1"});
            }else{
                slide=this.slides[0];
            }

            this.set('slide',slide);

            this.sidebar=newSidebar(this,this.slides,slide);
            this.shareButton=newShareButton(this,slide);
            returnresult;
        },
        /**
         *@override
         */
        start:function(){
            varself=this;
            this.on('change:slide',this,this._onChangeSlide);
            this._toggleSidebar();
            returnthis._super.apply(this,arguments).then(function(){
                returnself._onChangeSlide();//triggermanuallyonceDOMready,sinceslidecontentisnotrenderedserverside
            });
        },
        /**
         *ExtendedtoattachsubwidgettosubDOM.Thismightbeexperimentalbut
         *seemsworkingfine.
         *
         *@override
         */
        attachTo:function(){
            vardefs=[this._super.apply(this,arguments)];
            defs.push(this.sidebar.attachTo(this.$('.o_wslides_fs_sidebar')));
            defs.push(this.shareButton.attachTo(this.$('.o_wslides_slide_fs_header')));
            return$.when.apply($,defs);
        },
        //--------------------------------------------------------------------------
        //Private
        //--------------------------------------------------------------------------
        /**
         *Fetchescontentwithanrpccallforslidesoftype"webpage"
         *
         *@private
         */
        _fetchHtmlContent:function(){
            varself=this;
            varcurrentSlide=this.get('slide');
            returnself._rpc({
                route:"/slides/slide/get_html_content",
                params:{
                    'slide_id':currentSlide.id
                }
            }).then(function(data){
                if(data.html_content){
                    currentSlide.htmlContent=data.html_content;
                }
            });
        },
        /**
        *Fetchesslidecontentdependingonitstype.
        *Iftheslidedoesn'tneedtofetchanycontent,returnaresolveddeferred
        *
        *@private
        */
        _fetchSlideContent:function(){
            varslide=this.get('slide');
            if(slide.type==='webpage'&&!slide.isQuiz){
                returnthis._fetchHtmlContent();
            }
            returnPromise.resolve();
        },
        _markAsCompleted:function(slideId,completion){
            varslide=findSlide(this.slides,{id:slideId});
            slide.completed=true;
            this.sidebar.setSlideCompleted(slide.id);
            this.sidebar.updateProgressbar(completion);
        },
        /**
         *Extendtheslidedatalisttoaddinformationsaboutrenderingmethod,andother
         *specificvaluesaccordingtotheirslide_type.
         */
        _preprocessSlideData:function(slidesDataList){
            slidesDataList.forEach(function(slideData,index){
                //computehasNextslide
                slideData.hasNext=index<slidesDataList.length-1;
                //computeembedurl
                if(slideData.type==='video'){
                    slideData.embedCode=$(slideData.embedCode).attr('src')||"";//embedCodecontainsaniframetag,wheresrcattributeistheurl(youtubeorembeddocumentfromflectra)
                    varseparator=slideData.embedCode.indexOf("?")!==-1?"&":"?";
                    varscheme=slideData.embedCode.indexOf('//')===0?'https:':'';
                    varparams={rel:0,enablejsapi:1,origin:window.location.origin};
                    if(slideData.embedCode.indexOf("//drive.google.com")===-1){
                        params.autoplay=1;
                    }
                    slideData.embedUrl=slideData.embedCode?scheme+slideData.embedCode+separator+$.param(params):"";
                }elseif(slideData.type==='infographic'){
                    slideData.embedUrl=_.str.sprintf('/web/image/slide.slide/%s/image_1024',slideData.id);
                }elseif(_.contains(['document','presentation'],slideData.type)){
                    slideData.embedUrl=$(slideData.embedCode).attr('src');
                }
                //fillemptypropertytoallowsearchingonitwith_.filter(list,matcher)
                slideData.isQuiz=!!slideData.isQuiz;
                slideData.hasQuestion=!!slideData.hasQuestion;
                //technicalsettingsfortheFullscreentowork
                slideData._autoSetDone=_.contains(['infographic','presentation','document','webpage'],slideData.type)&&!slideData.hasQuestion;
            });
            returnslidesDataList;
        },
        /**
         *Changestheurlwhenevertheuserchangesslides.
         *Thisallowstheusertorefreshthepageandstayontherightslide
         *
         *@private
         */
        _pushUrlState:function(){
            varurlParts=window.location.pathname.split('/');
            urlParts[urlParts.length-1]=this.get('slide').slug;
            varurl= urlParts.join('/');
            this.$('.o_wslides_fs_exit_fullscreen').attr('href',url);
            varparams={'fullscreen':1};
            if(this.get('slide').isQuiz){
                params.quiz=1;
            }
            varfullscreenUrl=_.str.sprintf('%s?%s',url,$.param(params));
            history.pushState(null,'',fullscreenUrl);
        },
        /**
         *Renderthecurrentslidecontentusingspecificmecanismaccordingtoslidetype:
         *-simplyappendcontent(forwebpage)
         *-templaterendering(forimage,document,....)
         *-usingasubwidget(quizandvideo)
         *
         *@private
         *@returnsDeferred
         */
        _renderSlide:function(){
            varslide=this.get('slide');
            var$content=this.$('.o_wslides_fs_content');
            $content.empty();

            //displayquizslide,orquizattachedtoaslide
            if(slide.type==='quiz'||slide.isQuiz){
                $content.addClass('bg-white');
                varQuizWidget=newQuiz(this,slide,this.channel);
                returnQuizWidget.appendTo($content);
            }

            //renderslidecontent
            if(_.contains(['document','presentation','infographic'],slide.type)){
                $content.html(QWeb.render('website.slides.fullscreen.content',{widget:this}));
            }elseif(slide.type==='video'){
                this.videoPlayer=newVideoPlayer(this,slide);
                returnthis.videoPlayer.appendTo($content);
            }elseif(slide.type==='webpage'){
                var$wpContainer=$('<div>').addClass('o_wslide_fs_webpage_contentbg-whiteblockw-100overflow-auto');
                $(slide.htmlContent).appendTo($wpContainer);
                $content.append($wpContainer);
                this.trigger_up('widgets_start_request',{
                    $target:$content,
                });
            }
            returnPromise.resolve();
        },
        /**
         *Oncethecompletionconditionsarefilled,
         *rpccalltosetthetherelationbetweentheslideandtheuseras"completed"
         *
         *@private
         *@param{Integer}slideId:theidofslidetosetascompleted
         */
        _setCompleted:function(slideId){
            varself=this;
            varslide=findSlide(this.slides,{id:slideId});
            if(!slide.completed){ //nouselessRPCcall
                returnthis._rpc({
                    route:'/slides/slide/set_completed',
                    params:{
                        slide_id:slide.id,
                    }
                }).then(function(data){
                    self._markAsCompleted(slideId,data.channel_completion);
                    returnPromise.resolve();
                });
            }
            returnPromise.resolve();
        },
        //--------------------------------------------------------------------------
        //Handlers
        //--------------------------------------------------------------------------
        /**
         *Triggeredwhenevertheuserchangesslides.
         *Whenthecurrentslideischanged,widgetwillbeautomaticallyupdated
         *andallowedto:fetchthecontentifneeded,renderit,updatetheurl,
         *andsetslideas"completed"accordingtoitstyperequirements.In
         *mobilecase(i.e.limitedscreensize),sidebarwillbetoggledsince
         *sidebarwillblockmostorallofnewslidevisibility.
         *
         *@private
         */
        _onChangeSlide:function(){
            varself=this;
            varslide=this.get('slide');
            self._pushUrlState();
            returnthis._fetchSlideContent().then(function(){//rendercontent
                varwebsiteName=document.title.split("|")[1];//getthewebsitenamefromtitle
                document.title= (websiteName)?slide.name+'|'+websiteName:slide.name;
                if (config.device.size_class<config.device.SIZES.MD){
                    self._toggleSidebar();//hidesidebarwhensmalldevicescreen
                }
                returnself._renderSlide();
            }).then(function(){
                if(slide._autoSetDone&&!session.is_website_user){ //nouselessRPCcall
                    if(['document','presentation'].includes(slide.type)){
                        //onlysettheslideascompletedafteriFrameisloadedtoavoidconcurrentexecutionwith'embedUrl'controller
                        self.el.querySelector('iframe.o_wslides_iframe_viewer').addEventListener('load',()=>self._setCompleted(slide.id));
                    }else{
                           returnself._setCompleted(slide.id);
                    }
                }
            });
        },
        /**
         *Changescurrentslidewhenreceivingcustomevent`change_slide`with
         *itsidandifit'sitsquizzornotweneedtodisplay.
         *
         *@private
         */
        _onChangeSlideRequest:function(ev){
            varslideData=ev.data;
            varnewSlide=findSlide(this.slides,{
                id:slideData.id,
                isQuiz:slideData.isQuiz||false,
            });
            this.set('slide',newSlide);
            this.shareButton._onChangeSlide(newSlide);
        },
        /**
         *Triggeredwhensubwidgethasmarktheslideasdone,andtheUIneedtobeadapted.
         *
         *@private
         */
        _onSlideCompleted:function(ev){
            varslide=ev.data.slide;
            varcompletion=ev.data.completion;
            this._markAsCompleted(slide.id,completion);
        },
        /**
         *Triggeredwhensubwidgetbusinessisdoneandthatslide
         *cannowbemarkedasdone.
         *
         *@private
         */
        _onSlideToComplete:function(ev){
            if(!session.is_website_user){ //nouselessRPCcall
                varslideId=ev.data.id;
                this._setCompleted(slideId);
            }
        },
        /**
         *Gothenextslide
         *
         *@private
         */
        _onSlideGoToNext:function(ev){
            this.sidebar.goNext();
        },
        /**
         *Calledwhenthesidebartoggleisclicked->togglesthesidebarvisibility.
         *
         *@private
         */
        _onClickToggleSidebar:function(ev){
            ev.preventDefault();
            this._toggleSidebar();
        },
        /**
         *Togglessidebarvisibility.
         *
         *@private
         */
        _toggleSidebar:function(){
            this.$('.o_wslides_fs_sidebar').toggleClass('o_wslides_fs_sidebar_hidden');
            this.$('.o_wslides_fs_toggle_sidebar').toggleClass('active');
        },
    });

    publicWidget.registry.websiteSlidesFullscreenPlayer=publicWidget.Widget.extend({
        selector:'.o_wslides_fs_main',
        xmlDependencies:['/website_slides/static/src/xml/website_slides_fullscreen.xml','/website_slides/static/src/xml/website_slides_share.xml'],
        start:function(){
            varself=this;
            varproms=[this._super.apply(this,arguments)];
            varfullscreen=newFullscreen(this,this._getSlides(),this._getCurrentSlideID(),this._extractChannelData());
            proms.push(fullscreen.attachTo(".o_wslides_fs_main"));
            returnPromise.all(proms).then(function(){
                $('#edit-page-menua[data-action="edit"]').on('click',self._onWebEditorClick.bind(self));
            });
        },

        /**
         *Thewebeditordoesnotworkwellwiththee-learningfullscreenview.
         *Itactuallycompletelyclosesthefullscreenviewandopenstheeditiononablankpage.
         *
         *Toavoidthis,weintercepttheclickonthe'edit'buttonandredirecttothe
         *non-fullscreenviewofthisslidewiththeeditorenabled,whichismoresuitedtoedit
         *in-placeanyway.
         *
         *@param{MouseEvent}e
         */
        _onWebEditorClick:function(e){
            e.preventDefault();
            e.stopPropagation();

            window.location=`${window.location.pathname}?fullscreen=0&enable_editor=1`;
        },

        _extractChannelData:function(){
            returnthis.$el.data();
        },
        _getCurrentSlideID:function(){
            returnparseInt(this.$('.o_wslides_fs_sidebar_list_item.active').data('id'));
        },
        /**
         *@private
         *Createsslidesobjectsfromeveryslide-list-cellsattributes
         */
        _getSlides:function(){
            var$slides=this.$('.o_wslides_fs_sidebar_list_item[data-can-access="True"]');
            varslideList=[];
            $slides.each(function(){
                varslideData=$(this).data();
                slideList.push(slideData);
            });
            returnslideList;
        },
    });

    returnFullscreen;
});
