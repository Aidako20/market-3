<?xmlversion="1.0"encoding="utf-8"?>
<flectra>
        <!--DeliveryCarriers-->
        <menuitemid="menu_delivery"name="Delivery"parent="stock.menu_stock_config_settings"groups="stock.group_stock_manager"sequence="50"/>

        <recordid="action_delivery_packaging_view"model="ir.actions.act_window">
            <fieldname="name">DeliveryPackages</field>
            <fieldname="res_model">product.packaging</field>
            <fieldname="domain">[('product_id','=',False)]</field>
            <fieldname="view_ids"eval="[(5,0,0),
                (0,0,{'view_mode':'tree','view_id':ref('delivery.product_packaging_delivery_tree')}),
                (0,0,{'view_mode':'form','view_id':ref('delivery.product_packaging_delivery_form')})]"/>
        </record>

        <menuitemid="menu_delivery_packagings"name="DeliveryPackages"parent="menu_delivery"action="action_delivery_packaging_view"groups="stock.group_tracking_lot"/>

        <recordid="view_delivery_carrier_tree"model="ir.ui.view">
            <fieldname="name">delivery.carrier.tree</field>
            <fieldname="model">delivery.carrier</field>
            <fieldname="arch"type="xml">
                <treestring="Carrier">
                    <fieldname="sequence"widget="handle"/>
                    <fieldname="name"/>
                    <fieldname="delivery_type"/>
                    <fieldname="company_id"groups="base.group_multi_company"/>
                </tree>
            </field>
        </record>

        <recordid="view_delivery_carrier_search"model="ir.ui.view">
            <fieldname="name">delivery.carrier.search</field>
            <fieldname="model">delivery.carrier</field>
            <fieldname="arch"type="xml">
                <searchstring="DeliveryCarrier">
                    <fieldname="name"string="Carrier"/>
                    <fieldname="delivery_type"/>
                    <separator/>
                    <filterstring="Archived"name="inactive"domain="[('active','=',False)]"/>
                    <groupexpand="1"string="GroupBy">
                        <filterstring="Provider"name="provider"context="{'group_by':'delivery_type','residual_visible':True}"/>
                    </group>
                </search>
            </field>
        </record>

        <recordid="view_delivery_carrier_form"model="ir.ui.view">
            <fieldname="name">delivery.carrier.form</field>
            <fieldname="model">delivery.carrier</field>
            <fieldname="arch"type="xml">
                <formstring="Carrier">
                    <sheet>
                        <divclass="oe_button_box"name="button_box">
                            <buttonname="toggle_prod_environment"
                                    attrs="{'invisible':['|','|',('prod_environment','=',False),('delivery_type','=','fixed'),('delivery_type','=','base_on_rule')]}"
                                    class="oe_stat_button"
                                    type="object"icon="fa-play">
                                <divclass="o_stat_infoo_field_widget">
                                    <spanclass="text-success">Production</span>
                                    <spanclass="o_stat_text">Environment</span>
                                </div>
                            </button>
                            <!--transferreferencedhereduetoviewinheritanceissueincurrentmaster(post-saas-16)-->
                            <buttonname="toggle_prod_environment"
                                    attrs="{'invisible':['|','|',('prod_environment','=',True),('delivery_type','=','fixed'),('delivery_type','=','base_on_rule')]}"
                                    class="oe_stat_button"
                                    type="object"icon="fa-stop">
                                <divclass="o_stat_infoo_field_widget">
                                    <spanclass="o_warning_text">Test</span>
                                    <spanclass="o_stat_text">Environment</span>
                                </div>
                            </button>
                            <buttonname="toggle_debug"
                                    attrs="{'invisible':['|','|',('delivery_type','=','fixed'),('delivery_type','=','base_on_rule'),('debug_logging','=',True)]}"
                                    class="oe_stat_button"
                                    type="object"icon="fa-code">
                                <divclass="o_stat_infoo_field_widget">
                                    <spanclass="text-danger">Nodebug</span>
                                </div>
                            </button>
                            <buttonname="toggle_debug"
                                    attrs="{'invisible':['|','|',('delivery_type','=','fixed'),('delivery_type','=','base_on_rule'),('debug_logging','=',False)]}"
                                    class="oe_stat_button"
                                    type="object"icon="fa-code">
                                <divclass="o_stat_infoo_field_widget">
                                    <spanclass="text-success">Debugrequests</span>
                                </div>
                            </button>
                        </div>
                        <widgetname="web_ribbon"text="Archived"title="Archived"bg_color="bg-danger"attrs="{'invisible':[('active','=',True)]}"/>
                        <divclass="oe_title"name="title">
                            <labelfor="name"string="Name"class="oe_edit_only"/>
                            <h1>
                                <fieldname="name"placeholder="e.g.UPSExpress"/>
                            </h1>
                        </div>
                        <group>
                            <groupname="provider_details">
                                <fieldname="active"invisible="1"/>
                                <fieldname="prod_environment"invisible="1"/>
                                <fieldname="debug_logging"invisible="1"/>
                                <labelfor="delivery_type"/>
                                <div>
                                    <fieldname="delivery_type"/>
                                    <buttonstring="InstallmoreProviders"name="install_more_provider"type="object"class="oe_linkoe_edit_only"/>
                                </div>
                                <fieldname="integration_level"widget="radio"attrs="{'invisible':['|',('delivery_type','=','fixed'),('delivery_type','=','base_on_rule')]}"/>
                                <fieldname="company_id"groups="base.group_multi_company"/>
                            </group>
                            <groupname="delivery_details">
                                <fieldname="product_id"context="{'default_type':'service','default_sale_ok':False,'default_purchase_ok':False,'default_invoice_policy':'order'}"/>
                                <fieldname="invoice_policy"widget="radio"attrs="{'invisible':['|',('delivery_type','in',('fixed','base_on_rule')),('integration_level','=','rate')]}"/>
                                <labelfor="margin"string="MarginonRate"/>
                                <div>
                                    <fieldname="margin"class="oe_inline"/>%
                                </div>
                                <fieldname="free_over"/>
                                <fieldname="amount"attrs="{'required':[('free_over','!=',False)],'invisible':[('free_over','=',False)]}"/>
                            </group>
                        </group>
                        <notebook>
                            <pagename="pricing"string="Pricing"attrs="{'invisible':[('delivery_type','notin',['fixed','base_on_rule'])]}">
                                <groupattrs="{'invisible':[('delivery_type','!=','fixed')]}">
                                    <groupname="fixed_price">
                                        <fieldname="fixed_price"/>
                                    </group>
                                </group>
                                <groupname="general"attrs="{'invisible':[('delivery_type','!=','base_on_rule')]}">
                                    <fieldname="price_rule_ids"nolabel="1"/>
                                </group>
                            </page>
                            <pagestring="DestinationAvailability"name="destination">
                                <group>
                                    <p>
                                        Fillingthisformallowsyoutofilterdeliverycarriersaccordingtothedeliveryaddressofyourcustomer.
                                    </p>
                                </group>
                                <group>
                                    <groupname="country_details">
                                        <fieldname="country_ids"widget="many2many_tags"/>
                                        <fieldname="state_ids"widget="many2many_tags"/>
                                    </group>
                                    <group></group>
                                    <groupname="zip_from">
                                        <fieldname="zip_from"/>
                                    </group>
                                    <groupname="zip_to">
                                        <fieldname="zip_to"/>
                                    </group>
                                </group>
                            </page>
                        </notebook>
                    </sheet>
                </form>
            </field>
        </record>

        <recordid="action_delivery_carrier_form"model="ir.actions.act_window">
            <fieldname="name">ShippingMethods</field>
            <fieldname="type">ir.actions.act_window</field>
            <fieldname="res_model">delivery.carrier</field>
            <fieldname="view_mode">tree,form</field>
            <fieldname="context">{'search_default_group_by_provider':True}</field>
            <fieldname="help"type="html">
              <pclass="o_view_nocontent_smiling_face">
                Defineanewdeliverymethod
              </p><p>
                Eachcarrier(e.g.UPS)canhaveseveraldeliverymethods(e.g.
                UPSExpress,UPSStandard)withasetofpricingrulesattached
                toeachmethod.
              </p><p>
                Thesemethodsallowtoautomaticallycomputethedeliveryprice
                accordingtoyoursettings;onthesalesorder(basedonthe
                quotation)ortheinvoice(basedonthedeliveryorders).
              </p>
            </field>
        </record>

        <menuitemaction="action_delivery_carrier_form"id="menu_action_delivery_carrier_form"parent="menu_delivery"sequence="1"/>
        <menuitemaction="action_delivery_carrier_form"id="sale_menu_action_delivery_carrier_form"parent="sale.menu_sales_config"sequence="4"/>

        <recordid="view_delivery_price_rule_form"model="ir.ui.view">
            <fieldname="name">delivery.price.rule.form</field>
            <fieldname="model">delivery.price.rule</field>
            <fieldname="arch"type="xml">
                <formstring="PriceRules">
                    <group>
                        <fieldname="name"invisible="1"/>
                    </group>
                    <group>
                        <labelfor="variable"string="Condition"/>
                        <divclass="o_row">
                            <fieldname="variable"/>
                            <fieldname="operator"/>
                            <fieldname="max_value"/>
                        </div>
                        <labelfor="list_base_price"string="DeliveryCost"/>
                        <div>
                            <fieldname="list_base_price"class="oe_inline"/>
                            +
                            <fieldname="list_price"class="oe_inline"/>
                            *
                            <fieldname="variable_factor"class="oe_inline"/>
                        </div>
                    </group>
                </form>
            </field>
        </record>
        <recordid="view_delivery_price_rule_tree"model="ir.ui.view">
            <fieldname="name">delivery.price.rule.tree</field>
            <fieldname="model">delivery.price.rule</field>
            <fieldname="arch"type="xml">
                <treestring="PriceRules">
                    <fieldname="sequence"widget="handle"/>
                    <fieldname="name"/>
                </tree>
            </field>
        </record>

        <recordid="view_picking_withcarrier_out_form"model="ir.ui.view">
            <fieldname="name">delivery.stock.picking_withcarrier.form.view</field>
            <fieldname="model">stock.picking</field>
            <fieldname="inherit_id"ref="stock.view_picking_form"/>
            <fieldname="arch"type="xml">
              <data>
                <xpathexpr="//group[@name='other_infos']"position="before">
                    <groupname='carrier_data'string="ShippingInformation">
                        <fieldname="is_return_picking"invisible="1"/>
                        <fieldname="carrier_id"attrs="{'readonly':[('state','in',('done','cancel'))]}"options="{'no_create':True,'no_open':True}"/>
                        <fieldname="delivery_type"attrs="{'invisible':True}"/>
                        <labelfor="carrier_tracking_ref"/>
                        <divname="tracking">
                            <fieldname="carrier_tracking_ref"class="oe_inline"attrs="{'readonly':[('state','in',('done','cancel'))]}"/>
                            <buttontype='object'class="fafa-arrow-rightoe_link"name="cancel_shipment"string="Cancel"attrs="{'invisible':['|','|','|',('carrier_tracking_ref','=',False),('delivery_type','in',['fixed','base_on_rule']),('delivery_type','=',False),('state','notin',('done'))]}"/>
                        </div>
                        <labelfor="weight"string="Weight"/>
                        <div>
                            <fieldname="weight"class="oe_inline"/>
                            <fieldname="weight_uom_name"nolabel="1"class="oe_inline"style="margin-left:5px"/>
                        </div>
                        <labelfor="shipping_weight"string="Weightforshipping"/>
                        <div>
                            <fieldname="shipping_weight"class="oe_inline"/>
                            <fieldname="weight_uom_name"nolabel="1"class="oe_inline"style="margin-left:5px"/>
                        </div>
                    </group>
                </xpath>
                <divname="button_box"position="inside">
                    <buttontype="object"name="open_website_url"class="oe_stat_button"icon='fa-truck'string="Tracking"
                         attrs="{'invisible':['|','|',('carrier_tracking_ref','=',False),('carrier_id','=',False),('delivery_type','=','grid')]}"/>
                </div>
                <xpathexpr="/form/header/button[last()]"position="after">
                    <buttonname="send_to_shipper"string="SendtoShipper"type="object"attrs="{'invisible':['|','|','|','|',('carrier_tracking_ref','!=',False),('delivery_type','in',['fixed','base_on_rule']),('delivery_type','=',False),('state','notin',('done')),('picking_type_code','=','incoming')]}"/>
                </xpath>
                <xpathexpr="/form/header/button[last()]"position="after">
                    <buttonname="print_return_label"string="PrintReturnLabel"type="object"attrs="{'invisible':['|','|',('is_return_picking','=',False),('state','=','done'),('picking_type_code','!=','incoming')]}"/>
                </xpath>
              </data>
              <xpathexpr="//field[@name='partner_id']"position="attributes">
                  <attributename="attrs">{'required':['&amp;',('delivery_type','!=',False),('delivery_type','notin',['fixed','base_on_rule'])]}</attribute>
              </xpath>
            </field>
        </record>

        <recordid="view_picking_withweight_internal_move_form"model="ir.ui.view">
            <fieldname="name">stock.picking_withweight.internal.move.form.view</field>
            <fieldname="model">stock.move</field>
            <fieldname="inherit_id"ref="stock.view_move_form"/>
            <fieldname="arch"type="xml">
                <xpathexpr="//field[@name='location_dest_id']"position="after">
                    <fieldname="weight"/>
                </xpath>
            </field>
        </record>

        <recordid="view_quant_package_weight_form"model="ir.ui.view">
            <fieldname="name">stock.quant.package.weight.form</field>
            <fieldname="model">stock.quant.package</field>
            <fieldname="inherit_id"ref="stock.view_quant_package_form"/>
            <fieldname="arch"type="xml">
                <fieldname="company_id"position="before">
                    <fieldname="packaging_id"domain="[('product_id','=',False)]"/>
                    <labelfor="shipping_weight"/>
                    <divclass="o_row"name="ShippingWeight">
                        <fieldname="shipping_weight"/>
                        <span><fieldname="weight_uom_name"/></span>
                        <spanclass="text-muted">(computed:<fieldname="weight"nolabel="1"/></span><spanclass="text-muted"><fieldname="weight_uom_name"nolabel="1"/>)</span>
                    </div>
                </field>
            </field>
        </record>

        <recordid="view_quant_package_packaging_tree"model="ir.ui.view">
            <fieldname="name">stock.quant.package.packaging.tree</field>
            <fieldname="model">stock.quant.package</field>
            <fieldname="inherit_id"ref="stock.view_quant_package_tree"/>
            <fieldname="arch"type="xml">
                <fieldname="display_name"position="after">
                    <fieldname="packaging_id"/>
                </field>
            </field>
        </record>

        <recordid="view_order_form_with_carrier"model="ir.ui.view">
            <fieldname="name">delivery.sale.order.form.view.with_carrier</field>
            <fieldname="model">sale.order</field>
            <fieldname="inherit_id"ref="sale.view_order_form"/>
            <fieldname="arch"type="xml">
                <data>
                    <xpathexpr="//field[@name='partner_id']"position='after'>
                        <fieldname="delivery_set"invisible="1"/>
                        <fieldname="is_all_service"invisible="1"/>
                        <fieldname="recompute_delivery_price"invisible="1"/>
                    </xpath>
                    <xpathexpr="//group[@name='note_group']"position="before">
                        <divclass="oe_right">
                            <button
                                string="Addshipping"
                                name="action_open_delivery_wizard"
                                type="object"
                                attrs="{'invisible':['|','|',('is_all_service','=',True),('order_line','=',[]),('delivery_set','=',True)]}"
                            />
                            <button
                                string="Updateshippingcost"
                                name="action_open_delivery_wizard"
                                context="{'carrier_recompute':True}"
                                type="object"
                                class="text-warningbtn-secondary"
                                attrs="{'invisible':['|','|',('is_all_service','=',True),('recompute_delivery_price','=',False),('delivery_set','=',False)]}"
                            />
                            <button
                                string="Updateshippingcost"
                                name="action_open_delivery_wizard"
                                context="{'carrier_recompute':True}"
                                type="object"
                                attrs="{'invisible':['|','|',('is_all_service','=',True),('recompute_delivery_price','=',True),('delivery_set','=',False)]}"
                            />
                        </div>
                    </xpath>
                    <xpathexpr="//field[@name='order_line']/form/group/group/field[@name='price_unit']"position="before">
                        <fieldname="recompute_delivery_price"invisible="1"/>
                        <fieldname="is_delivery"invisible="1"/>
                    </xpath>
                    <xpathexpr="//field[@name='order_line']/tree/field[@name='price_unit']"position="before">
                        <fieldname="recompute_delivery_price"invisible="1"/>
                        <fieldname="is_delivery"invisible="1"/>
                    </xpath>
                    <xpathexpr="//field[@name='order_line']/tree"position="attributes">
                        <attributename="decoration-warning">recompute_delivery_priceandis_delivery</attribute>
                    </xpath>
                </data>
            </field>
        </record>

        <recordid="delivery_tracking_url_warning_form"model="ir.ui.view">
            <fieldname="name">delivery.carrier.warning.url.form</field>
            <fieldname="model">stock.picking</field>
            <fieldname="arch"type="xml">
                <formstring="TrackersURL">
                    <group>
                        <divclass="alertalert-info"role="status">
                            <p>Youhavemultipletrackerlinks,theyareavailableinthechatter.</p>
                        </div>
                    </group>
                    <footer>
                        <buttonstring="OK"special="cancel"class="oe_highlight"/>
                    </footer>
                </form>
            </field>
        </record>

        <recordid="act_delivery_trackers_url"model="ir.actions.act_window">
            <fieldname="name">Displaytrackinglinks</field>
            <fieldname="type">ir.actions.act_window</field>
            <fieldname="res_model">stock.picking</field>
            <fieldname="view_id"ref="delivery.delivery_tracking_url_warning_form"/>
            <fieldname="view_mode">form</field>
            <fieldname="target">new</field>
        </record>

        <recordid="vpicktree_view_tree"model="ir.ui.view">
            <fieldname="name">stock.picking.delivery.tree.inherit.delivery</field>
            <fieldname="model">stock.picking</field>
            <fieldname="inherit_id"ref="stock.vpicktree"/>
            <fieldname="arch"type="xml">
                <xpathexpr="//field[@name='backorder_id']"position="after">
                    <fieldname="carrier_tracking_ref"optional="hide"/>
                    <fieldname="carrier_id"optional="hide"/>
                    <fieldname="weight"optional="hide"/>
                    <fieldname="shipping_weight"optional="hide"/>
                </xpath>
            </field>
        </record>
</flectra>
