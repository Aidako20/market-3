<flectra>
    <!--MailtemplateisdoneinaNOUPDATEblock
         souserscanfreelycustomize/deletethem-->
    <datanoupdate="1">
        <!--Emailtemplate-->
        
        <recordid="email_template_goal_reminder"model="mail.template">
            <fieldname="name">Goal:ReminderforGoalUpdate</field>
            <fieldname="model_id"ref="gamification.model_gamification_goal"/>
            <fieldname="partner_to">${object.user_id.partner_id.id}</field>
            <fieldname="body_html"type="html">
<div>
    <strong>Reminder${object.name}</strong><br/>
    Youhavenotupdatedyourprogressforthegoal${object.definition_id.name}(currentlyreachedat${object.completeness}%)foratleast${object.remind_update_delay}days.Donotforgettodoit.
    <br/><br/>
    Thankyou,
    %ifobject.challenge_id.manager_id.signature:
        <br/>
        ${object.challenge_id.manager_id.signature|safe}
    %endif
</div></field>
            <fieldname="lang">${object.user_id.lang}</field>
            <fieldname="auto_delete"eval="True"/>
        </record>
        
        <recordid="simple_report_template"model="mail.template">
            <fieldname="name">Challenge:SimpleChallengeReportProgress</field>
            <fieldname="model_id"ref="gamification.model_gamification_challenge"/>
            <fieldname="body_html"type="html">
<tablecellspacing="0"cellpadding="0"width="100%"style="background-color:#EEE;border-collapse:collapse;">
<tr>
    <tdvalign="top"align="center">
        %setrecord=ctx.get('record')
        %setcompany=recordandrecord.company_idoruser.company_id
        %setchallenge_lines=ctx.get('challenge_lines',[])    
        <tablecellspacing="0"cellpadding="0"width="600"style="margin:0auto;width:570px;">
            <tr><td>
                <tablecellspacing="0"cellpadding="0"width="100%">
                    <tr>
                        <div>
                            %ifobject.visibility_mode=='ranking':
                                <tdstyle="padding:15px;">
                                    <pstyle="font-size:20px;color:#666666;"align="center">Leaderboard</p>
                                </td>
                            %endif
                        </div>
                    </tr>
                </table>
                <tablecellspacing="0"cellpadding="0"width="100%"bgcolor="#fff"style="background-color:#fff;">
                    <tr><tdstyle="padding:15px;">
                        %ifobject.visibility_mode=='personal':
                            <spanstyle="color:#666666;font-size:13px;">Hereisyourcurrentprogressinthechallenge<strong>${object.name}</strong>.</span>
                            <tablecellspacing="0"cellpadding="0"width="100%"style="margin-top:20px;">
                                <tr>
                                    <tdalign="center">
                                        <div>PersonalPerformance</div>
                                    </td>
                                </tr>
                            </table>
                            <tablecellspacing="0"cellpadding="0"width="100%"style="margin-top:30px;color:#666666;">
                                <thead>
                                    <trstyle="color:#9A6C8E;font-size:12px;">
                                        <thalign="left"style="padding-bottom:0px;width:40%;text-align:left;">Goals</th>
                                        <thstyle="width:20%;text-align:right;"align="left">Target</th>
                                        <thstyle="width:20%;text-align:right;"align="right">Current</th>
                                        <thstyle="width:20%;text-align:right;"align="right">Completeness</th>
                                    </tr>
                                    <tr>
                                        <tdcolspan="5"style="height:1px;background-color:#9A6C8E;"></td>
                                    </tr>
                                </thead>
                                <tbody>
                                %forlineinchallenge_lines:
                                    <trstyle="font-weight:bold;">
                                        <tdstyle="padding:20px0;"align="left">
                                            ${line['name']}
                                            %ifline['suffix']orline['monetary']:
                                                (${line['full_suffix']})
                                            %endif
                                        </td>
                                        <tdstyle="padding:20px0;"align="right">${"%.2f"%line['target']}
                                            %ifline['suffix']:
                                                ${line['suffix']}
                                            %endif
                                        </td>
                                        <tdstyle="padding:20px0;"align="right">${"%.2f"%line['current']}
                                            %ifline['suffix']:
                                                ${line['suffix']}
                                            %endif
                                        </td>
                                        <tdstyle="padding:20px0;font-size:25px;color:#9A6C8E;"align="right"><strong>${line['completeness']|int}%</strong></td>
                                    </tr>
                                    <tr>
                                        <tdcolspan="5"style="height:1px;background-color:#e3e3e3;"></td>
                                    </tr>
                                %endfor       
                                </tbody>
                            </table>                  
                        %else:
                            <spanstyle="color:#A8A8A8;font-size:13px;">
                                Challenge:<strong>${object.name}</strong>.
                            </span>
                            %forlineinchallenge_lines:
                                <!--Header+Buttontable-->
                                <tablecellspacing="0"cellpadding="0"width="100%"style="margin-top:35px;">
                                    <tr>
                                        <tdwidth="50%">
                                            <div>TopAchieversforgoal<strong>${line['name']}</strong></div>
                                        </td>
                                    </tr>
                                </table>
                                <!--Podium-->
                                %iflen(line['goals'])==2:
                                    <tablecellspacing="0"cellpadding="0"width="100%"style="margin-top:10px;">
                                        <tr><tdstyle="padding:030px;">
                                            <tablecellspacing="0"cellpadding="0"width="100%"style="table-layout:fixed;">
                                                <tr>
                                                    %settop_goals=line['goals'][:3]
                                                    %forgoalintop_goals:
                                                        <tdalign="center"style="width:32%;">
                                                            %ifloop.index==1:
                                                                %setextra_div='<divstyle="height:40px;"></div>'
                                                                %setheightA=95
                                                                %setheightB=75
                                                                %setbgColor='#b898b0'
                                                                %setfontSize=50
                                                                %setpodiumPosition='2'
                                                            %elifloop.index==2:
                                                                %setextra_div=''
                                                                %setheightA=55
                                                                %setheightB=115
                                                                %setbgColor='#9A6C8E'
                                                                %setfontSize=85
                                                                %setpodiumPosition='1'
                                                            %elifloop.index==3:
                                                                %setextra_div='<divstyle="height:60px;"></div>'
                                                                %setheightA=115
                                                                %setheightB=55
                                                                %setbgColor='#c8afc1'
                                                                %setfontSize=35
                                                                %setpodiumPosition='3'
                                                            %endif
                                                            <divstyle="margin:03px03px;height:220px;">
                                                                <divstyle="height:${heightA}px;">
                                                                    ${extra_div|safe}  
                                                                    <divstyle="height:55px;">
                                                                        <imgstyle="margin-bottom:5px;width:50px;height:50px;border-radius:50%;object-fit:cover;"t-att-src="image_data_uri(object.env['res.users'].browse(goal['user_id']).partner_id.image_128)"alt="${goal['name']}"/>
                                                                    </div>
                                                                    <divalign="center"style="color:${bgColor};height:20px">
                                                                        ${goal['name']}
                                                                    </div>
                                                                </div>
                                                                <divstyle="background-color:${bgColor|safe};height:${heightB}px;">
                                                                    <strong><spanstyle="color:#fff;font-size:${fontSize}px;">${podiumPosition|safe}</span></strong>
                                                                </div>
                                                                <divstyle="height:30px;">
                                                                    ${"%.2f"%goal['current']}
                                                                    %ifline['suffix']orline['monetary']:
                                                                        ${line['full_suffix']}
                                                                    %endif
                                                                </div>
                                                            </div>
                                                        </td>
                                                    %endfor
                                                </tr>
                                            </table>
                                            </td>
                                        </tr>
                                    </table>
                                %endif
                                <!--datatable-->
                                <tablecellspacing="0"cellpadding="0"width="100%"style="margin-bottom:5px">
                                    <tr>
                                        <td>
                                            <tablecellspacing="0"cellpadding="0"width="100%"style="margin-top:30px;margin-bottom:5px;color:#666666;">
                                                <thead>
                                                    <trstyle="color:#9A6C8E;font-size:12px;">
                                                        <thstyle="width:15%;text-align:center;">Rank</th>
                                                        <thstyle="width:25%;text-align:left;">Name</th>
                                                        <thstyle="width:30%;text-align:right;">Performance
                                                            %ifline['suffix']:
                                                                (${line['suffix']})
                                                            %elifline['monetary']:
                                                                (${company.currency_id.symbol})
                                                            %endif
                                                        </th>
                                                        <thstyle="width:30%;text-align:right;">Completeness</th>
                                                    </tr>
                                                    <tr>
                                                        <tdcolspan="5"style="height:1px;background-color:#9A6C8E;"></td>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    %forgoalinline['goals']:
                                                        <tr>
                                                            %settdBgColor='#fff'
                                                            %settdColor='gray'
                                                            %setmutedColor='#AAAAAA'
                                                            %settdPercentageColor='#9A6C8E'
                                                            <tdwidth="15%"align="center"valign="middle"style="background-color:${tdBgColor};padding:5px0;font-size:20px;">${goal['rank']+1}
                                                            </td>
                                                            <tdwidth="25%"align="left"valign="middle"style="background-color:${tdBgColor};padding:5px0;font-size:13px;">${goal['name']}</td>
                                                            <tdwidth="30%"align="right"style="background-color:${tdBgColor};padding:5px0;line-height:1;">${"%.2f"%goal['current']}<br/><spanstyle="font-size:13px;color:${mutedColor};">on${"%.2f"%line['target']}</span>
                                                            </td>
                                                            <tdwidth="30%"style="color:${tdPercentageColor};background-color:${tdBgColor};padding-right:15px;font-size:22px;"align="right"><strong>${goal['completeness']|int}%</strong></td>
                                                        </tr>
                                                        <tr>
                                                            <tdcolspan="5"style="height:1px;background-color:#DADADA;"></td>
                                                        </tr>
                                                    %endfor
                                                </tbody>
                                            </table>
                                        </td>
                                    </tr>
                                </table>
                            %endfor
                        %endif
                    </td></tr>
                </table>
            </td></tr>
        </table>
    </td>
</tr>
</table>
            </field>
        </record>

        <!--goaldefinitions-->
        <recordmodel="gamification.goal.definition"id="definition_base_timezone">
            <fieldname="name">SetyourTimezone</field>
            <fieldname="description">Configureyourprofileandspecifyyourtimezone</field>
            <fieldname="computation_mode">count</field>
            <fieldname="display_mode">boolean</field>
            <fieldname="model_id"ref="base.model_res_users"/>
            <fieldname="domain">[('partner_id.tz','!=',False)]</field>
            <fieldname="action_id"ref="base.action_res_users_my"/>
            <fieldname="res_id_field">user.id</field>
            <fieldname="batch_mode">True</field>
            <fieldname="batch_distinctive_field"ref="base.field_res_users__id"/>
            <fieldname="batch_user_expression">user.id</field>
        </record>

        <recordmodel="gamification.goal.definition"id="definition_base_company_data">
            <fieldname="name">SetyourCompanyData</field>
            <fieldname="description">Writesomeinformationaboutyourcompany(specifyatleastaname)</field>
            <fieldname="computation_mode">count</field>
            <fieldname="display_mode">boolean</field>
            <fieldname="model_id"ref="base.model_res_company"/>
            <fieldname="domain">[('user_ids','in',[user.id]),('name','=','YourCompany')]</field>
            <fieldname="condition">lower</field>
            <fieldname="action_id"ref="base.action_res_company_form"/>
            <fieldname="res_id_field">user.company_id.id</field>
        </record>

        <recordmodel="gamification.goal.definition"id="definition_base_company_logo">
            <fieldname="name">SetyourCompanyLogo</field>
            <fieldname="computation_mode">count</field>
            <fieldname="display_mode">boolean</field>
            <fieldname="model_id"ref="base.model_res_company"/>
            <fieldname="domain">[('user_ids','in',[user.id]),('logo','!=',False)]</field>
            <fieldname="action_id"ref="base.action_res_company_form"/>
            <fieldname="res_id_field">user.company_id.id</field>
        </record>

        <recordid="action_new_simplified_res_users"model="ir.actions.act_window">
            <fieldname="name">CreateUser</field>
            <fieldname="type">ir.actions.act_window</field>
            <fieldname="res_model">res.users</field>
            <fieldname="target">current</field>
            <fieldname="view_id"ref="base.view_users_simple_form"/>
            <fieldname="context">{}</field>
            <fieldname="help">Createandmanageusersthatwillconnecttothesystem.Userscanbedeactivatedshouldtherebeaperiodoftimeduringwhichtheywill/shouldnotconnecttothesystem.Youcanassignthemgroupsinordertogivethemspecificaccesstotheapplicationstheyneedtouseinthesystem.</field>
        </record>

        <recordmodel="gamification.goal.definition"id="definition_base_invite">
            <fieldname="name">InvitenewUsers</field>
            <fieldname="description">Createatleastanotheruser</field>
            <fieldname="display_mode">boolean</field>
            <fieldname="computation_mode">count</field>
            <fieldname="model_id"ref="base.model_res_users"/>
            <fieldname="domain">[('id','!=',user.id)]</field>
            <fieldname="action_id"ref="action_new_simplified_res_users"/>
        </record>

        <!--challenges-->
        <recordmodel="gamification.challenge"id="challenge_base_discover">
            <fieldname="name">CompleteyourProfile</field>
            <fieldname="period">once</field>
            <fieldname="visibility_mode">personal</field>
            <fieldname="report_message_frequency">never</field>
            <fieldname="user_domain"eval="str([('groups_id.id','=',ref('base.group_user'))])"/>
            <fieldname="state">inprogress</field>
            <fieldname="challenge_category">other</field>
        </record>

        <recordmodel="gamification.challenge"id="challenge_base_configure">
            <fieldname="name">SetupyourCompany</field>
            <fieldname="period">once</field>
            <fieldname="visibility_mode">personal</field>
            <fieldname="report_message_frequency">never</field>
            <fieldname="user_domain"eval="str([('groups_id.id','=',ref('base.group_erp_manager'))])"/>
            <fieldname="state">inprogress</field>
            <fieldname="challenge_category">other</field>
        </record>

        <!--lines-->
        <recordmodel="gamification.challenge.line"id="line_base_discover1">
            <fieldname="definition_id"ref="definition_base_timezone"/>
            <fieldname="target_goal">1</field>
            <fieldname="challenge_id"ref="challenge_base_discover"/>
        </record>

        <recordmodel="gamification.challenge.line"id="line_base_admin2">
            <fieldname="definition_id"ref="definition_base_company_logo"/>
            <fieldname="target_goal">1</field>
            <fieldname="challenge_id"ref="challenge_base_configure"/>
        </record>
        <recordmodel="gamification.challenge.line"id="line_base_admin1">
            <fieldname="definition_id"ref="definition_base_company_data"/>
            <fieldname="target_goal">0</field>
            <fieldname="challenge_id"ref="challenge_base_configure"/>
        </record>
        <recordmodel="gamification.challenge.line"id="line_base_admin3">
            <fieldname="definition_id"ref="definition_base_invite"/>
            <fieldname="target_goal">1</field>
            <fieldname="challenge_id"ref="challenge_base_configure"/>
        </record>
    </data>

</flectra>
