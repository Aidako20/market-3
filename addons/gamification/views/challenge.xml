<flectra>
    <recordid="challenge_list_view"model="ir.ui.view">
        <fieldname="name">ChallengesList</field>
        <fieldname="model">gamification.challenge</field>
        <fieldname="arch"type="xml">
            <treestring="Goaldefinitions"decoration-info="state=='draft'"decoration-muted="state=='done'">
                <fieldname="name"/>
                <fieldname="period"/>
                <fieldname="manager_id"/>
                <fieldname="state"/>
            </tree>
        </field>
    </record>

    <recordid="goals_from_challenge_act"model="ir.actions.act_window">
        <fieldname="res_model">gamification.goal</field>
        <fieldname="name">RelatedGoals</field>
        <fieldname="view_mode">kanban,tree,form</field>
        <fieldname="context">{'search_default_group_by_definition':True,'search_default_inprogress':True,'search_default_challenge_id':active_id,'default_challenge_id':active_id}</field>
        <fieldname="help"type="html">
          <pclass="o_view_nocontent_empty_folder">
                Nogoalfound
          </p><p>
            Thereisnogoalassociatedtothischallengematchingyoursearch.
            Makesurethatyourchallengeisactiveandassignedtoatleastoneuser.
          </p>
        </field>
    </record>

    <recordid="challenge_form_view"model="ir.ui.view">
        <fieldname="name">ChallengeForm</field>
        <fieldname="model">gamification.challenge</field>
        <fieldname="arch"type="xml">
            <formstring="Goaldefinitions">
                <header>
                    <buttonstring="StartChallenge"type="object"name="action_start"states="draft"class="oe_highlight"/>
                    <buttonstring="RefreshChallenge"type="object"name="action_check"states="inprogress"/>
                    <buttonstring="SendReport"type="object"name="action_report_progress"states="inprogress,done"groups="base.group_no_one"/>
                    <fieldname="state"widget="statusbar"options="{'clickable':'1'}"/>
                </header>
                <sheet>
                    <!--actionbuttons-->
                    <divclass="oe_button_box"name="button_box">
                        <buttontype="action"
                            name="%(goals_from_challenge_act)d"
                            class="oe_stat_button"
                            icon="fa-gift"
                            attrs="{'invisible':[('state','=','draft')]}">
                            <divclass="o_field_widgeto_stat_info">
                                <spanclass="o_stat_text">Related</span>
                                <spanclass="o_stat_text">Goals</span>
                            </div>
                        </button>
                    </div>

                    <divclass="oe_title">
                        <labelfor="name"class="oe_edit_only"/>
                        <h1>
                            <fieldname="name"placeholder="e.g.MonthlySalesObjectives"/>
                        </h1>
                        <labelfor="user_domain"class="oe_edit_only"string="AssignChallengeTo"/>
                        <div>
                            <fieldname="user_domain"widget="domain"options="{'model':'res.users'}"/>
                            <fieldname="user_ids"widget="many2many_tags"/>
                        </div>
                    </div>

                    <group>
                        <group>
                            <fieldname="period"attrs="{'readonly':[('state','!=','draft')]}"/>
                            <fieldname="visibility_mode"widget="radio"colspan="1"/>
                        </group>
                        <group>
                            <fieldname="manager_id"/>
                            <fieldname="start_date"attrs="{'readonly':[('state','!=','draft')]}"/>
                            <fieldname="end_date"attrs="{'readonly':[('state','!=','draft')]}"/>
                        </group>
                    </group>
                    <notebook>
                        <pagestring="Goals"name="goals">
                            <fieldname="line_ids"nolabel="1"colspan="4">
                                <treestring="LineList"editable="bottom">
                                    <fieldname="sequence"widget="handle"/>
                                    <fieldname="definition_id"/>
                                    <fieldname="condition"/>
                                    <fieldname="target_goal"string="Target"/>
                                    <fieldname="definition_full_suffix"/>
                                </tree>
                            </field>
                            <fieldname="description"placeholder="Describethechallenge:whatisdoes,whoittargets,whyitmatters..."/>
                        </page>
                        <pagestring="Reward"name="reward">
                            <group>
                                <fieldname="reward_id"attrs="{'required':[('reward_realtime','=',True)]}"/>
                                <fieldname="reward_first_id"/>
                                <fieldname="reward_second_id"attrs="{'invisible':[('reward_first_id','=',False)]}"/>
                                <fieldname="reward_third_id"attrs="{'invisible':['|',('reward_first_id','=',False),('reward_second_id','=',False)]}"/>
                                <fieldname="reward_failure"attrs="{'invisible':[('reward_first_id','=',False)]}"/>
                                <fieldname="reward_realtime"/>
                            </group>
                            <divclass="oe_grey">
                                <p>Badgesaregrantedwhenachallengeisfinished.Thisiseitherattheendofarunningperiod(eg:endofthemonthforamonthlychallenge),attheenddateofachallenge(ifnoperiodicityisset)orwhenthechallengeismanuallyclosed.</p>
                            </div>
                        </page>
                        <pagestring="AdvancedOptions"name="advanced_options">
                            <groupstring="Subscriptions">
                                <fieldname="invited_user_ids"widget="many2many_tags"/>
                            </group>
                            <groupstring="NotificationMessages">
                                <divclass="oe_grey"colspan="4">
                                    <p>DependingontheDisplaymode,reportswillbeindividualorshared.</p>
                                </div>
                                <groupcolspan="4">
                                    <fieldname="report_message_frequency"/>
                                    <fieldname="report_template_id"attrs="{'invisible':[('report_message_frequency','=','never')]}"/>
                                    <fieldname="report_message_group_id"attrs="{'invisible':[('report_message_frequency','=','never')]}"/>
                                </group>
                            </group>
                            <groupstring="RemindersforManualGoals">
                                <labelfor="remind_update_delay"/>
                                <div>
                                    <fieldname="remind_update_delay"class="oe_inline"/>days
                                </div>
                            </group>
                            <groupstring="Category"groups="base.group_no_one">
                                <fieldname="challenge_category"widget="radio"/>
                            </group>
                        </page>
                    </notebook>

                </sheet>
                <divclass="oe_chatter">
                    <fieldname="message_follower_ids"/>
                    <fieldname="message_ids"/>
                </div>
            </form>
        </field>
    </record>

    <recordmodel="ir.ui.view"id="view_challenge_kanban">
        <fieldname="name">ChallengeKanban</field>
        <fieldname="model">gamification.challenge</field>
        <fieldname="arch"type="xml">
            <kanbanstring="Challenges"class="oe_background_grey">
                <fieldname="line_ids"/>
                <fieldname="user_ids"/>
                <templates>
                    <tt-name="kanban-box">
                        <divt-attf-class="oe_kanban_cardo_kanban_gamificationoe_kanban_global_click">
                            <divclass="o_kanban_content">
                               <strong>
                                   <h4class="o_kanban_record_title"><fieldname="name"/></h4>
                                   <divclass="oe_kanban_project_listo_kanban_record_subtitle">
                                       <atype="action"name="%(goals_from_challenge_act)d"style="margin-right:10px"tabindex="-1">
                                           <spant-if="record.line_ids.raw_value.lengthgt1"><tt-esc="record.line_ids.raw_value.length"/>Goals</span>
                                           <spant-if="record.line_ids.raw_value.lengthlt2"><tt-esc="record.line_ids.raw_value.length"/>Goal</span>
                                       </a>
                                   </div>
                               </strong>
                                <tt-foreach="record.user_ids.raw_value.slice(0,11)"t-as="member">
                                    <imgclass="o_kanban_badge_avatars"t-att-src="kanban_image('res.users','image_128',member)"t-att-data-member_id="member"alt="Member"/>
                                </t>
                            </div>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>

    <recordid="challenge_list_action"model="ir.actions.act_window">
        <fieldname="name">Challenges</field>
        <fieldname="res_model">gamification.challenge</field>
        <fieldname="view_mode">kanban,tree</field>
        <fieldname="context">{'search_default_inprogress':True,'default_inprogress':True}</field>
        <fieldname="help"type="html">
            <pclass="o_view_nocontent_smiling_face">
                Createanewchallenge
            </p><p>
                Assignalistofgoalstochosenuserstoevaluatethem.
                Thechallengecanuseaperiod(weekly,monthly...)forautomaticcreationofgoals.
                Thegoalsarecreatedforthespecifiedusersormemberofthegroup.
            </p>
        </field>
    </record>
    <!--SpecifyformviewIDtoavoidselectingview_challenge_wizard-->
    <recordid="challenge_list_action_view1"model="ir.actions.act_window.view">
        <fieldeval="1"name="sequence"/>
        <fieldname="view_mode">kanban</field>
        <fieldname="act_window_id"ref="challenge_list_action"/>
        <fieldname="view_id"ref="view_challenge_kanban"/>
    </record>
    <recordid="challenge_list_action_view2"model="ir.actions.act_window.view">
        <fieldeval="10"name="sequence"/>
        <fieldname="view_mode">form</field>
        <fieldname="act_window_id"ref="challenge_list_action"/>
        <fieldname="view_id"ref="challenge_form_view"/>
    </record>

    <!--Line-->
    <recordid="challenge_line_list_view"model="ir.ui.view">
        <fieldname="name">Challengelinelist</field>
        <fieldname="model">gamification.challenge.line</field>
        <fieldname="arch"type="xml">
            <treestring="ChallengeLines">
                <fieldname="definition_id"/>
                <fieldname="target_goal"string="Target"/>
            </tree>
        </field>
    </record>


    <recordid="challenge_search_view"model="ir.ui.view">
        <fieldname="name">ChallengeSearch</field>
        <fieldname="model">gamification.challenge</field>
        <fieldname="arch"type="xml">
            <searchstring="SearchChallenges">
                <filtername="inprogress"string="RunningChallenges"
                    domain="[('state','=','inprogress')]"/>
                <filtername="hr_challenges"string="HRChallenges"
                    domain="[('challenge_category','=','hr')]"/>
                <fieldname="name"/>
                <groupexpand="0"string="GroupBy">
                    <filterstring="State"name="state"domain="[]"context="{'group_by':'state'}"/>
                    <filterstring="Period"name="period"domain="[]"context="{'group_by':'period'}"/>
                </group>
            </search>
        </field>
    </record>
</flectra>
