<?xmlversion="1.0"encoding="utf-8"?>
<flectra>

    <recordid="timesheet_view_search"model="ir.ui.view">
            <fieldname="name">account.analytic.line.search</field>
            <fieldname="model">account.analytic.line</field>
            <fieldname="inherit_id"ref="hr_timesheet.hr_timesheet_line_search"/>
            <fieldname="arch"type="xml">
                <xpathexpr="//field[@name='department_id']"position="after">
                    <fieldname="timesheet_invoice_type"/>
                </xpath>
                <xpathexpr="//filter[@name='month']"position="before">
                    <filtername="billable_timesheet"string="Billable"domain="[('so_line','!=',False),('non_allow_billable','=',False)]"/>
                    <filtername="non_billable_timesheet"string="NonBillable"domain="['|',('so_line','=',False),('non_allow_billable','=',True)]"/>
                    <separator/>
                    <filtername="billable_time"string="BilledonTimesheets"domain="[('timesheet_invoice_type','=','billable_time')]"/>
                    <filtername="billable_fixed"string="BilledataFixedPrice"domain="[('timesheet_invoice_type','=','billable_fixed')]"/>
                    <filtername="non_billable"string="NonBillableTasks"domain="[('timesheet_invoice_type','=','non_billable')]"/>
                    <separator/>
                </xpath>
                <xpathexpr="//filter[@name='groupby_department']"position="before">
                        <filterstring="BillableType"name="groupby_timesheet_invoice_type"domain="[]"context="{'group_by':'timesheet_invoice_type'}"/>
                </xpath>
            </field>
    </record>

    <recordid="timesheet_view_pivot_revenue"model="ir.ui.view">
        <fieldname="name">account.analytic.line.pivot.revenue</field>
        <fieldname="model">account.analytic.line</field>
        <fieldname="arch"type="xml">
            <pivotstring="Timesheet"sample="1">
                <fieldname="employee_id"type="row"/>
                <fieldname="date"interval="month"type="col"/>
                <fieldname="unit_amount"type="measure"/>
            </pivot>
        </field>
    </record>

    <recordid="timesheet_view_tree_sale"model="ir.ui.view">
        <fieldname="name">account.analytic.line.view.tree.with.allow.billable</field>
        <fieldname="model">account.analytic.line</field>
        <fieldname="inherit_id"ref="hr_timesheet.timesheet_view_tree_user"/>
        <fieldname="arch"type="xml">
            <xpathexpr="//field[@name='user_id']"position="after">
                <fieldname="non_allow_billable"attrs="{'invisible':[('non_allow_billable','=',False)]}"optional="hide"/>
            </xpath>
        </field>
    </record>

    <!--
        TimesheetfromSalesOrder
    -->
    <recordid="timesheet_action_from_sales_order"model="ir.actions.act_window">
        <fieldname="name">Timesheets</field>
        <fieldname="res_model">account.analytic.line</field>
        <fieldname="search_view_id"ref="hr_timesheet.hr_timesheet_line_search"/>
        <fieldname="domain">[('project_id','!=',False)]</field>
    </record>

    <recordid="timesheet_action_from_sales_order_tree"model="ir.actions.act_window.view">
        <fieldname="sequence"eval="4"/>
        <fieldname="view_mode">tree</field>
        <fieldname="view_id"ref="hr_timesheet.timesheet_view_tree_user"/>
        <fieldname="act_window_id"ref="timesheet_action_from_sales_order"/>
    </record>

    <recordid="timesheet_action_from_sales_order_form"model="ir.actions.act_window.view">
        <fieldname="sequence"eval="5"/>
        <fieldname="view_mode">form</field>
        <fieldname="view_id"ref="hr_timesheet.timesheet_view_form_user"/>
        <fieldname="act_window_id"ref="timesheet_action_from_sales_order"/>
    </record>

    <!--
        Reporting
    -->
    <recordid="timesheet_action_billing_report"model="ir.actions.act_window">
        <fieldname="name">TimesheetsByBillingType</field>
        <fieldname="res_model">account.analytic.line</field>
        <fieldname="view_mode">pivot,graph</field>
        <fieldname="domain">[('project_id','!=',False)]</field>
        <fieldname="context">{
            'search_default_groupby_date':1,
        }</field>
        <fieldname="search_view_id"ref="hr_timesheet.hr_timesheet_line_search"/>
    </record>

    <recordid="view_hr_timesheet_line_pivot_billing_rate"model="ir.ui.view">
        <fieldname="name">account.analytic.line.pivot.billing.rate</field>
        <fieldname="model">account.analytic.line</field>
        <fieldname="arch"type="xml">
            <pivotstring="Timesheet"sample="1">
                <fieldname="timesheet_invoice_type"type="col"/>
                <fieldname="unit_amount"type="measure"widget="timesheet_uom"/>
                <fieldname="amount"string="TimesheetCosts"/>
            </pivot>
        </field>
    </record>

    <recordid="timesheet_action_view_report_by_billing_rate_pivot"model="ir.actions.act_window.view">
        <fieldname="sequence"eval="5"/>
        <fieldname="view_mode">pivot</field>
        <fieldname="view_id"ref="view_hr_timesheet_line_pivot_billing_rate"/>
        <fieldname="act_window_id"ref="timesheet_action_billing_report"/>
    </record>

    <recordid="timesheet_action_view_report_by_billing_rate_graph"model="ir.actions.act_window.view">
        <fieldname="sequence"eval="6"/>
        <fieldname="view_mode">graph</field>
        <fieldname="view_id"ref="hr_timesheet.view_hr_timesheet_line_graph"/>
        <fieldname="act_window_id"ref="timesheet_action_billing_report"/>
    </record>

    <menuitemid="menu_timesheet_billing_analysis"
            parent="hr_timesheet.menu_timesheets_reports_timesheet"
            action="timesheet_action_billing_report"
            name="ByBillingType"
            sequence="40"/>

    <!--
        Plan
    -->
    <recordid="timesheet_action_plan_pivot"model="ir.actions.act_window">
        <fieldname="name">Timesheet</field>
        <fieldname="res_model">account.analytic.line</field>
        <fieldname="view_mode">pivot,tree,form</field>
        <fieldname="domain">[('project_id','!=',False)]</field>
        <fieldname="search_view_id"ref="hr_timesheet.hr_timesheet_line_search"/>
    </record>

    <recordid="timesheet_action_from_plan"model="ir.actions.act_window">
        <fieldname="name">Timesheet</field>
        <fieldname="res_model">account.analytic.line</field>
        <fieldname="view_mode">tree,form</field>
        <fieldname="domain">[('project_id','!=',False)]</field>
        <fieldname="search_view_id"ref="hr_timesheet.hr_timesheet_line_search"/>
    </record>

</flectra>
