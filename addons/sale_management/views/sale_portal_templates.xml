<?xmlversion="1.0"encoding="utf-8"?>
<flectra>

    <templateid="assets_frontend"inherit_id="web.assets_frontend"name="WebsiteQuotefrontendassets">
        <xpathexpr="."position="inside">
            <scripttype="text/javascript"src="/sale_management/static/src/js/sale_management.js"></script>
        </xpath>
    </template>

    <templateid="sale_order_portal_content_inherit_sale_management"name="OrderOptions"inherit_id="sale.sale_order_portal_content">

        <xpathexpr="//section[@id='details']//t[@t-set='display_discount']"position="after">
            <tt-set="display_remove"t-value="sale_order.statein('draft','sent')andany(line.sale_order_option_idsforlineinsale_order.order_line)"/>
        </xpath>

        <xpathexpr="//section[@id='details']//table[@id='sales_order_table']/thead/tr"position="inside">
            <!--addblankTrintheadforlayoutconciseness-->
            <tht-if="display_remove">
            </th>
        </xpath>

        <xpathexpr="//section[@id='details']//t[@t-if='notline.display_type']"position="inside">
            <tdclass="text-center"t-if="display_remove">
                <at-att-data-line-id="line.id"t-att-data-unlink="True"href="#"class="mb8js_update_line_jsond-print-none"t-if="sale_order.statein('draft','sent')andline.sale_order_option_ids"aria-label="Remove"title="Remove">
                    <spanclass="fafa-trash-o"></span>
                </a>
            </td>
        </xpath>

        <xpathexpr="//section[@id='signature']"position="after">
            <tt-if="any((notoption.is_present)foroptioninsale_order.sale_order_option_ids)">
                <section>
                    <h3>Options</h3>
                    <tt-set="display_discount"t-value="Truein[option.discount>0foroptioninsale_order.sale_order_option_ids]"/>
                    <tableclass="tabletable-sm">
                        <thead>
                            <tr>
                                <thclass="text-left">Product</th>
                                <tht-if="display_discount"class="text-right">Disc.%
                                </th>
                                <thclass="text-right">UnitPrice</th>
                                <tht-if="sale_order.statein['draft','sent']andreport_type=='html'"></th>
                            </tr>
                        </thead>
                        <tbody>
                            <trt-foreach="sale_order.sale_order_option_ids"t-as="option">
                                <tt-if="notoption.is_present">
                                    <td>
                                        <divt-field="option.name"/>
                                    </td>
                                    <tdt-if="display_discount"class="text-right">
                                        <strongt-if="option.discount"class="text-info">
                                            <tt-esc="((option.discount%1)and'%s'or'%d')%option.discount"/>%
                                        </strong>
                                    </td>
                                    <td>
                                        <strongclass="text-right">
                                            <divt-field="option.price_unit"
                                                t-options='{"widget":"monetary","display_currency":sale_order.pricelist_id.currency_id}'
                                                t-att-style="option.discountand'text-decoration:line-through'orNone"
                                                t-att-class="option.discountand'text-danger'orNone"/>
                                            <divt-if="option.discount">
                                                <tt-esc="(1-option.discount/100.0)*option.price_unit"t-options='{"widget":"monetary","display_currency":sale_order.pricelist_id.currency_id}'/>
                                            </div>
                                        </strong>
                                    </td>
                                    <tdclass="text-center"t-if="sale_order.statein['draft','sent']andreport_type=='html'">
                                        <at-att-data-option-id="option.id"href="#"class="mb8js_add_optional_productsd-print-none"aria-label="Addtocart"title="Addtocart">
                                            <spanclass="fafa-shopping-cart"/>
                                        </a>
                                    </td>
                                </t>
                            </tr>
                        </tbody>
                    </table>
                </section>
            </t>
        </xpath>

        <xpathexpr="//section[@id='details']//div[@id='quote_qty']"position="replace">
            <tt-if="sale_order.statein['draft','sent']andline.sale_order_option_ids">
                <divclass="input-groupjs_quantity_containerpull-right">

                    <divclass="input-group-prependd-print-none">
                        <spanclass="input-group-textd-noned-md-inline-block">
                            <at-att-data-line-id="line.id"t-att-data-remove="True"href="#"class="js_update_line_json"aria-label="Removeone"title="Removeone">
                                <spanclass="fafa-minus"/>
                            </a>
                        </span>
                    </div>
                    <!--TODOadduominthiscasetoo-->
                    <inputtype="text"class="js_quantityform-control"t-att-data-line-id="line.id"t-att-value="line.product_uom_qty"/>
                    <divclass="input-group-appendd-print-none">
                        <spanclass="input-group-textd-noned-md-inline-block">
                            <at-att-data-line-id="line.id"href="#"class="js_update_line_json"aria-label="Addone"title="Addone">
                                <spanclass="fafa-plus"/>
                            </a>
                        </span>
                    </div>
                </div>
            </t>
            <tt-else="">
                <spant-field="line.product_uom_qty"/>
                <spant-field="line.product_uom"/>
            </t>
        </xpath>

    </template>

</flectra>
