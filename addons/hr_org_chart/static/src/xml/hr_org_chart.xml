<?xmlversion="1.0"encoding="UTF-8"?>
<templatesid="template"xml:space="preserve">

<tt-name="hr_org_chart_employee">
    <divt-attf-class="o_org_chart_entryo_org_chart_entry_#{employee_type}media">
        <tt-set="is_self"t-value="employee.id==view_employee_id"/>

        <divclass="o_media_left">
            <!--NOTE:Sincebythedefaultonnotsquaredimagesflectraaddwhiteborders,
                usebg-imagestogetacleanandcentredimages-->
            <at-if="!is_self"
                class="o_media_objectrounded-circleo_employee_redirect"
                t-att-style="'background-image:url(\'/web/image/hr.employee.public/'+employee.id+'/image_1024/\')'"
                t-att-alt="employee.name"
                t-att-data-employee-id="employee.id"
                t-att-href="employee.link"/>
            <divt-if="is_self"
                class="o_media_objectrounded-circle"
                t-att-style="'background-image:url(\'/web/image/hr.employee.public/'+employee.id+'/image_1024/\')'"/>
        </div>

        <divclass="media-body">
            <span
                    t-if="employee.indirect_sub_count&gt;0"
                    class="badgebadge-pill"
                    tabindex="0"
                    data-trigger="focus"
                    t-att-data-emp-name="employee.name"
                    t-att-data-emp-id="employee.id"
                    t-att-data-emp-dir-subs="employee.direct_sub_count"
                    t-att-data-emp-ind-subs="employee.indirect_sub_count"
                    data-toggle="popover">
                <tt-esc="employee.indirect_sub_count"/>
            </span>

            <tt-if="!is_self">
                <at-att-href="employee.link"class="o_employee_redirect"t-att-data-employee-id="employee.id">
                    <h5class="o_media_heading"><b><tt-esc="employee.name"/></b></h5>
                    <strong><tt-esc="employee.job_title"/></strong>
                </a>
            </t>
            <tt-if="is_self">
                <h5class="o_media_heading"><b><tt-esc="employee.name"/></b></h5>
                <strong><tt-esc="employee.job_title"/></strong>
            </t>
        </div>
    </div>
</t>

<tt-name="hr_org_chart">
    <!--NOTE:Desideredbehaviour:
            Themaximunnumberofpeopleisalways7(including'self').Managershavepriorityoversuburdinates
            Eg.1Manager+1self=showjust5subordinates(ifavailables)
            Eg.0Manager+1self=show6subordinates(ifavailable)

        -->
    <tt-set="emp_count"t-value="0"/>

    <divt-if='managers.length&gt;0'class="o_org_chart_group_up">
        <tt-if='managers_more'>
            <divclass="o_org_chart_entryo_org_chart_moremedia">
                <divclass="o_media_left">
                    <aclass="text-centero_employee_more_managers"
                            t-att-data-employee-id="managers[0].id">
                        <it-attf-class="fafa-angle-double-up"role="img"aria-label="Moremanagers"title="Moremanagers"/>
                    </a>
                </div>
            </div>
        </t>

        <tt-foreach="managers"t-as="employee">
            <tt-set="emp_count"t-value="emp_count+1"/>
            <tt-call="hr_org_chart_employee">
                <tt-set="employee_type"t-value="'manager'"/>
            </t>
        </t>
    </div>

    <tt-if="children.length||managers.length"t-call="hr_org_chart_employee">
        <tt-set="employee_type"t-value="'self'"/>
        <tt-set="employee"t-value="self"/>
    </t>

    <tt-if="!children.length&amp;&amp;!managers.length">
        <divclass="alertalert-info"role="alert">
            <p><b>Nohierarchyposition.</b></p>
            <p>Thisemployeehasnomanagerorsubordinate.</p>
            <p>Inordertogetanorganigram,setamanagerandsavetherecord.</p>
        </div>
    </t>

    <divt-if="children.length"class="o_org_chart_group_down">
        <tt-foreach="children"t-as="employee">
            <tt-set="emp_count"t-value="emp_count+1"/>
            <tt-if="emp_count&lt;20">
                <tt-call="hr_org_chart_employee">
                    <tt-set="employee_type"t-value="'sub'"/>
                </t>
            </t>
        </t>

        <tt-if="(children.length+managers.length)&gt;19">
            <divclass="o_org_chart_entryo_org_chart_moremedia">
                <divclass="o_media_left">
                    <ahref="#"
                        t-att-data-employee-id="self.id"
                        t-att-data-employee-name="self.name"
                        class="o_org_chart_show_moretext-centero_employee_sub_redirect">SeeAll</a>
                </div>
            </div>
        </t>
    </div>
</t>

<tt-name="hr_orgchart_emp_popover">
    <divclass="popovero_org_chart_popup"role="tooltip"><divclass="arrow"></div><h3class="popover-header"></h3><divclass="popover-body"></div></div>
</t>

<tt-name="hr_orgchart_emp_popover_content">
    <tableclass="tabletable-sm">
        <thead>
            <tdclass="text-right"><tt-esc="employee.direct_sub_count"/></td>
            <td>
                <ahref="#"class="o_employee_sub_redirect"data-type='direct'
                        t-att-data-employee-name="employee.name"t-att-data-employee-id="employee.id">
                    <b>Directsubordinates</b></a>
            </td>
        </thead>
        <tbody>
            <tr>
                <tdclass="text-right">
                    <tt-esc="employee.indirect_sub_count-employee.direct_sub_count"/>
                </td>
                <td>
                    <ahref="#"class="o_employee_sub_redirect"data-type='indirect'
                            t-att-data-employee-name="employee.name"t-att-data-employee-id="employee.id">
                        Indirectsubordinates</a>
                </td>
            </tr>
            <tr>
                <tdclass="text-right"><tt-esc="employee.indirect_sub_count"/></td>
                <td>
                    <ahref="#"class="o_employee_sub_redirect"data-type='total'
                            t-att-data-employee-name="employee.name"t-att-data-employee-id="employee.id">
                        Total</a>
                </td>
            </tr>
        </tbody>
    </table>
</t>

<tt-name="hr_orgchart_emp_popover_title">
    <div>
        <spant-att-style='"background-image:url(\"/web/image/hr.employee.public/"+employee.id+"/image_1024/\")"'/>
        <ahref="#"class="float-righto_employee_redirect"t-att-data-employee-id="employee.id"><iclass="fafa-external-link"role="img"aria-label='Redirect'title="Redirect"></i></a>
        <b><tt-esc="employee.name"/></b>
    </div>
</t>

</templates>
