<?xmlversion="1.0"encoding="utf-8"?>
<flectra>
    <recordid="fetchmail_server_view_form"model="ir.ui.view">
        <fieldname="name">fetchmail.server.view.form.inherit.outlook</field>
        <fieldname="model">fetchmail.server</field>
        <fieldname="priority">1000</field>
        <fieldname="inherit_id"ref="fetchmail.view_email_server_form"/>
        <fieldname="arch"type="xml">
            <fieldname="server"position="before">
                <fieldname="use_microsoft_outlook_service"string="Outlook"
                    attrs="{'readonly':[('state','=','done')]}"/>
            </field>
            <fieldname="user"position="after">
                <fieldname="is_microsoft_outlook_configured"invisible="1"/>
                <fieldname="microsoft_outlook_refresh_token"invisible="1"/>
                <fieldname="microsoft_outlook_access_token"invisible="1"/>
                <fieldname="microsoft_outlook_access_token_expiration"invisible="1"/>
                <div></div>
                <divattrs="{'invisible':[('use_microsoft_outlook_service','=',False)]}">
                    <spanattrs="{'invisible':['|',('use_microsoft_outlook_service','=',False),('microsoft_outlook_refresh_token','=',False)]}"
                        class="badgebadge-success">
                        OutlookTokenValid
                    </span>
                    <buttontype="object"
                        name="open_microsoft_outlook_uri"class="btn-linkpx-0"
                        attrs="{'invisible':['|','|',('is_microsoft_outlook_configured','=',False),('use_microsoft_outlook_service','=',False),('microsoft_outlook_refresh_token','!=',False)]}">
                        <iclass="fafa-arrow-right"/>
                        ConnectyourOutlookaccount
                    </button>
                    <buttontype="object"
                        name="open_microsoft_outlook_uri"class="btn-linkpx-0"
                        attrs="{'invisible':['|','|',('is_microsoft_outlook_configured','=',False),('use_microsoft_outlook_service','=',False),('microsoft_outlook_refresh_token','=',False)]}">
                        <iclass="fafa-cog"/>
                        EditSettings
                    </button>
                    <divclass="alertalert-warning"role="alert"
                        attrs="{'invisible':['|',('is_microsoft_outlook_configured','=',True),('use_microsoft_outlook_service','=',False)]}">
                        SetupyourOutlookAPIcredentialsinthegeneralsettingstolinkaOutlookaccount.
                    </div>
                </div>
            </field>
            <fieldname="password"position="attributes">
                <attributename="attrs">{}</attribute>
            </field>
        </field>
    </record>
</flectra>
