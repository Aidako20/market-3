<?xmlversion="1.0"encoding="utf-8"?>
<flectra>
    <recordid="view_picking_form_inherited"model="ir.ui.view">
        <fieldname="name">stock_picking_batch.picking.form</field>
        <fieldname="model">stock.picking</field>
        <fieldname="inherit_id"ref="stock.view_picking_form"/>
        <fieldname="mode">primary</field>
        <fieldname="priority"eval="1000"/>
        <fieldname="arch"type="xml">
            <xpathexpr="//header"position="replace">
                <header>
                    <fieldname="state"widget="statusbar"statusbar_visible="draft,confirmed,assigned,done"/>
                </header>
            </xpath>
        </field>
    </record>


    <recordid="view_picking_move_tree_inherited"model="ir.ui.view">
        <fieldname="name">stock_picking_batch.picking.move.tree</field>
        <fieldname="model">stock.move</field>
        <fieldname="inherit_id"ref="stock.view_picking_move_tree"/>
        <fieldname="mode">primary</field>
        <fieldname="priority"eval="1000"/>
        <fieldname="arch"type="xml">
            <xpathexpr="//tree"position="attributes">
                <attributename="delete">0</attribute>
            </xpath>
            <xpathexpr="//field[@name='product_id']"position="after">
                <fieldname="picking_id"required="1"
                    attrs="{'readonly':[('id','!=',False)]}"
                    domain="[('id','in',parent.picking_ids)]"
                    options="{'no_create_edit':True}"/>
            </xpath>
            <xpathexpr="//field[@name='quantity_done']"position="attributes">
                <attributename="readonly">1</attribute>
            </xpath>
        </field>
    </record>

    <recordid="view_move_line_tree"model="ir.ui.view">
        <fieldname="name">stock_picking_batch.move.line.tree</field>
        <fieldname="model">stock.move.line</field>
        <fieldname="arch"type="xml">
            <treeeditable="top"decoration-muted="state=='cancel'"string="MoveLines"default_order="location_id">
                <fieldname="tracking"invisible="1"/>
                <fieldname="state"invisible="1"/>
                <fieldname="product_id"context="{'default_type':'product'}"required="1"attrs="{'readonly':[('id','!=',False)]}"/>
                <fieldname="picking_id"required="1"attrs="{'readonly':[('id','!=',False)]}"
                    options="{'no_create_edit':True}"domain="[('id','in',parent.picking_ids)]"/>
                <fieldname="lot_id"groups="stock.group_production_lot"attrs="{'readonly':[('tracking','notin',['lot','serial'])]}"/>
                <fieldname="location_id"/>
                <fieldname="location_dest_id"/>
                <fieldname="package_id"groups="stock.group_tracking_lot"/>
                <fieldname="result_package_id"groups="stock.group_tracking_lot"/>
                <fieldname="product_uom_qty"readonly="1"/>
                <fieldname="product_uom_id"options="{'no_create':True}"
                    groups="uom.group_uom"readonly="1"force_save="1"/>
                <fieldname="qty_done"/>
                <fieldname="company_id"groups="base.group_multi_company"force_save="1"/>
            </tree>
        </field>
    </record>

    <recordid="stock_picking_batch_form"model="ir.ui.view">
        <fieldname="name">stock.picking.batch.form</field>
        <fieldname="model">stock.picking.batch</field>
        <fieldname="arch"type="xml">
            <formstring="StockBatchTransfer">
                <fieldname="show_check_availability"invisible="1"/>
                <header>
                    <buttonname="action_confirm"states="draft"string="Confirm"type="object"class="oe_highlight"/>
                    <buttonname="action_done"string="Validate"type="object"class="oe_highlight"
                        attrs="{'invisible':[
                            '|',
                                ('state','!=','in_progress'),
                                ('show_check_availability','=',True)]}"/>
                    <buttonname="action_assign"string="CheckAvailability"type="object"class="oe_highlight"
                        attrs="{'invisible':[
                            '|',
                                ('state','!=','in_progress'),
                                ('show_check_availability','=',False)]}"/>
                    <buttonname="action_done"string="Validate"type="object"
                        attrs="{'invisible':[
                            '|',
                                ('state','!=','in_progress'),
                                ('show_check_availability','=',False)]}"/>
                    <buttonname="action_assign"string="CheckAvailability"type="object"
                        attrs="{'invisible':[
                            '|',
                                ('state','!=','draft'),
                                ('show_check_availability','=',False)]}"/>
                    <buttonname="action_print"states="in_progress,done"string="Print"type="object"/>
                    <buttonname="action_cancel"string="Cancel"type="object"states="in_progress"/>
                    <fieldname="state"widget="statusbar"statusbar_visible="draft,in_progress,done"/>
                </header>
                <sheet>
                    <divclass="oe_title">
                        <h1><fieldname="name"class="oe_inline"/></h1>
                    </div>
                    <group>
                        <group>
                            <fieldname="user_id"/>
                            <fieldname="picking_type_id"/>
                            <fieldname="company_id"groups="base.group_multi_company"attrs="{'readonly':[('picking_ids','!=',[])]}"force_save="1"/>
                        </group>
                        <group>
                            <fieldname="scheduled_date"/>
                        </group>
                    </group>
                    <notebook>
                        <pagestring="DetailedOperations"attrs="{'invisible':[('state','=','draft')]}">
                            <fieldname="move_line_ids"context="{'tree_view_ref':'stock_picking_batch.view_move_line_tree'}"/>
                            <buttonclass="oe_highlight"name="action_put_in_pack"type="object"string="PutinPack"attrs="{'invisible':[('state','in',('draft','done','cancel'))]}"groups="stock.group_tracking_lot"/>
                        </page>
                        <pagestring="Operations"attrs="{'invisible':[('state','=','draft')]}">
                            <fieldname="move_ids"context="{'tree_view_ref':'stock_picking_batch.view_picking_move_tree_inherited'}"/>
                        </page>
                        <pagestring="Transfers">
                            <fieldname="allowed_picking_ids"invisible="1"/>
                            <fieldname="picking_ids"widget="many2many"mode="tree,kanban"
                                context="{'form_view_ref':'stock_picking_batch.view_picking_form_inherited'}">
                                <tree>
                                    <fieldname="name"/>
                                    <fieldname="scheduled_date"/>
                                    <fieldname="location_id"/>
                                    <fieldname="backorder_id"/>
                                    <fieldname="origin"/>
                                    <fieldname="state"/>
                                </tree>
                            </field>
                        </page>
                    </notebook>
                </sheet>
                <divclass="oe_chatter">
                    <fieldname="message_follower_ids"groups="base.group_user"/>
                    <fieldname="activity_ids"/>
                    <fieldname="message_ids"/>
                </div>
            </form>
        </field>
    </record>
    <recordid="stock_picking_batch_tree"model="ir.ui.view">
        <fieldname="name">stock.picking.batch.tree</field>
        <fieldname="model">stock.picking.batch</field>
        <fieldname="arch"type="xml">
            <treestring="StockBatchTransfer"multi_edit="1"sample="1">
                <fieldname="name"decoration-bf="1"/>
                <fieldname="scheduled_date"/>
                <fieldname="user_id"widget="many2one_avatar_user"/>
                <fieldname="company_id"groups="base.group_multi_company"/>
                <fieldname="state"widget="badge"decoration-success="state=='done'"decoration-info="statein('draft','in_progress')"/>
                <fieldname="activity_exception_decoration"widget="activity_exception"/>
            </tree>
        </field>
    </record>
    <recordid="stock_picking_batch_kanban"model="ir.ui.view">
        <fieldname="name">stock.picking.batch.kanban</field>
        <fieldname="model">stock.picking.batch</field>
        <fieldname="arch"type="xml">
            <kanbanclass="o_kanban_mobile"sample="1">
                <fieldname="name"/>
                <fieldname="user_id"/>
                <fieldname="state"/>
                <templates>
                    <tt-name="kanban-box">
                        <divt-attf-class="oe_kanban_global_click">
                            <divclass="o_kanban_record_topmb16">
                                <divclass="o_kanban_record_headings">
                                    <strongclass="o_kanban_record_title"><fieldname="name"/></strong>
                                </div>
                                <fieldname="state"widget="label_selection"/>
                            </div>
                            <divclass="o_kanban_record_bottom">
                                <divclass="oe_kanban_bottom_left">
                                    <fieldname="picking_type_id"/>
                                </div>
                                <divclass="oe_kanban_bottom_right">
                                    <fieldname="scheduled_date"widget="date"/>
                                    <fieldname="user_id"widget="many2one_avatar_user"/>
                                </div>
                            </div>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>
    <recordid="stock_picking_batch_filter"model="ir.ui.view">
        <fieldname="name">stock.picking.batch.filter</field>
        <fieldname="model">stock.picking.batch</field>
        <fieldname="arch"type="xml">
            <searchstring="SearchBatchTransfer">
                <fieldname="name"string="BatchTransfer"/>
                <fieldname="user_id"/>
                <filtername="draft"string="Draft"domain="[('state','=','draft')]"/>
                <filtername="in_progress"string="InProgress"domain="[('state','=','in_progress')]"help="BatchTransfersnotfinished"/>
                <filtername="done"string="Done"domain="[('state','=','done')]"/>
                <separator/>
                <filterinvisible="1"string="LateActivities"name="activities_overdue"
                    domain="[('my_activity_date_deadline','&lt;',context_today().strftime('%Y-%m-%d'))]"
                    help="Showallrecordswhichhasnextactiondateisbeforetoday"/>
                <filterinvisible="1"string="TodayActivities"name="activities_today"
                    domain="[('my_activity_date_deadline','=',context_today().strftime('%Y-%m-%d'))]"/>
                <filterinvisible="1"string="FutureActivities"name="activities_upcoming_all"
                    domain="[('my_activity_date_deadline','&gt;',context_today().strftime('%Y-%m-%d'))]"/>
                <groupexpand="0"string="GroupBy">
                    <filterstring="Responsible"name="user"domain="[]"context="{'group_by':'user_id'}"/>
                    <filterstring="State"name="state"domain="[]"context="{'group_by':'state'}"/>
                </group>
           </search>
        </field>
    </record>
    <recordid="stock_picking_batch_action"model="ir.actions.act_window">
        <fieldname="name">BatchTransfers</field>
        <fieldname="type">ir.actions.act_window</field>
        <fieldname="res_model">stock.picking.batch</field>
        <fieldname="view_mode">tree,kanban,form</field>
        <fieldname="context">{
            "search_default_draft":True,
            "search_default_in_progress":True,
            'default_company_id':allowed_company_ids[0]
        }</field>
        <fieldname="search_view_id"ref="stock_picking_batch_filter"/>
        <fieldname="help"type="html">
          <pclass="o_view_nocontent_smiling_face">
            Createanewbatchtransfer
          </p><p>
            Thegoalofthebatchtransferistogroupoperationsthatmay
            (needsto)bedonetogetherinordertoincreasetheirefficiency.
            Itmayalsobeusefultoassignjobs(oneperson=onebatch)or
            helpthetimingmanagementofoperations(taskstobedoneat1pm).
          </p>
        </field>
    </record>
    <menuitemaction="stock_picking_batch_action"id="stock_picking_batch_menu"parent="stock.menu_stock_warehouse_mgmt"sequence="10"/>

    <recordid="vpicktree_inherit_stock_picking_batch"model="ir.ui.view">
        <fieldname="name">stock.picking.tree</field>
        <fieldname="model">stock.picking</field>
        <fieldname="inherit_id"ref="stock.vpicktree"/>
        <fieldname="arch"type="xml">
            <xpathexpr="//field[@name='company_id']"position="before">
                <fieldname="batch_id"optional="show"
                    domain="[
                        ('state','in',['draft','in_progress']),
                        '|',
                            ('picking_type_id','=',picking_type_id),
                            ('picking_type_id','=',False),
                    ]"
                    context="{'default_picking_type_id':picking_type_id}"/>
            </xpath>
        </field>
    </record>
    <recordid="view_picking_internal_search_inherit_stock_picking_batch"model="ir.ui.view">
        <fieldname="name">stock.picking.search</field>
        <fieldname="model">stock.picking</field>
        <fieldname="inherit_id"ref="stock.view_picking_internal_search"/>
        <fieldname="arch"type="xml">
            <xpathexpr="//field[@name='product_id']"position="after">
                <fieldname="batch_id"/>
            </xpath>
        </field>
    </record>

</flectra>
