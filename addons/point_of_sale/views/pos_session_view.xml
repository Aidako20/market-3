<?xmlversion="1.0"encoding="utf-8"?>
<flectra>
    <recordid="view_pos_session_form"model="ir.ui.view">
        <fieldname="name">pos.session.form.view</field>
        <fieldname="model">pos.session</field>
        <fieldname="arch"type="xml">
            <formstring="PointofSaleSession"create="0">
                <header>
                    <buttonname="open_cashbox_pos"type="object"string="OpenSession"
                        attrs="{'invisible':['|',('cash_control','=',False),('state','!=','new_session')]}"class="oe_highlight"
                         context="{'balance':'start'}"/>
                    <buttonname="open_frontend_cb"type="object"string="ContinueSelling"
                        attrs="{'invisible':['|',('rescue','=',True),('state','notin',['opening_control','opened'])]}"/>
                    <buttonid="end_session_opened"name="action_pos_session_closing_control"type="object"string="EndofSession"
                        attrs="{'invisible':['|',('cash_control','=',False),('state','!=','opened')]}"
                        class="oe_highlight"/>
                    <buttonid="validate_opened"name="action_pos_session_closing_control"type="object"string="CloseSession&amp;PostEntries"
                        attrs="{'invisible':['|',('cash_control','=',True),('state','!=','opened')]}"
                        class="oe_highlight"/>
                    <buttonid="validate_closing_control"name="action_pos_session_validate"type="object"string="CloseSession&amp;PostEntries"states="closing_control"
                        class="oe_highlight"/>

                    <fieldname="state"widget="statusbar"statusbar_visible="opened,closing_control,closed"nolabel="1"/>
                </header>
                <sheet>
                    <fieldname="cash_register_id"invisible="1"/>
                    <fieldname="failed_pickings"invisible="1"/>
                    <fieldname="rescue"invisible="1"/>
                    <divclass="oe_button_box"name="button_box">
                        <buttonname="action_view_order"
                            class="oe_stat_button"
                            icon="fa-shopping-basket"
                            type="object">
                            <fieldname="order_count"widget="statinfo"string="Orders"/>
                        </button>
                        <buttonclass="oe_stat_button"name="action_stock_picking"type="object"icon="fa-truck"attrs="{'invisible':[('picking_count','=',0)]}">
                            <fieldname="picking_count"widget="statinfo"string="Pickings"attrs="{'invisible':[('failed_pickings','!=',False)]}"/>
                            <fieldname="picking_count"widget="statinfo"string="Pickings"class="text-danger"attrs="{'invisible':[('failed_pickings','=',False)]}"/>
                        </button>
                        <button
                            name="action_show_payments_list"
                            type="object"
                            class="oe_stat_button"
                            icon="fa-dollar"
                            >
                            <fieldname="total_payments_amount"widget="statinfo"string="Payments"/>
                        </button>
                        <button
                            name="show_journal_items"
                            type="object"
                            class="oe_stat_button"
                            icon="fa-bars"
                            string="JournalItems"
                            attrs="{'invisible':[('move_id','=',False)]}"
                            groups="account.group_account_readonly"
                            >
                        </button>
                    </div>
                    <h1class="oe_title">
                        <fieldname="name"attrs="{'invisible':[('name','=','/')]}"class="oe_inline"/>
                    </h1>
                    <group>
                        <fieldname="cash_control"invisible="1"/>
                        <fieldname="user_id"/>
                        <fieldname="currency_id"invisible="1"/>
                        <fieldname="config_id"/>
                        <fieldname="move_id"readonly="1"groups="account.group_account_readonly"/>
                        <fieldname="start_at"attrs="{'invisible':[('state','=','opening_control')]}"/>
                        <fieldname="stop_at"attrs="{'invisible':[('state','!=','closed')]}"/>
                    </group>
                    <notebook>
                        <pagestring="CashControl"name="cash_control"attrs="{'invisible':[('cash_control','=',False)]}">
                            <groupclass="col-md-12"style="margin-left:140px;">
                                <groupclass="col-md-7">
                                    <divstyle="margin:0;padding:0;">
                                        <groupstyle="margin:0;padding:0;"attrs="{'invisible':[('state','in',['opening_control','closed'])]}">
                                            <fieldstyle="text-align:right;margin:0;padding:0;"name="cash_register_total_entry_encoding"widget="monetary"options="{'currency_field':'currency_id'}"string="+Transactions"/>
                                        </group>
                                        <groupstyle="margin:0;padding:0;"attrs="{'invisible':[('state','!=','closed')]}">
                                            <fieldstyle="text-align:right;margin:0;padding:0;"name="cash_real_transaction"widget="monetary"options="{'currency_field':'currency_id'}"string="+Transactions"/>
                                        </group>
                                        <groupstyle="margin:0;padding:0;"attrs="{'invisible':[('state','in',['opening_control','closed'])]}">
                                            <fieldstyle="text-align:right;margin:0;padding:0;"name="cash_register_balance_end"widget="monetary"options="{'currency_field':'currency_id'}"string="=ExpectedinCash"/>
                                        </group>
                                        <groupstyle="margin:0;padding:0;"attrs="{'invisible':[('state','!=','closed')]}">
                                            <fieldstyle="text-align:right;margin:0;padding:0;"name="cash_real_expected"widget="monetary"options="{'currency_field':'currency_id'}"string="=Expected"/>
                                        </group>
                                        <groupstyle="margin:0;padding:0;"attrs="{'invisible':[('state','in',['opening_control'])]}">
                                            <fieldstyle="text-align:right;margin:0;padding:0;"name="cash_register_balance_end_real"widget="monetary"options="{'currency_field':'currency_id'}"string="ActualinCash"/>
                                        </group>
                                    </div>
                                    <divstyle="margin:0;padding:0;">
                                        <groupstyle="margin:0;padding:0;"attrs="{'invisible':[('state','in',['opening_control'])]}">
                                            <buttonclass="oe_inlineoe_link"name="%(action_pos_box_out)d"type="action"attrs="{'invisible':[('state','=','closed')]}">CashIn/Out</button>
                                        </group>
                                        <groupstyle="margin:0;padding:0;"attrs="{'invisible':[('state','=','opening_control')]}">
                                        </group>
                                        <groupstyle="margin:0;padding:0;"attrs="{'invisible':[('state','=','opening_control')]}">
                                            <buttonclass="oe_inlineoe_link"name="open_cashbox_pos"type="object"attrs="{'invisible':[('state','!=','closing_control')]}"context="{'balance':'close'}">SetClosingCash</button>
                                        </group>
                                    </div>
                                </group>
                            </group>

                            <divclass="col-md-4"attrs="{'invisible':[('state','!=','closing_control')]}"style="height:30px">
                                <groupclass="oe_subtotal_footer">
                                    <fieldname="cash_register_difference"widget="monetary"options="{'currency_field':'currency_id'}"decoration-danger="cash_register_difference!=0"/>
                                </group>
                            </div>
                            <divclass="col-md-4"attrs="{'invisible':[('state','!=','closed')]}"style="height:30px">
                                <groupclass="oe_subtotal_footer">
                                    <fieldname="cash_real_difference"widget="monetary"options="{'currency_field':'currency_id'}"decoration-danger="cash_real_difference!=0"/>
                                </group>
                            </div>
                        </page>
                    </notebook>
                </sheet>
                <divclass="oe_chatter">
                    <fieldname="activity_ids"/>
                    <fieldname="message_follower_ids"/>
                    <fieldname="message_ids"/>
                </div>
            </form>
        </field>
    </record>

    <recordid="view_pos_session_tree"model="ir.ui.view">
        <fieldname="name">pos.session.tree.view</field>
        <fieldname="model">pos.session</field>
        <fieldname="arch"type="xml">
            <treestring="PointofSaleSession"create="0"sample="1">
                <fieldname="name"decoration-bf="1"/>
                <fieldname="config_id"/>
                <fieldname="user_id"widget="many2one_avatar_user"/>
                <fieldname="start_at"/>
                <fieldname="stop_at"/>
                <fieldname="state"widget="badge"decoration-info="statein('opening_control')"decoration-success="statein('opened','closed')"decoration-warning="state=='closing_control'"/>
            </tree>
        </field>
    </record>

    <recordmodel="ir.ui.view"id="view_pos_session_kanban">
        <fieldname="name">pos.session.kanban</field>
        <fieldname="model">pos.session</field>
        <fieldname="arch"type="xml">
            <kanbanclass="o_kanban_mobile"create="0"sample="1">
                <fieldname="config_id"/>
                <fieldname="name"/>
                <fieldname="user_id"/>
                <fieldname="start_at"/>
                <fieldname="state"/>
                <templates>
                    <tt-name="kanban-box">
                        <divt-attf-class="oe_kanban_cardoe_kanban_global_click">
                            <divclass="o_kanban_record_top">
                                <divclass="o_kanban_record_headings">
                                    <strongclass="o_kanban_record_title"><span><fieldname="config_id"/></span></strong>
                                </div>
                                <fieldname="state"widget="label_selection"options="{'classes':{'opening_control':'default',
                                        'opened':'success','closing_control':'warning','closed':'warning'}}"/>
                            </div>
                            <divclass="o_kanban_record_body">
                                <fieldname="name"/>
                            </div>
                            <divclass="o_kanban_record_bottom">
                                <divclass="oe_kanban_bottom_left">
                                    <span><fieldname="start_at"/></span>
                                </div>
                                <divclass="oe_kanban_bottom_right">
                                    <fieldname="user_id"widget="many2one_avatar_user"/>
                                </div>
                            </div>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>

    <recordid="view_pos_session_search"model="ir.ui.view">
        <fieldname="name">pos.session.search.view</field>
        <fieldname="model">pos.session</field>
        <fieldname="arch"type="xml">
            <searchstring="PointofSaleSession">
                <fieldname="name"/>
                <fieldname="config_id"/>
                <fieldname="user_id"/>
                <filtername="my_sessions"string="MySessions"domain="[('user_id','=',uid)]"/>
                <separator/>
                <filtername="open_sessions"string="InProgress"domain="[('state','=','opened')]"/>
                <separator/>
                <filterstring="OpeningDate"name="start_date"date="start_at"/>
                <groupexpand="0"string="GroupBy">
                    <filterstring="OpenedBy"name="user"domain="[]"context="{'group_by':'user_id'}"/>
                    <filterstring="PointofSale"name="point_of_sale"domain="[]"context="{'group_by':'config_id'}"/>
                    <filterstring="Status"name="status"domain="[]"context="{'group_by':'state'}"/>
                    <filterstring="OpeningDate"name="opening_date"domain="[]"context="{'group_by':'start_at'}"/>
                    <filterstring="ClosingDate"name="closing_date"domain="[]"context="{'group_by':'stop_at'}"/>
                </group>
            </search>
        </field>
    </record>

    <recordid="action_pos_session"model="ir.actions.act_window">
        <fieldname="name">Sessions</field>
        <fieldname="type">ir.actions.act_window</field>
        <fieldname="res_model">pos.session</field>
        <fieldname="view_mode">tree,kanban,form</field>
        <fieldname="search_view_id"ref="view_pos_session_search"/>
        <fieldname="help"type="html">
            <pclass="o_view_nocontent_empty_folder">
                Nosessionsfound
            </p><p>
                Asessionisaperiodoftime,usuallyoneday,duringwhichyousellthroughthePointofSale.
            </p>
        </field>
    </record>

    <recordid="mail_activity_old_session"model="mail.activity.type">
        <fieldname="name">Sessionopenover7days</field>
        <fieldname="summary">note</field>
        <fieldname="category">default</field>
        <fieldname="res_model_id"ref="model_pos_session"/>
        <fieldname="icon">fa-tasks</field>
        <fieldname="delay_count">0</field>
    </record>


    <recordmodel="ir.ui.view"id="closing_balance_confirm">
        <fieldname="name">Confirmingbalanceclosing</field>
        <fieldname="model">closing.balance.confirm.wizard</field>
        <fieldname="type">form</field>
        <fieldname="arch"type="xml">
            <form>
                <group>
                    <span>Thereisadifferencebetweentheexpectedandactualclosingincash.Areyousureyouwanttoclosethesessionandposttheaccountingentries?</span>
                </group>
                <footer>
                    <buttonname="confirm_closing_balance"string="Confirm"type="object"class="oe_highlight,btn-primary"/>
                    <buttonstring="Discard"special="cancel"class="oe_highlight,btn-secondary"/>
                </footer>
            </form>
        </field>
    </record>

    <menuitem
        id="menu_pos_session_all"
        parent="menu_point_of_sale"
        action="action_pos_session"
        sequence="2"
        groups="group_pos_manager"/>
</flectra>
