flectra.define('point_of_sale.NumpadWidget',function(require){
    'usestrict';

    constPosComponent=require('point_of_sale.PosComponent');
    constRegistries=require('point_of_sale.Registries');

    /**
     *@prop{'quantiy'|'price'|'discount'}activeMode
     *@eventset-numpad-mode-triggeredwhenmodebuttonisclicked
     *@eventnumpad-click-input-triggeredwhennumpadbuttonisclicked
     *
     *IMPROVEMENT:Whenevernew-orderline-selectedistriggered,
     *numpadmodeshouldbesetto'quantity'.Nowthatthemodestate
     *isliftedtotheparentcomponent,thisimprovementcanbedonein
     *theparentcomponent.
     */
    classNumpadWidgetextendsPosComponent{
        mounted(){
            //IMPROVEMENT:Thislistenershouldn'tbeherebecauseincorepoint_of_sale
            //thereisnowayofchangingthecashier.Onlywhenpos_hrisinstalled
            //thatthislistenermakessense.
            this.env.pos.on('change:cashier',()=>{
                if(!this.hasPriceControlRights&&this.props.activeMode==='price'){
                    this.trigger('set-numpad-mode',{mode:'quantity'});
                }
            });
        }
        willUnmount(){
            this.env.pos.on('change:cashier',null,this);
        }
        gethasPriceControlRights(){
            constcashier=this.env.pos.get('cashier')||this.env.pos.get_cashier();
            return!this.env.pos.config.restrict_price_control||cashier.role=='manager';
        }
        gethasManualDiscount(){
            returnthis.env.pos.config.manual_discount;
        }
        changeMode(mode){
            if(!this.hasPriceControlRights&&mode==='price'){
                return;
            }
            if(!this.hasManualDiscount&&mode==='discount'){
                return;
            }
            this.trigger('set-numpad-mode',{mode});
        }
        sendInput(key){
            this.trigger('numpad-click-input',{key});
        }
        getdecimalSeparator(){
            returnthis.env._t.database.parameters.decimal_point;
        }
    }
    NumpadWidget.template='NumpadWidget';

    Registries.Component.add(NumpadWidget);

    returnNumpadWidget;
});
