<?xmlversion="1.0"encoding="UTF-8"?>
<templatesxml:space="preserve">

    <tt-name="mail.Composer"owl="1">
        <divclass="o_Composer"
            t-att-class="{
                'o-focused':composerandcomposer.hasFocus,
                'o-has-current-partner-avatar':props.hasCurrentPartnerAvatar,
                'o-has-footer':hasFooter,
                'o-has-header':hasHeader,
                'o-is-compact':props.isCompact,
            }"
            t-on-keydown="_onKeydown"
        >
            <tt-if="composer">
                <tt-if="isDropZoneVisible.valueandcomposer.hasDropZone">
                    <DropZone
                        class="o_Composer_dropZone"
                        t-on-o-dropzone-files-dropped="_onDropZoneFilesDropped"
                        t-ref="dropzone"
                    />
                </t>
                <FileUploader
                    attachmentLocalIds="composer.attachments.map(attachment=>attachment.localId)"
                    newAttachmentExtraData="newAttachmentExtraData"
                    t-ref="fileUploader"
                />
                <tt-if="hasHeader">
                    <divclass="o_Composer_coreHeader">
                        <tt-if="props.hasThreadNameandcomposer.thread">
                            <spanclass="o_Composer_threadName">
                                on:<b><tt-esc="composer.thread.displayName"/></b>
                            </span>
                        </t>
                        <tt-if="props.hasFollowersand!composer.isLog">
                            <!--Textforfollowers-->
                            <smallclass="o_Composer_followers">
                                <bclass="text-muted">To:</b>
                                <emclass="text-muted">Followersof</em>
                                <b>
                                    <tt-if="composer.threadandcomposer.thread.name">
                                        &#32;&quot;<tt-esc="composer.thread.name"/>&quot;
                                    </t>
                                    <tt-else="">
                                        thisdocument
                                    </t>
                                </b>
                            </small>
                            <ComposerSuggestedRecipientList
                                threadLocalId="composer.thread.localId"
                            />
                        </t>
                    </div>
                </t>
                <tt-if="composer.threadandcomposer.thread.model==='mail.channel'andcomposer.thread.mass_mailing">
                    <divclass="o_Composer_subject">
                        <inputclass="o_Composer_subjectInput"type="text"placeholder="Subject"t-on-input="_onInputSubject"t-ref="subject"/>
                    </div>
                </t>
                <tt-if="props.hasCurrentPartnerAvatar">
                    <divclass="o_Composer_sidebarMain">
                        <imgclass="o_Composer_currentPartnerAvatarrounded-circle"t-att-src="currentPartnerAvatar"alt=""/>
                    </div>
                </t>
                <div
                    class="o_Composer_coreMain"
                    t-att-class="{
                        'o-composer-is-compact':props.isCompact,
                        'o-composer-is-extended':composer.threadandcomposer.thread.mass_mailing,
                    }"
                >
                    <TextInput
                        class="o_Composer_textInput"
                        t-att-class="{
                            'o-composer-is-compact':props.isCompact,
                            'o_Composer_textInput-mobile':env.messaging.device.isMobile,
                            'o-has-current-partner-avatar':props.hasCurrentPartnerAvatar,
                        }"
                        composerLocalId="composer.localId"
                        hasMentionSuggestionsBelowPosition="props.hasMentionSuggestionsBelowPosition"
                        isCompact="props.isCompact"
                        sendShortcuts="props.textInputSendShortcuts"
                        t-on-o-composer-suggestion-clicked="_onComposerSuggestionClicked"
                        t-on-o-composer-text-input-send-shortcut="_onComposerTextInputSendShortcut"
                        t-on-paste="_onPasteTextInput"
                        t-key="composer.localId"
                        t-ref="textInput"
                    />
                    <divclass="o_Composer_buttons"t-att-class="{'o-composer-is-compact':props.isCompact,'o-mobile':env.messaging.device.isMobile}">
                        <divclass="o_Composer_toolButtons"
                            t-att-class="{
                                'o-composer-has-current-partner-avatar':props.hasCurrentPartnerAvatar,
                                'o-composer-is-compact':props.isCompact,
                            }">
                            <tt-if="props.isCompact">
                                <divclass="o_Composer_toolButtonSeparator"/>
                            </t>
                            <divclass="o_Composer_primaryToolButtons"t-att-class="{'o-composer-is-compact':props.isCompact}">
                                <Popoverposition="'top'"t-on-o-emoji-selection="_onEmojiSelection">
                                    <!--TODOFIXMEo-openandaria-expandednotpossibletocodeduetohttps://github.com/flectra/owl/issues/693-->
                                    <buttonclass="o_Composer_buttono_Composer_buttonEmojiso_Composer_toolButtonbtnbtn-light"
                                        t-att-class="{
                                            'o-open':falseandstate.displayed,
                                            'o-mobile':env.messaging.device.isMobile,
                                        }"
                                        t-on-keydown="_onKeydownEmojiButton"
                                        aria-label="Emojis"
                                        t-att-aria-expanded="falseand(state.displayed?'true':'false')"
                                    >
                                        <iclass="fafa-smile-o"/>
                                    </button>
                                    <tt-set="opened">
                                        <EmojisPopovert-ref="emojisPopover"/>
                                    </t>
                                </Popover>
                                <buttonclass="o_Composer_buttono_Composer_buttonAttachmento_Composer_toolButtonbtnbtn-lightfafa-paperclip"t-att-class="{'o-mobile':env.messaging.device.isMobile}"title="Addattachment"aria-label="Addattachment"type="button"t-on-click="_onClickAddAttachment"/>
                            </div>
                            <tt-if="props.isExpandable">
                                <divclass="o_Composer_secondaryToolButtons">
                                    <buttonclass="btnbtn-lightfafa-expando_Composer_buttono_Composer_buttonFullComposero_Composer_toolButton"t-att-class="{'o-mobile':env.messaging.device.isMobile}"title="Fullcomposer"aria-label="Fullcomposer"type="button"t-on-click="_onClickFullComposer"/>
                                </div>
                            </t>
                        </div>
                        <tt-if="props.isCompact">
                            <tt-call="mail.Composer.actionButtons"/>
                        </t>
                    </div>
                </div>
                <tt-if="hasFooter">
                    <divclass="o_Composer_coreFooter"t-att-class="{'o-composer-is-compact':props.isCompact}">
                        <tt-if="props.hasThreadTyping">
                            <ThreadTextualTypingStatusclass="o_Composer_threadTextualTypingStatus"threadLocalId="composer.thread.localId"/>
                        </t>
                        <tt-if="composer.attachments.length>0">
                            <AttachmentList
                                class="o_Composer_attachmentList"
                                t-att-class="{'o-composer-is-compact':props.isCompact}"
                                areAttachmentsEditable="true"
                                attachmentsDetailsMode="props.attachmentsDetailsMode"
                                attachmentsImageSize="'small'"
                                attachmentLocalIds="composer.attachments.map(attachment=>attachment.localId)"
                                showAttachmentsExtensions="props.showAttachmentsExtensions"
                                showAttachmentsFilenames="props.showAttachmentsFilenames"
                            />
                        </t>
                        <tt-if="!props.isCompact">
                            <tt-call="mail.Composer.actionButtons"/>
                        </t>
                    </div>
                </t>
            </t>
        </div>
    </t>

    <tt-name="mail.Composer.actionButtons"owl="1">
        <divclass="o_Composer_actionButtons"t-att-class="{'o-composer-is-compact':props.isCompact}">
            <tt-if="props.hasSendButton">
                <buttonclass="o_Composer_actionButtono_Composer_buttono_Composer_buttonSendbtnbtn-primary"
                    t-att-class="{
                        'fa':env.messaging.device.isMobile,
                        'fa-paper-plane-o':env.messaging.device.isMobile,
                        'o-last':env.messaging.device.isMobileor!props.hasDiscardButton,
                        'o-composer-is-compact':props.isCompact,
                        'o-has-current-partner-avatar':props.hasCurrentPartnerAvatar,
                    }"
                    t-att-disabled="!composer.canPostMessage?'disabled':''"
                    type="button"
                    t-on-click="_onClickSend"
                >
                    <tt-if="!env.messaging.device.isMobile"><tt-if="composer.isLog">Log</t><tt-else="">Send</t></t>
                </button>
            </t>
            <tt-if="!env.messaging.device.isMobileandprops.hasDiscardButton">
                <buttonclass="o_Composer_actionButtono-lasto_Composer_buttono_Composer_buttonDiscardbtnbtn-secondary"t-att-class="{'o-composer-is-compact':props.isCompact,'o-has-current-partner-avatar':props.hasCurrentPartnerAvatar}"type="button"t-on-click="_onClickDiscard">
                    Discard
                </button>
            </t>
        </div>
    </t>

</templates>
