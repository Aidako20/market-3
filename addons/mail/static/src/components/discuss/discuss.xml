<?xmlversion="1.0"encoding="UTF-8"?>
<templatesxml:space="preserve">

    <tt-name="mail.Discuss"owl="1">
        <divclass="o_Discuss"
            t-att-class="{
                'o-adding-item':discuss?discuss.isAddingChannelordiscuss.isAddingChat:false,
                'o-mobile':env.messaging?env.messaging.device.isMobile:false,
            }"
        >
            <tt-if="!env.isMessagingInitialized()">
                <divclass="o_Discuss_messagingNotInitialized"><iclass="o_Discuss_messagingNotInitializedIconfafa-spinnerfa-spin"/>Pleasewait...</div>
            </t>
            <tt-else="">
                <tt-if="!env.messaging.device.isMobile">
                    <DiscussSidebarclass="o_Discuss_sidebar"/>
                </t>
                <tt-if="env.messaging.device.isMobile"t-call="mail.Discuss.content"/>
                <tt-else="">
                    <divclass="o_Discuss_content">
                        <tt-call="mail.Discuss.content"/>
                    </div>
                </t>
                <tt-if="discuss.hasModerationDiscardDialog">
                    <ModerationDiscardDialogmessageLocalIds="discuss.threadView.checkedMessages.map(message=>message.localId)"t-on-dialog-closed="_onDialogClosedModerationDiscard"/>
                </t>
                <tt-if="discuss.hasModerationRejectDialog">
                    <ModerationRejectDialogmessageLocalIds="discuss.threadView.checkedMessages.map(message=>message.localId)"t-on-dialog-closed="_onDialogClosedModerationReject"/>
                </t>
            </t>
        </div>
    </t>

    <tt-name="mail.Discuss.content"owl="1">
        <tt-if="env.messaging.device.isMobileanddiscuss.activeMobileNavbarTabId==='mailbox'">
            <DiscussMobileMailboxSelectionclass="o_Discuss_mobileMailboxSelection"/>
        </t>
        <tt-if="env.messaging.device.isMobileand(discuss.isAddingChannelordiscuss.isAddingChat)">
            <divclass="o_Discuss_mobileAddItemHeader">
                <AutocompleteInput
                    class="o_Discuss_mobileAddItemHeaderInput"
                    isFocusOnMount="true"
                    isHtml="discuss.isAddingChannel"
                    placeholder="discuss.isAddingChannel?addChannelInputPlaceholder:addChatInputPlaceholder"
                    select="_onMobileAddItemHeaderInputSelect"
                    source="_onMobileAddItemHeaderInputSource"
                    t-on-o-hide="_onHideMobileAddItemHeader"
                />
            </div>
        </t>
        <tt-if="discuss.threadView">
            <ThreadView
                class="o_Discuss_thread"
                t-att-class="{'o-mobile':env.messaging.device.isMobile}"
                composerAttachmentsDetailsMode="'card'"
                hasComposer="discuss.thread.model!=='mail.box'"
                hasComposerCurrentPartnerAvatar="!env.messaging.device.isMobile"
                hasComposerThreadTyping="true"
                hasMessageCheckbox="true"
                hasSquashCloseMessages="discuss.thread.model!=='mail.box'"
                haveMessagesMarkAsReadIcon="discuss.thread===env.messaging.inbox"
                haveMessagesReplyIcon="discuss.thread===env.messaging.inbox"
                isDoFocus="discuss.isDoFocus"
                selectedMessageLocalId="discuss.replyingToMessageanddiscuss.replyingToMessage.localId"
                threadViewLocalId="discuss.threadView.localId"
                t-on-o-focusin-composer="_onFocusinComposer"
                t-on-o-rendered="_onThreadRendered"
                t-ref="threadView"
            />
        </t>
        <tt-if="!discuss.threadand(!env.messaging.device.isMobileordiscuss.activeMobileNavbarTabId==='mailbox')">
            <divclass="o_Discuss_noThread">
                Noconversationselected.
            </div>
        </t>
        <tt-if="env.messaging.device.isMobileanddiscuss.activeMobileNavbarTabId!=='mailbox'">
            <NotificationList
                class="o_Discuss_notificationList"
                filter="discuss.activeMobileNavbarTabId"
            />
        </t>
        <tt-if="env.messaging.device.isMobileand!discuss.isReplyingToMessage">
            <MobileMessagingNavbar
                class="o_Discuss_mobileNavbar"
                activeTabId="discuss.activeMobileNavbarTabId"
                tabs="mobileNavbarTabs()"
                t-on-o-select-mobile-messaging-navbar-tab="_onSelectMobileNavbarTab"
            />
        </t>
        <tt-if="discuss.isReplyingToMessage">
            <Composer
                class="o_Discuss_replyingToMessageComposer"
                composerLocalId="discuss.replyingToMessage.originThread.composer.localId"
                hasCurrentPartnerAvatar="!env.messaging.device.isMobile"
                hasDiscardButton="true"
                hasThreadName="true"
                isDoFocus="discuss.isDoFocus"
                textInputSendShortcuts="['ctrl-enter','meta-enter']"
                t-on-o-focusin-composer="_onFocusinComposer"
                t-on-o-message-posted="_onReplyingToMessageMessagePosted"
                t-ref="composer"
            />
        </t>
    </t>

</templates>
