<?xmlversion="1.0"encoding="UTF-8"?>
<templatesxml:space="preserve">

    <tt-name="mail.Activity"owl="1">
        <divclass="o_Activity"t-on-click="_onClick">
            <tt-if="activity">
                <divclass="o_Activity_sidebar">
                    <divclass="o_Activity_user">
                        <tt-if="activity.assignee">
                            <imgclass="o_Activity_userAvataro_object_fit_cover"t-attf-src="/web/image/res.users/{{activity.assignee.id}}/image_128"t-att-alt="activity.assignee.nameOrDisplayName"/>
                        </t>
                        <divclass="o_Activity_iconContainer"
                            t-att-class="{
                                'bg-success-full':activity.state==='planned',
                                'bg-warning-full':activity.state==='today',
                                'bg-danger-full':activity.state==='overdue',
                            }"
                        >
                            <iclass="o_Activity_iconfa"t-attf-class="{{activity.icon}}"/>
                        </div>
                    </div>
                </div>
                <divclass="o_Activity_core">
                    <divclass="o_Activity_info">
                        <divclass="o_Activity_dueDateText"
                            t-att-class="{
                                'o-default':activity.state==='default',
                                'o-overdue':activity.state==='overdue',
                                'o-planned':activity.state==='planned',
                                'o-today':activity.state==='today',
                            }"
                        >
                            <tt-esc="delayLabel"/>
                        </div>
                        <tt-if="activity.summary">
                            <divclass="o_Activity_summary">
                                <tt-esc="summary"/>
                            </div>
                        </t>
                        <tt-elif="activity.type">
                            <divclass="o_Activity_summaryo_Activity_type">
                                <tt-esc="activity.type.displayName"/>
                            </div>
                        </t>
                        <tt-if="activity.assignee">
                            <divclass="o_Activity_userName">
                                <tt-esc="assignedUserText"/>
                            </div>
                        </t>
                        <ahref="#"class="o_Activity_detailsButtonbtnbtn-link"t-att-aria-expanded="state.areDetailsVisible?'true':'false'"t-on-click="_onClickDetailsButton"role="button">
                            <iclass="fafa-info-circle"role="img"title="Info"/>
                        </a>
                    </div>

                    <tt-if="state.areDetailsVisible">
                        <divclass="o_Activity_details">
                            <dlclass="dl-horizontal">
                                <tt-if="activity.type">
                                    <dt>Activitytype</dt>
                                    <ddclass="o_Activity_type">
                                        <tt-esc="activity.type.displayName"/>
                                    </dd>
                                </t>
                                <tt-if="activity.creator">
                                    <dt>Created</dt>
                                    <ddclass="o_Activity_detailsCreation">
                                        <tt-esc="formattedCreateDatetime"/>
                                        <imgclass="o_Activity_detailsUserAvataro_Activity_detailsCreatorAvatar"t-attf-src="/web/image/res.users/{{activity.creator.id}}/image_128"t-att-title="activity.creator.nameOrDisplayName"t-att-alt="activity.creator.nameOrDisplayName"/>
                                        <spanclass="o_Activity_detailsCreator">
                                            <tt-esc="activity.creator.nameOrDisplayName"/>
                                        </span>
                                    </dd>
                                </t>
                                <tt-if="activity.assignee">
                                    <dt>Assignedto</dt>
                                    <ddclass="o_Activity_detailsAssignation">
                                        <imgclass="o_Activity_detailsUserAvataro_Activity_detailsAssignationUserAvatar"t-attf-src="/web/image/res.users/{{activity.assignee.id}}/image_128"t-att-title="activity.assignee.nameOrDisplayName"t-att-alt="activity.assignee.nameOrDisplayName"/>
                                        <tt-esc="activity.assignee.nameOrDisplayName"/>
                                    </dd>
                                </t>
                                <dt>Dueon</dt>
                                <ddclass="o_Activity_detailsDueDate">
                                    <spanclass="o_Activity_deadlineDateText"
                                        t-att-class="{
                                            'o-default':activity.state==='default',
                                            'o-overdue':activity.state==='overdue',
                                            'o-planned':activity.state==='planned',
                                            'o-today':activity.state==='today',
                                        }"
                                    >
                                        <tt-esc="formattedDeadlineDate"/>
                                    </span>
                                </dd>
                            </dl>
                        </div>
                    </t>

                    <tt-if="activity.note">
                        <divclass="o_Activity_note">
                            <tt-raw="activity.note"/>
                        </div>
                    </t>

                    <tt-if="activity.mailTemplates.length>0">
                        <divclass="o_Activity_mailTemplates">
                            <tt-foreach="activity.mailTemplates"t-as="mailTemplate"t-key="mailTemplate.localId">
                                <MailTemplate
                                    class="o_Activity_mailTemplate"
                                    activityLocalId="activity.localId"
                                    mailTemplateLocalId="mailTemplate.localId"
                                />
                            </t>
                        </div>
                    </t>

                    <tt-if="activity.canWrite">
                        <divname="tools"class="o_Activity_tools">
                            <tt-if="activity.category!=='upload_file'">
                                <Popoverposition="'right'"title="MARK_DONE">
                                    <buttonclass="o_Activity_toolButtono_Activity_markDoneButtonbtnbtn-link"t-att-title="MARK_DONE">
                                        <iclass="fafa-check"/>MarkDone
                                    </button>
                                    <tt-set="opened">
                                        <ActivityMarkDonePopoveractivityLocalId="props.activityLocalId"/>
                                    </t>
                                </Popover>
                            </t>
                            <tt-else="">
                                <buttonclass="o_Activity_toolButtono_Activity_uploadButtonbtnbtn-link"t-on-click="_onClickUploadDocument">
                                    <iclass="fafa-upload"/>UploadDocument
                                </button>
                                <FileUploader
                                    attachmentLocalIds="activity.attachments.map(attachment=>attachment.localId)"
                                    uploadId="activity.thread.id"
                                    uploadModel="activity.thread.model"
                                    t-on-o-attachment-created="_onAttachmentCreated"
                                    t-ref="fileUploader"
                                />
                            </t>
                            <buttonclass="o_Activity_toolButtono_Activity_editButtonbtnbtn-link"t-on-click="_onClickEdit">
                                <iclass="fafa-pencil"/>Edit
                            </button>
                            <buttonclass="o_Activity_toolButtono_Activity_cancelButtonbtnbtn-link"t-on-click="_onClickCancel">
                                <iclass="fafa-times"/>Cancel
                            </button>
                        </div>
                    </t>
                </div>
            </t>
        </div>
    </t>

</templates>
