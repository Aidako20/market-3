<?xmlversion="1.0"?>
<flectra>
   <datanoupdate="1">
      <recordid="coupon.mail_template_sale_coupon"model="mail.template">
         <fieldname="name">Coupon:SendbyEmail</field>
         <fieldname="model_id"ref="coupon.model_coupon_coupon"/>
         <fieldname="subject">Yourrewardcouponfrom${object.program_id.company_id.name}</field>
         <fieldname="email_from">${object.program_id.company_id.email|safe}</field>
         <fieldname="partner_to">${object.order_id.partner_id.idorobject.partner_id.id}</field>
         <fieldname="lang">${object.partner_id.lang}</field>
         <fieldname="body_html"type="html">
<tableborder="0"cellpadding="0"cellspacing="0"style="width:100%;margin:0pxauto;"><tbody>
    <tr><tdvalign="top"style="text-align:center;font-size:14px;">
        %ifobject.partner_id.name:
        Congratulations${object.partner_id.name},<br/>
        %endif

        Hereisyourrewardfrom${object.program_id.company_id.name}.<br/>

        %ifobject.program_id.reward_type=='discount':
            %ifobject.program_id.discount_type=='fixed_amount':
            <spanstyle="font-size:50px;color:#009EFB;font-weight:bold;">
                ${'%s'%format_amount(object.program_id.discount_fixed_amount,object.program_id.currency_id)}
            </span><br/>
            <strongstyle="font-size:24px;">offonyournextorder</strong><br/>
            %else
            <spanstyle="font-size:50px;color:#009EFB;font-weight:bold;">
                ${object.program_id.discount_percentage}%
            </span>
            %ifobject.program_id.discount_apply_on=='specific_products'
                <br/>
                %iflen(object.program_id.discount_specific_product_ids)!=1
                %setdisplay_specific_products=True
                <strongstyle="font-size:24px;">
                    onsomeproducts*
                </strong>
                %else
                <strongstyle="font-size:24px;">
                    ${'on%s'%object.program_id.discount_specific_product_ids.name}
                </strong>
                %endif
            %elifobject.program_id.discount_apply_on=='cheapest_product':
            <br/><strongstyle="font-size:24px;">
                offonthecheapestproduct
            </strong>
            %else
            <br/><strongstyle="font-size:24px;">
                offonyournextorder
            </strong>
            %endif
            <br/>
            %endif
        %elifobject.program_id.reward_type=='product':
            <spanstyle="font-size:36px;color:#009EFB;font-weight:bold;">
                ${'get%sfree%s'%(object.program_id.reward_product_quantity,object.program_id.reward_product_id.name)}
            </span><br/>
            <strongstyle="font-size:24px;">onyournextorder</strong><br/>
        %elifobject.program_id.reward_type=='free_shipping':
            <spanstyle="font-size:36px;color:#009EFB;font-weight:bold;">
                getfreeshipping
            </span><br/>
            <strongstyle="font-size:24px;">onyournextorder</strong><br/>
        %endif
    </td></tr>
    <trstyle="margin-top:16px"><tdvalign="top"style="text-align:center;font-size:14px;">
        Usethispromocode
        %ifobject.expiration_date:
            before${object.expiration_date}
        %endif
        <pstyle="margin-top:16px;">
            <strongstyle="padding:16px8px16px8px;border-radius:3px;background-color:#F1F1F1;">
                ${object.code}
            </strong>
        </p>
        %ifobject.program_id.rule_min_quantitynotin[0,1]
        <spanstyle="font-size:14px;">
            Minimumpurchaseof${object.program_id.rule_min_quantity}products
        </span><br/>
        %endif
        %ifobject.program_id.rule_minimum_amount!=0.00
        <spanstyle="font-size:14px;">
            Validforpurchaseabove${object.program_id.company_id.currency_id.symbol}${'%0.2f'%object.program_id.rule_minimum_amount|float}
        </span><br/>
        %endif
        %ifdisplay_specific_products
        <span>
            *Validforfollowingproducts:${','.join(object.program_id.discount_specific_product_ids.mapped('name'))}
        </span><br/>
        %endif
        <br/>
        Thankyou,
        %ifobject.order_id.user_id.signature:
            <br/>
            ${object.order_id.user_id.signature|safe}
        %endif
    </td></tr>
</tbody></table>
            </field>
            <fieldname="report_template"ref="report_coupon_code"/>
            <fieldname="report_name">YourCouponCode</field>
            <fieldname="lang">${object.partner_id.lang}</field>
            <fieldname="auto_delete"eval="True"/>
      </record>

        <recordid="expire_coupon_cron"model="ir.cron">
            <fieldname="name">Coupon:expirecouponbasedondate</field>
            <fieldname="model_id"ref="coupon.model_coupon_coupon"/>
            <fieldname="state">code</field>
            <fieldname="code">model.cron_expire_coupon()</field>
            <fieldname="active"eval="True"/>
            <fieldname="user_id"ref="base.user_root"/>
            <fieldname="interval_number">1</field>
            <fieldname="interval_type">days</field>
            <fieldname="numbercall">-1</field>
        </record>
   </data>
</flectra>
