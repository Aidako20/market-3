<?xmlversion="1.0"encoding="utf-8"?>
<flectra>
    <data>

        <recordid="product_category_form_view_inherit"model="ir.ui.view">
            <fieldname="name">product.category.form</field>
            <fieldname="model">product.category</field>
            <fieldname="inherit_id"ref="product.product_category_form_view"/>
            <fieldname="arch"type="xml">
                <divname="button_box"position="inside">
                    <buttonstring="PutawayRules"
                        class="oe_stat_button"
                        icon="fa-random"name="%(category_open_putaway)d"type="action"
                        groups="stock.group_stock_multi_locations"/>
                </div>
                <groupname="first"position="after">
                    <groupstring="Logistics">
                        <fieldname="route_ids"widget="many2many_tags"groups="stock.group_adv_location"/>
                        <fieldname="total_route_ids"widget="many2many_tags"groups="stock.group_adv_location"attrs="{'invisible':[('parent_id','=',False)]}"/>
                        <fieldname="removal_strategy_id"options="{'no_create':True}"/>
                    </group>
                </group>
            </field>
        </record>

        <recordmodel="ir.actions.server"id="action_open_routes">
            <fieldname="name">Routes</field>
            <fieldname="model_id"ref="product.model_product_template"/>
            <fieldname="groups_id"eval="[(4,ref('stock.group_stock_user'))]"/>
            <fieldname="state">code</field>
            <fieldname="code">
                action=model.action_open_routes_diagram()
            </field>
        </record>

        <recordid="view_stock_product_tree"model="ir.ui.view">
            <fieldname="name">product.stock.tree.inherit</field>
            <fieldname="model">product.product</field>
            <fieldname="inherit_id"ref="product.product_product_tree_view"/>
            <fieldname="arch"type="xml">
                <fieldname="price"position="after">
                    <fieldname="qty_available"attrs="{'invisible':[('type','!=','product')]}"optional="show"decoration-danger="virtual_available&lt;0"decoration-warning="virtual_available==0"decoration-bf="1"/>
                    <fieldname="virtual_available"attrs="{'invisible':[('type','!=','product')]}"string="ForecastedQuantity"optional="show"decoration-danger="virtual_available&lt;0"decoration-warning="virtual_available==0"/>
                </field>
            </field>
        </record>

        <recordid="view_stock_product_template_tree"model="ir.ui.view">
            <fieldname="name">product.template.stock.tree.inherit</field>
            <fieldname="model">product.template</field>
            <fieldname="inherit_id"ref="product.product_template_tree_view"/>
            <fieldname="arch"type="xml">
                <fieldname="uom_id"position="before">
                    <fieldname="show_on_hand_qty_status_button"invisible="1"/>
                    <fieldname="qty_available"attrs="{'invisible':[('show_on_hand_qty_status_button','=',False)]}"optional="show"decoration-danger="qty_available&lt;0"/>
                    <fieldname="virtual_available"attrs="{'invisible':[('show_on_hand_qty_status_button','=',False)]}"optional="show"decoration-danger="virtual_available&lt;0"decoration-bf="1"/>
                </field>
                <fieldname="default_code"position="after">
                    <fieldname="responsible_id"widget="many2one_avatar_user"/>
                </field>
            </field>
        </record>

        <!--ProductTemplate-->

        <recordid="product_template_search_form_view_stock"model="ir.ui.view">
            <fieldname="name">product.template.search.stock.form</field>
            <fieldname="model">product.template</field>
            <fieldname="mode">primary</field>
            <fieldname="inherit_id"ref="product.product_template_search_view"/>
            <fieldname="arch"type="xml">
                <xpathexpr="//field[@name='pricelist_id']"position="after">
                    <separator/>
                    <fieldname="location_id"context="{'location':self}"filter_domain="[]"/>
                    <fieldname="warehouse_id"context="{'warehouse':self}"filter_domain="[]"/>
                    <separator/>
                    <filtername="real_stock_available"string="AvailableProducts"domain="[('qty_available','&gt;',0)]"/>
                    <filtername="real_stock_negative"string="NegativeForecastedQuantity"domain="[('virtual_available','&lt;',0)]"/>
                </xpath>
            </field>
        </record>

        <recordid="stock_product_search_form_view"model="ir.ui.view">
            <fieldname="name">product.product.search.stock.form</field>
            <fieldname="model">product.product</field>
            <fieldname="mode">primary</field>
            <fieldname="inherit_id"ref="product.product_search_form_view"/>
            <fieldname="arch"type="xml">
                <xpathexpr="//filter[@name='inactive']"position="after">
                    <separator/>
                    <filtername="real_stock_available"string="AvailableProducts"domain="[('qty_available','&gt;',0)]"/>
                    <filtername="real_stock_negative"string="NegativeForecastedQuantity"domain="[('virtual_available','&lt;',0)]"/>
                </xpath>
            </field>
        </record>

        <!--viewcommontobothtemplateandproduct-->
        <recordid="view_template_property_form"model="ir.ui.view">
            <fieldname="name">product.template.stock.property.form.inherit</field>
            <fieldname="model">product.template</field>
            <fieldname="inherit_id"ref="product.product_template_form_view"/>
            <fieldname="arch"type="xml">
                <xpathexpr="//group[@name='group_lots_and_weight']"position="inside">
                    <labelfor="sale_delay"attrs="{'invisible':[('sale_ok','=',False)]}"/>
                    <divattrs="{'invisible':[('sale_ok','=',False)]}">
                        <fieldname="sale_delay"class="oe_inline"style="vertical-align:baseline"/>days
                    </div>
                </xpath>
                <xpathexpr="//group[@name='group_lots_and_weight']"position="before">
                    <fieldname="has_available_route_ids"invisible="1"/>
                    <groupstring="Operations"name="operations">
                        <labelfor="route_ids"attrs="{'invisible':[('type','in',['service','digital'])]}"/>
                        <div>
                            <fieldname="route_ids"class="mb-0"widget="many2many_checkboxes"attrs="{'invisible':['|',('has_available_route_ids','=',False),('type','in',['service','digital'])]}"/>
                            <buttonid="stock.view_diagram_button"string="ViewDiagram"type="action"name="%(action_open_routes)d"icon="fa-arrow-right"
                                 attrs="{'invisible':[('type','notin',['product','consu'])]}"
                                 class="btnbtn-linkpt-0"context="{'default_product_tmpl_id':id}"/>
                        </div>
                        <fieldname="route_from_categ_ids"widget="many2many_tags"readonly="1"attrs="{'invisible':[('route_from_categ_ids','=',[])]}"/>
                    </group>
                </xpath>
                <xpathexpr="//group[@name='group_lots_and_weight']"position="after">
                    <groupstring="Traceability"name="traceability"groups="stock.group_production_lot"
                           attrs="{'invisible':[('type','=','consu')]}">
                        <fieldname="tracking"widget="radio"attrs="{'invisible':[('type','in',['service','digital'])]}"/>
                    </group>
                     <groupstring="CounterpartLocations"name="stock_property"groups="base.group_no_one">
                        <fieldname="property_stock_production"/>
                        <fieldname="property_stock_inventory"/>
                    </group>
                </xpath>
                <pagename="inventory"position="inside">
                    <groupstring="DescriptionforDeliveryOrders">
                        <fieldname="description_pickingout"nolabel="1"placeholder="Thisnoteisaddedtodeliveryorders."/>
                    </group>
                    <groupstring="DescriptionforReceipts">
                        <fieldname="description_pickingin"nolabel="1"placeholder="Thisnoteisaddedtoreceiptorders(e.g.wheretostoretheproductinthewarehouse)."/>
                    </group>
                    <groupstring="DescriptionforInternalTransfers"groups="stock.group_stock_multi_locations">
                        <fieldname="description_picking"placeholder="Thisnoteisaddedtointernaltransferorders(e.g.wheretopicktheproductinthewarehouse)."nolabel="1"/>
                    </group>
                </page>
                <xpathexpr="//page[@name='inventory']"position="attributes">
                    <attributename="groups"add="stock.group_stock_user"separator=","/>
                </xpath>
            </field>
        </record>

        <recordmodel="ir.ui.view"id="product_template_kanban_stock_view">
            <fieldname="name">ProductTemplateKanbanStock</field>
            <fieldname="model">product.template</field>
            <fieldname="inherit_id"ref="product.product_template_kanban_view"/>
            <fieldname="arch"type="xml">
                <xpathexpr="//kanban"position="inside">
                    <fieldname="type"/>
                    <fieldname="show_on_hand_qty_status_button"/>
                </xpath>
                <xpathexpr="//div[@name='product_lst_price']"position="after">
                    <divt-if="record.show_on_hand_qty_status_button.raw_value">Onhand:<fieldname="qty_available"/><fieldname="uom_id"/></div>
                </xpath>
            </field>
        </record>

        <!--ProductVariant-->

        <recordid="product_search_form_view_stock"model="ir.ui.view">
            <fieldname="name">product.search.stock.form</field>
            <fieldname="model">product.product</field>
            <fieldname="inherit_id"ref="product.product_search_form_view"/>
            <fieldname="arch"type="xml">
                <fieldname="pricelist_id"position="before">
                    <fieldname="location_id"options="{'no_create':True}"context="{'location':self}"filter_domain="[]"/>
                    <fieldname="warehouse_id"context="{'warehouse':self}"filter_domain="[]"/>
                </field>
            </field>
        </record>

        <recordid="product_product_view_form_easy_inherit_stock"model="ir.ui.view">
            <fieldname="name">product.product.view.form.easy.inherit.stock</field>
            <fieldname="model">product.product</field>
            <fieldname="inherit_id"ref="product.product_variant_easy_edit_view"/>
            <fieldname="arch"type="xml">
                <sheetposition="before">
                    <header>
                        <buttonstring="UpdateQuantity"type="object"
                            groups="stock.group_stock_manager"
                            name="action_update_quantity_on_hand"
                            attrs="{'invisible':[('type','!=','product')]}"/>
                        <buttonstring="Replenish"type="action"
                            name="%(action_product_replenish)d"
                            context="{'default_product_id':id}"
                            groups="stock.group_stock_user"
                            attrs="{'invisible':[('type','!=','product')]}"/>
                    </header>
                </sheet>
                <divname="button_box"position="inside">
                    <buttonstring="PutawayRules"type="object"
                        name="action_view_related_putaway_rules"
                        class="oe_stat_button"icon="fa-random"groups="stock.group_stock_multi_locations"
                        attrs="{'invisible':[('type','=','service')]}"
                        context="{'invisible_handle':True,'single_product':True}"/>
                </div>
            </field>
        </record>

        <!--viewusedforproduct.productonly-->
        <recordmodel="ir.ui.view"id="product_form_view_procurement_button">
            <fieldname="name">product.product.procurement</field>
            <fieldname="model">product.product</field>
            <fieldname="groups_id"eval="[(4,ref('stock.group_stock_user'))]"/>
            <fieldname="inherit_id"ref="product.product_normal_form_view"/>
            <fieldname="arch"type="xml">
                <data>
                    <headerposition="inside">
                        <buttonstring="UpdateQuantity"type="object"
                            groups="stock.group_stock_manager"
                            name="action_update_quantity_on_hand"
                            attrs="{'invisible':[('type','!=','product')]}"/>
                        <buttonstring="Replenish"type="action"
                            name="%(action_product_replenish)d"
                            context="{'default_product_id':id}"
                            groups="stock.group_stock_user"
                            attrs="{'invisible':[('type','!=','product')]}"/>
                    </header>
                    <divname="button_box"position="inside">
                        <buttonclass="oe_stat_button"
                               name="action_open_quants"
                               icon="fa-cubes"
                               type="object"attrs="{'invisible':[('type','!=','product')]}">
                               <divclass="o_field_widgeto_stat_info">
                                    <spanclass="o_stat_value">
                                        <fieldname="qty_available"widget="statinfo"nolabel="1"class="mr4"/>
                                        <fieldname="uom_name"/>
                                    </span>
                                    <spanclass="o_stat_text">OnHand</span>
                               </div>
                        </button>
                        <buttontype="object"
                            name="action_product_forecast_report"
                            attrs="{'invisible':[('type','!=','product')]}"
                            context="{'default_product_id':id}"
                            class="oe_stat_button"icon="fa-cubes">
                            <divclass="o_field_widgeto_stat_info">
                                <spanclass="o_stat_value">
                                    <fieldname="virtual_available"widget="statinfo"nolabel="1"class="mr4"/>
                                    <fieldname="uom_name"/>
                                </span>
                                <spanclass="o_stat_text">Forecasted</span>
                            </div>
                        </button>
                       <buttonstring="ProductMoves"
                            type="object"
                            name="action_view_stock_move_lines"
                            attrs="{'invisible':[('type','notin',['product','consu'])]}"
                            class="oe_stat_button"icon="fa-exchange"
                            groups="stock.group_stock_user"/>
                        <buttonname="action_view_orderpoints"type="object"
                            attrs="{'invisible':['|',('type','notin',['product','consu']),('nbr_reordering_rules','!=',1)]}"
                            class="oe_stat_button"icon="fa-refresh">
                            <divclass="o_field_widgeto_stat_infomr4">
                                <spanclass="o_stat_text">Min:</span>
                                <spanclass="o_stat_text">Max:</span>
                            </div>
                            <divclass="o_field_widgeto_stat_info">
                                <spanclass="o_stat_value"><fieldname="reordering_min_qty"/></span>
                                <spanclass="o_stat_value"><fieldname="reordering_max_qty"/></span>
                            </div>
                        </button>
                        <buttontype="object"
                            name="action_view_orderpoints"
                            attrs="{'invisible':['|',('type','!=','product'),('nbr_reordering_rules','==',1)]}"
                            class="oe_stat_button"icon="fa-refresh">
                            <fieldname="nbr_reordering_rules"widget="statinfo"/>
                        </button>
                        <buttonstring="Lot/SerialNumbers"type="object"
                            name="action_open_product_lot"
                            attrs="{'invisible':[('tracking','=','none')]}"
                            class="oe_stat_button"icon="fa-bars"groups="stock.group_production_lot"/>
                        <buttonstring="PutawayRules"type="object"
                            name="action_view_related_putaway_rules"
                            class="oe_stat_button"icon="fa-random"groups="stock.group_stock_multi_locations"
                            attrs="{'invisible':[('type','=','service')]}"
                            context="{'invisible_handle':True,'single_product':True}"/>
                    </div>
                    <xpathexpr="//button[@name='%(action_open_routes)d']"position="attributes">
                        <attributename="context">
                            {'default_product_id':id}
                        </attribute>
                    </xpath>
                </data>
            </field>
        </record>

        <!--viewusedforproduct.templateonly-->
        <recordmodel="ir.ui.view"id="product_template_form_view_procurement_button">
            <fieldname="name">product.template_procurement</field>
            <fieldname="model">product.template</field>
            <fieldname="groups_id"eval="[(4,ref('stock.group_stock_user'))]"/>
            <fieldname="inherit_id"ref="product.product_template_only_form_view"/>
            <fieldname="arch"type="xml">
                <data>
                    <headerposition="inside">
                        <buttonstring="UpdateQuantity"type="object"
                            groups="stock.group_stock_manager"
                            name="action_update_quantity_on_hand"
                            attrs="{'invisible':[('show_on_hand_qty_status_button','=',False)]}"/>
                        <buttonstring="Replenish"type="action"
                            name="%(action_product_replenish)d"
                            context="{'default_product_tmpl_id':id}"
                            groups="stock.group_stock_user"
                            attrs="{'invisible':[('show_on_hand_qty_status_button','=',False)]}"/>
                    </header>
                    <divname="button_box"position="inside">
                        <fieldname="show_on_hand_qty_status_button"invisible="1"/>
                        <buttontype="object"
                            name="action_open_quants"
                            attrs="{'invisible':[('show_on_hand_qty_status_button','=',False)]}"
                            class="oe_stat_button"icon="fa-cubes">
                            <divclass="o_field_widgeto_stat_info">
                                <spanclass="o_stat_value"widget="statinfo">
                                    <fieldname="qty_available"widget="statinfo"nolabel="1"class="mr4"/>
                                    <fieldname="uom_name"/>
                                </span>
                                <spanclass="o_stat_text">OnHand</span>
                            </div>
                        </button>
                        <buttontype="object"
                            name="action_product_tmpl_forecast_report"
                            attrs="{'invisible':[('show_on_hand_qty_status_button','=',False)]}"
                            context="{'default_product_tmpl_id':id}"
                            class="oe_stat_button"icon="fa-cubes">
                            <divclass="o_field_widgeto_stat_info">
                                <spanclass="o_stat_value">
                                    <fieldname="virtual_available"widget="statinfo"nolabel="1"class="mr4"/>
                                    <fieldname="uom_name"/>
                                </span>
                                <spanclass="o_stat_text">Forecasted</span>
                            </div>
                        </button>
                        <buttonstring="ProductMoves"type="object"
                            name="action_view_stock_move_lines"
                            attrs="{'invisible':[('type','notin',['product','consu'])]}"
                            class="oe_stat_button"icon="fa-exchange"
                            groups="stock.group_stock_user"/>
                        <buttontype="object"
                            name="action_view_orderpoints"
                            attrs="{'invisible':['|',('show_on_hand_qty_status_button','=',False),('nbr_reordering_rules','!=',1)]}"
                            class="oe_stat_button"icon="fa-refresh">
                            <divclass="o_field_widgeto_stat_infomr4">
                                <spanclass="o_stat_text">Min:</span>
                                <spanclass="o_stat_text">Max:</span>
                            </div>
                            <divclass="o_field_widgeto_stat_info">
                                <spanclass="o_stat_value"><fieldname="reordering_min_qty"/></span>
                                <spanclass="o_stat_value"><fieldname="reordering_max_qty"/></span>
                            </div>
                        </button>
                        <buttontype="object"
                            name="action_view_orderpoints"
                            attrs="{'invisible':['|',('show_on_hand_qty_status_button','=',False),('nbr_reordering_rules','==',1)]}"
                            class="oe_stat_button"
                            icon="fa-refresh">
                            <fieldname="nbr_reordering_rules"widget="statinfo"/>
                         </button>
                        <buttonstring="Lot/SerialNumbers"type="object"
                            name="action_open_product_lot"
                            attrs="{'invisible':[('tracking','=','none')]}"
                            class="oe_stat_button"icon="fa-bars"groups="stock.group_production_lot"/>
                        <buttonstring="PutawayRules"type="object"
                            name="action_view_related_putaway_rules"
                            class="oe_stat_button"icon="fa-random"groups="stock.group_stock_multi_locations"
                            attrs="{'invisible':[('type','=','service')]}"
                            context="{
                                'invisible_handle':True,
                                'single_product':product_variant_count==1,
                            }"/>
                    </div>

                    <!--changeattrsoffieldsaddedinview_template_property_form
                    torestrictthedisplayfortemplates-->
                    <xpathexpr="//group[@name='group_lots_and_weight']"position="attributes">
                        <attributename="attrs">{'invisible':[('type','notin',['product','consu'])]}</attribute>
                    </xpath>

                    <xpathexpr="//label[@for='weight']"position="before">
                        <fieldname="responsible_id"domain="[('share','=',False)]"/>
                    </xpath>
                </data>
            </field>
        </record>

    <recordid="product_template_action_product"model="ir.actions.act_window">
        <fieldname="name">Products</field>
        <fieldname="type">ir.actions.act_window</field>
        <fieldname="res_model">product.template</field>
        <fieldname="view_mode">kanban,tree,form</field>
        <fieldname="search_view_id"ref="product_template_search_form_view_stock"/>
        <fieldname="context">{"search_default_consumable":1,'default_type':'product'}</field>
        <fieldname="help"type="html">
            <pclass="o_view_nocontent_smiling_face">
                Noproductfound.Let'screateone!
            </p><p>
                Trackyourstockquantitiesbycreatingstorableproducts.
            </p>
        </field>
    </record>

    <recordid="stock_product_normal_action"model="ir.actions.act_window">
        <fieldname="name">ProductVariants</field>
        <fieldname="type">ir.actions.act_window</field>
        <fieldname="res_model">product.product</field>
        <fieldname="view_mode">tree,form,kanban</field>
        <fieldname="search_view_id"ref="stock_product_search_form_view"/>
    </record>

    <menuitemid="menu_product_variant_config_stock"name="Products"action="product_template_action_product"
        parent="stock.menu_stock_inventory_control"sequence="1"/>
    <menuitemid="product_product_menu"name="ProductVariants"action="stock_product_normal_action"
        parent="menu_stock_inventory_control"sequence="2"groups="product.group_product_variant"/>
    <menuitemid="menu_product_packagings"name="ProductPackagings"parent="stock.menu_product_in_config_stock"action="product.action_packaging_view"groups="product.group_stock_packaging"/>
    <menuitemid="menu_forecast_inventory"name="ForecastedInventory"parent="stock.menu_warehouse_report"sequence="101"action="stock.report_stock_quantity_action"/>

    </data>
</flectra>
