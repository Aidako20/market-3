<?xmlversion="1.0"encoding="utf-8"?>
<flectra>
    <recordid="view_stock_warehouse_orderpoint_kanban"model="ir.ui.view">
        <fieldname="name">stock.warehouse.orderpoint.kanban</field>
        <fieldname="model">stock.warehouse.orderpoint</field>
        <fieldname="arch"type="xml">
            <kanbanclass="o_kanban_mobile">
                <fieldname="name"/>
                <fieldname="product_id"/>
                <fieldname="trigger"/>
                <fieldname="product_min_qty"/>
                <fieldname="product_max_qty"/>
                <templates>
                    <tt-name="kanban-box">
                        <divt-attf-class="oe_kanban_global_click">
                            <divclass="o_kanban_record_top">
                                <divclass="o_kanban_record_headings">
                                    <strongclass="o_kanban_record_title"><tt-esc="record.name.value"/></strong>
                                </div>
                                <spanclass="badgebadge-pill"><strong>Minqty:</strong><tt-esc="record.product_min_qty.value"/></span>
                            </div>
                            <divclass="o_kanban_record_bottom">
                                <divclass="oe_kanban_bottom_left">
                                    <span><tt-esc="record.product_id.value"/></span>
                                </div>
                                <divclass="oe_kanban_bottom_right">
                                    <spanclass="badgebadge-pill"><strong>Maxqty:</strong><tt-esc="record.product_max_qty.value"/></span>
                                </div>
                            </div>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>

    <recordid="view_warehouse_orderpoint_tree_editable"model="ir.ui.view">
        <fieldname="name">stock.warehouse.orderpoint.tree.editable</field>
        <fieldname="model">stock.warehouse.orderpoint</field>
        <fieldname="arch"type="xml">
            <treestring="ReorderingRules"editable="bottom"js_class="stock_orderpoint_list"sample="1">
                <fieldname="active"invisible="1"/>
                <fieldname="allowed_route_ids"invisible="1"/>
                <fieldname="product_category_id"invisible="1"/>
                <fieldname="product_tmpl_id"invisible="1"/>
                <fieldname="product_id"attrs="{'readonly':[('product_id','!=',False)]}"invisible="context.get('default_product_id')"force_save="1"/>
                <fieldname="location_id"options="{'no_create':True}"groups="stock.group_stock_multi_locations"/>
                <fieldname="warehouse_id"options="{'no_create':True}"groups="stock.group_stock_multi_warehouses"optional="hide"/>
                <fieldname="qty_on_hand"force_save="1"/>
                <fieldname="qty_forecast"force_save="1"/>
                <fieldname="json_lead_days_popover"optional="show"nolabel="1"string="ForecastDescription"width="10px"widget="popover_widget"attrs="{'invisible':[('id','=',False)]}"/>
                <fieldname="route_id"options="{'no_create':True,'no_open':True}"/>
                <fieldname="trigger"optional="hide"/>
                <fieldname="group_id"optional="hide"groups="stock.group_adv_location"/>
                <fieldname="product_min_qty"optional="show"/>
                <fieldname="product_max_qty"optional="show"/>
                <fieldname="qty_multiple"optional="hide"/>
                <fieldname="qty_to_order"/>
                <fieldname="product_uom_name"string="UoM"groups="uom.group_uom"/>
                <fieldname="company_id"optional="hide"readonly="1"groups="base.group_multi_company"/>
                <buttonname="action_replenish"string="OrderOnce"type="object"class="o_replenish_buttons"icon="fa-truck"
                    attrs="{'invisible':[('qty_to_order','&lt;=',0.0)]}"/>
                <buttonname="action_replenish_auto"string="AutomateOrders"type="object"class="o_replenish_buttons"icon="fa-refresh"
                    attrs="{'invisible':['|',('qty_to_order','&lt;=',0.0),('trigger','=','auto')]}"/>
                <buttonname="%(action_orderpoint_snooze)d"string="Snooze"type="action"class="text-warning"icon="fa-bell-slash"
                    attrs="{'invisible':[('trigger','!=','manual')]}"context="{'default_orderpoint_ids':[id]}"/>
            </tree>
        </field>
    </record>

    <recordid="view_warehouse_orderpoint_tree_editable_config"model="ir.ui.view">
        <fieldname="name">stock.warehouse.orderpoint.tree.editable.config</field>
        <fieldname="model">stock.warehouse.orderpoint</field>
        <fieldname="arch"type="xml">
            <treestring="ReorderingRules"editable="bottom">
                <fieldname="active"invisible="1"/>
                <fieldname="allowed_route_ids"invisible="1"/>
                <fieldname="warehouse_id"invisible="1"/>
                <fieldname="product_tmpl_id"invisible="1"/>
                <fieldname="product_id"invisible="context.get('default_product_id')"force_save="1"/>
                <fieldname="location_id"options="{'no_create':True}"groups="stock.group_stock_multi_locations"/>
                <fieldname="route_id"optional="hide"/>
                <fieldname="trigger"optional="hide"/>
                <fieldname="group_id"optional="hide"groups="stock.group_adv_location"/>
                <fieldname="product_min_qty"optional="show"/>
                <fieldname="product_max_qty"optional="show"/>
                <fieldname="qty_multiple"optional="show"/>
                <fieldname="json_lead_days_popover"optional="show"nolabel="1"string="ForecastDescription"width="10px"widget="popover_widget"attrs="{'invisible':[('id','=',False)]}"/>
                <fieldname="product_uom_name"string="UoM"groups="uom.group_uom"/>
                <fieldname="company_id"optional="hide"readonly="1"groups="base.group_multi_company"/>
            </tree>
        </field>
    </record>

    <recordmodel="ir.ui.view"id="stock_reorder_report_search">
        <fieldname="name">stock.warehouse.orderpoint.reorder.search</field>
        <fieldname="model">stock.warehouse.orderpoint</field>
        <fieldname="arch"type="xml">
            <searchstring="ReplenishmentReportSearch">
                <fieldname="name"string="ReorderingRule"/>
                <fieldname="product_id"/>
                <fieldname="trigger"/>
                <fieldname="product_category_id"/>
                <fieldname="group_id"groups="stock.group_adv_location"/>
                <fieldname="warehouse_id"groups="stock.group_stock_multi_warehouses"/>
                <fieldname="location_id"groups="stock.group_stock_multi_locations"/>
                <filterstring="ToReorder"name="filter_to_reorder"domain="[('qty_to_order','&gt;',0.0)]"/>
                <separator/>
                <filterstring="NotSnoozed"name="filter_not_snoozed"domain="['|',('snoozed_until','=',False),('snoozed_until','&lt;=',datetime.date.today().strftime('%Y-%m-%d'))]"/>
                <groupexpand="0"string="GroupBy">
                    <filterstring="Warehouse"name="groupby_warehouse"domain="[]" context="{'group_by':'warehouse_id'}"groups="stock.group_stock_multi_warehouses"/>
                    <filterstring="Location"name="groupby_location"domain="[]"context="{'group_by':'location_id'}"groups="stock.group_stock_multi_locations"/>
                    <filterstring="Product"name="groupby_product"domain="[]"context="{'group_by':'product_id'}"/>
                    <filterstring="Category"name="groupby_category"domain="[]"context="{'group_by':'product_category_id'}"/>
                </group>
            </search>
        </field>
    </record>


    <recordmodel="ir.ui.view"id="warehouse_orderpoint_search">
        <fieldname="name">stock.warehouse.orderpoint.search</field>
        <fieldname="model">stock.warehouse.orderpoint</field>
        <fieldname="arch"type="xml">
            <searchstring="ReorderingRulesSearch">
                <fieldname="name"string="ReorderingRule"/>
                <fieldname="product_id"/>
                <fieldname="trigger"/>
                <fieldname="group_id"groups="stock.group_adv_location"/>
                <fieldname="warehouse_id"groups="stock.group_stock_multi_warehouses"/>
                <fieldname="location_id"groups="stock.group_stock_multi_locations"/>
                <filterstring="Archived"name="inactive"domain="[('active','=',False)]"/>
                <groupexpand="0"string="GroupBy">
                    <filterstring="Warehouse"name="warehouse"domain="[]" context="{'group_by':'warehouse_id'}"groups="stock.group_stock_multi_warehouses"/>
                    <filterstring="Location"name="location"domain="[]"context="{'group_by':'location_id'}"groups="stock.group_stock_multi_locations"/>
                    <filterstring="Product"name="product"domain="[]"context="{'group_by':'product_id'}"/>
                </group>
            </search>
        </field>
    </record>

    <recordid="view_warehouse_orderpoint_form"model="ir.ui.view">
        <fieldname="name">stock.warehouse.orderpoint.form</field>
        <fieldname="model">stock.warehouse.orderpoint</field>
        <fieldname="arch"type="xml">
            <formstring="ReorderingRules">
                <divclass="alertalert-info"role="alert">
                    <astyle="cursor:pointer"class="alert-linko_form_uri"type="action"name="%(action_procurement_compute)d">Runthescheduler</a>manuallytotriggerthereorderingrulesrightnow.
                </div>
                <sheet>
                    <widgetname="web_ribbon"title="Archived"bg_color="bg-danger"attrs="{'invisible':[('active','=',True)]}"/>
                    <divclass="oe_title">
                        <h1>
                            <fieldname="name"/>
                        </h1>
                    </div>
                    <group>
                        <group>
                            <fieldname="active"invisible="1"/>
                            <fieldname="product_id"/>
                            <labelfor="product_min_qty"/>
                            <divclass="o_row">
                                <fieldname="product_min_qty"/>
                                <fieldname="product_uom_name"/>
                                <fieldname="json_lead_days_popover"widget="popover_widget"attrs="{'invisible':[('id','=',False)]}"/>
                            </div>
                            <labelfor="product_max_qty"/>
                            <divclass="o_row">
                                <fieldname="product_max_qty"/>
                                <fieldname="product_uom_name"/>
                            </div>
                            <fieldname="qty_multiple"string="QuantityMultiple"/>
                        </group>
                        <group>
                            <fieldname="allowed_location_ids"invisible="1"/>
                            <fieldname="warehouse_id"widget="selection"groups="stock.group_stock_multi_locations"/>
                            <fieldname="location_id"options="{'no_create':True}"groups="stock.group_stock_multi_locations"domain="[('id','in',allowed_location_ids)]"/>
                            <labelfor="group_id"groups="base.group_no_one"/>
                            <divgroups="base.group_no_one">
                                <fieldname="group_id"groups="stock.group_adv_location"/>
                            </div>
                            <fieldname="company_id"groups="base.group_multi_company"options="{'no_create':True}"/>
                        </group>
                    </group>
                </sheet>
            </form>
        </field>
    </record>

    <recordid="action_orderpoint_replenish"model="ir.actions.act_window">
        <fieldname="name">Replenishment</field>
        <fieldname="res_model">stock.warehouse.orderpoint</field>
        <fieldname="type">ir.actions.act_window</field>
        <fieldname="view_mode">tree</field>
        <fieldname="view_id"ref="view_warehouse_orderpoint_tree_editable"/>
        <fieldname="search_view_id"ref="stock_reorder_report_search"/>
        <fieldname="help"type="html">
          <pclass="o_view_nocontent_replenishment">
            Youaregood,noreplenishmenttoperform!
          </p><p>
            You'llfindheresmartreplenishmentpropositionsbasedoninventoryforecasts.
            Choosethequantitytobuyormanufactureandlaunchordersinaclick.
            Tosavetimeinthefuture,settherulesas"automated".
          </p>
        </field>
    </record>

    <recordid="action_orderpoint"model="ir.actions.act_window">
        <fieldname="name">ReorderingRules</field>
        <fieldname="res_model">stock.warehouse.orderpoint</field>
        <fieldname="type">ir.actions.act_window</field>
        <fieldname="view_mode">tree,kanban,form</field>
        <fieldname="view_id"ref="view_warehouse_orderpoint_tree_editable_config"/>
        <fieldname="search_view_id"ref="warehouse_orderpoint_search"/>
        <fieldname="context">{'search_default_trigger':'auto'}</field>
        <fieldname="help"type="html">
          <pclass="o_view_nocontent_smiling_face">
            Noreorderingrulefound
          </p><p>
            DefineaminimumstockrulesothatFlectracreatesautomaticallyrequestsforquotationsorconfirmedmanufacturingorderstoresupplyyourstock.
          </p>
        </field>
    </record>

    <recordmodel="ir.actions.server"id="action_replenishment">
        <fieldname="name">Replenishment</field>
        <fieldname="model_id"ref="model_stock_warehouse_orderpoint"/>
        <fieldname="state">code</field>
        <fieldname="code">
            action=model.with_context(
                search_default_trigger='manual',
                search_default_filter_to_reorder=True,
                search_default_filter_not_snoozed=True,
                default_trigger='manual'
            ).action_open_orderpoints()
        </field>
    </record>


    <menuitem
        id="menu_reordering_rules_replenish"
        action="action_replenishment"
        name="Replenishment"parent="menu_stock_warehouse_mgmt"sequence="10"
        groups="stock.group_stock_manager"/>
    <menuitem
        id="menu_reordering_rules_config"
        action="action_orderpoint"
        name="ReorderingRules"parent="menu_product_in_config_stock"sequence="10"/>
</flectra>
