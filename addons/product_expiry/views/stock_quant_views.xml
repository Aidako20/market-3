<?xmlversion="1.0"encoding='UTF-8'?>
<flectra>
        <recordid="view_quant_form_expiry"model="ir.ui.view">
            <fieldname="name">stock.quant.inherit.form</field>
            <fieldname="model">stock.quant</field>
            <fieldname="inherit_id"ref="stock.view_stock_quant_form"/>
            <fieldname="arch"type="xml">
                <xpathexpr="//field[@name='lot_id']"position="after">
                    <fieldname="removal_date"/>
                </xpath>
            </field>
        </record>

    <recordid="view_stock_quant_tree_expiry"model="ir.ui.view">
        <fieldname="name">stock.quant.inherit.form</field>
        <fieldname="model">stock.quant</field>
        <fieldname="inherit_id"ref="stock.view_stock_quant_tree"/>
        <fieldname="arch"type="xml">
            <xpathexpr="//tree"position="attributes">
                <attributename="decoration-danger">
                    removal_date&lt;current_dateorquantity&lt;0
                </attribute>
            </xpath>
            <xpathexpr="//field[@name='quantity']"position="after">
                <fieldname="removal_date"/>
            </xpath>
        </field>
    </record>

    <recordid="view_stock_quant_tree_editable_expiry"model="ir.ui.view">
        <fieldname="name">stock.quant.inherit.form</field>
        <fieldname="model">stock.quant</field>
        <fieldname="inherit_id"ref="stock.view_stock_quant_tree_editable"/>
        <fieldname="arch"type="xml">
            <xpathexpr="//field[@name='inventory_quantity']"position="before">
                <fieldname="use_expiration_date"invisible="1"/>
                <fieldname="removal_date"optional="show"
                    invisible="context.get('hide_removal_date')"attrs="{'readonly':['|',('tracking','=','none'),('use_expiration_date','=',False)]}"/>
            </xpath>
        </field>
    </record>

    <recordid="quant_search_view_inherit_product_expiry"model="ir.ui.view">
        <fieldname="name">stock.quant.search.inherit</field>
        <fieldname="model">stock.quant</field>
        <fieldname="inherit_id"ref="stock.quant_search_view"/>
        <fieldname="arch"type="xml">
            <xpathexpr="//filter[@name='reserved']"position="after">
                <separator/>
                <filterstring="ExpirationAlerts"name="expiration_alerts"
                    domain="[('lot_id.alert_date','&lt;=',context_today().strftime('%Y-%m-%d'))]"/>
            </xpath>
        </field>
     </record>
</flectra>
