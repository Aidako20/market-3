<?xmlversion="1.0"encoding="utf-8"?>
<flectra>
    <datanoupdate="1">
        <!--====InvoiceDemo1withattachment====-->
        <recordid="demo_invoice_1"model="account.move">
            <fieldname="move_type">out_invoice</field>
            <fieldname="partner_id"ref="base.res_partner_12"/>
            <fieldname="invoice_user_id"ref="base.user_demo"/>
            <fieldname="invoice_payment_term_id"ref="account.account_payment_term_end_following_month"/>
            <fieldname="invoice_date"eval="time.strftime('%Y-%m')+'-01'"/>
            <fieldname="invoice_line_ids"eval="[
                (0,0,{'product_id':ref('product.consu_delivery_02'),'quantity':5}),
                (0,0,{'product_id':ref('product.consu_delivery_03'),'quantity':5}),
            ]"/>
        </record>

        <!--====InvoiceDemo2====-->
        <recordid="demo_invoice_2"model="account.move">
            <fieldname="move_type">out_invoice</field>
            <fieldname="partner_id"ref="base.res_partner_2"/>
            <fieldname="invoice_user_id"eval="False"/>
            <fieldname="invoice_date"eval="time.strftime('%Y-%m')+'-08'"/>
            <fieldname="invoice_line_ids"eval="[
                (0,0,{'product_id':ref('product.consu_delivery_03'),'quantity':5}),
                (0,0,{'product_id':ref('product.consu_delivery_01'),'quantity':20}),
            ]"/>
        </record>

        <!--====InvoiceDemo3====-->
        <recordid="demo_invoice_3"model="account.move">
            <fieldname="move_type">out_invoice</field>
            <fieldname="partner_id"ref="base.res_partner_2"/>
            <fieldname="invoice_user_id"eval="False"/>
            <fieldname="invoice_date"eval="time.strftime('%Y-%m')+'-08'"/>
            <fieldname="invoice_line_ids"eval="[
                (0,0,{'product_id':ref('product.consu_delivery_01'),'quantity':5}),
                (0,0,{'product_id':ref('product.consu_delivery_03'),'quantity':5}),
            ]"/>
        </record>

        <!--====InvoiceDemo4-Createaninvoicethatwillgenerateafollowup====-->
        <recordid="demo_invoice_followup"model="account.move">
            <fieldname="move_type">out_invoice</field>
            <fieldname="partner_id"ref="base.res_partner_2"/>
            <fieldname="invoice_user_id"ref="base.user_demo"/>
            <fieldname="invoice_payment_term_id"ref="account.account_payment_term_immediate"/>

            <fieldname="invoice_date"eval="(datetime.today()+timedelta(days=-15)).strftime('%Y-%m-%d')"/>
            <fieldname="invoice_line_ids"eval="[
                (0,0,{'product_id':ref('product.consu_delivery_02'),'quantity':5}),
                (0,0,{'product_id':ref('product.consu_delivery_03'),'quantity':5}),
            ]"/>
        </record>

        <!--====InvoiceDemo5-DraftVendorBill====-->
        <recordid="demo_invoice_5"model="account.move">
            <fieldname="move_type">in_invoice</field>
            <fieldname="partner_id"ref="base.res_partner_12"/>
            <fieldname="invoice_user_id"ref="base.user_demo"/>
            <fieldname="invoice_payment_term_id"ref="account.account_payment_term_end_following_month"/>
            <fieldname="invoice_date"eval="time.strftime('%Y-%m')+'-01'"/>
            <fieldname="invoice_line_ids"eval="[
                (0,0,{'product_id':ref('product.product_delivery_01'),'price_unit':10.0,'quantity':1}),
                (0,0,{'product_id':ref('product.product_order_01'),'price_unit':4.0,'quantity':5}),
            ]"/>
        </record>

        <!--====InvoiceDemo6-DraftVendorBillforOCR====-->

        <recordid="demo_invoice_extract"model="account.move"context="{'default_move_type':'in_invoice'}">
            <fieldname="move_type">in_invoice</field>
            <fieldname="invoice_user_id"ref="base.user_demo"/>
        </record>

        <!--====InvoiceDemo7-Postedvendorbill====-->
        <recordid="demo_invoice_equipment_purchase"model="account.move">
            <fieldname="move_type">in_invoice</field>
            <fieldname="ref">INV/2018/0057</field>
            <fieldname="partner_id"ref="base.res_partner_12"/>
            <fieldname="invoice_user_id"eval="False"/>
            <fieldname="invoice_date">2018-09-17</field>
            <fieldname="invoice_line_ids"eval="[
                (0,0,{'name':'RedeemReferenceNumber:PO02529','quantity':1,'price_unit':541.10})
            ]"/>
        </record>

        <!--====Postinvoices====-->
        <!--Ensureeverydetailrelatedtothepartnerisset(fiscalposition,paymentterms,bank,...)-->
        <functionmodel="account.move"name="_onchange_partner_id">
            <valueeval="[ref('demo_invoice_1')]"/>
        </function>
        <functionmodel="account.move"name="_onchange_partner_id">
            <valueeval="[ref('demo_invoice_2')]"/>
        </function>
        <functionmodel="account.move"name="_onchange_partner_id">
            <valueeval="[ref('demo_invoice_3')]"/>
        </function>
        <functionmodel="account.move"name="_onchange_partner_id">
            <valueeval="[ref('demo_invoice_equipment_purchase')]"/>
        </function>

        <!--Ensurethelinesareconsistentwiththeproducts(taxes,price,name)-->
        <!--check_move_validity=Falsebecausethedynamiclinesarecomputedafter,itischeckedlateratthepostfunction-->
        <functionmodel="account.move.line"name="_onchange_product_id"context="{'check_move_validity':False}">
            <valuemodel="account.move.line"eval="obj().search([('move_id','in',[
                ref('demo_invoice_1'),ref('demo_invoice_2'),ref('demo_invoice_3'),
                ref('demo_invoice_followup'),ref('demo_invoice_equipment_purchase'),
            ])]).ids"/>
        </function>

        <!--Recomputethetaxesandreceivablelinesaftertheonchangeexecutedabove-->
        <functionmodel="account.move"name="_recompute_dynamic_lines"context="{'check_move_validity':False}">
            <valueeval="[
                ref('demo_invoice_1'),ref('demo_invoice_2'),ref('demo_invoice_3'),
                ref('demo_invoice_followup'),ref('demo_invoice_equipment_purchase'),
            ]"/>
            <valuename="recompute_all_taxes"eval="True"/>
            <valuename="recompute_tax_base_amount"eval="True"/>
        </function>

        <functionmodel="account.move"name="action_post">
            <valueeval="[
                ref('demo_invoice_1'),ref('demo_invoice_2'),ref('demo_invoice_3'),
                ref('demo_invoice_followup'),ref('demo_invoice_equipment_purchase'),
            ]"/>
        </function>

        <!--====Createattachmentsforpostedinvoices====-->
        <recordid="ir_attachment_in_invoice_1"model="ir.attachment">
            <fieldname="type">binary</field>
            <fieldname="datas"type="base64"file="l10n_generic_coa/static/src/demo/in_invoice_yourcompany_demo_1.pdf"/>
            <fieldname="name">in_invoice_yourcompany_demo.pdf</field>
            <fieldname="res_model">account.move</field>
            <fieldname="res_id"ref="demo_invoice_extract"/>
        </record>

        <recordid="demo_invoice_extract"model="account.move">
            <fieldname="message_main_attachment_id"ref="ir_attachment_in_invoice_1"/>
        </record>

        <recordid="mail_message_in_invoice_1"model="mail.message">
            <fieldname="model">account.move</field>
            <fieldname="res_id"ref="l10n_generic_coa.demo_invoice_extract"/>
            <fieldname="body">VendorBillattachment</field>
            <fieldname="message_type">comment</field>
            <fieldname="author_id"ref="base.partner_demo"/>
            <fieldname="attachment_ids"eval="[(6,0,[ref('ir_attachment_in_invoice_1')])]"/>
        </record>

        <recordid="ir_attachment_in_invoice_2"model="ir.attachment">
            <fieldname="type">binary</field>
            <fieldname="datas"type="base64"file="l10n_generic_coa/static/src/demo/in_invoice_yourcompany_demo_2.pdf"/>
            <fieldname="name">in_invoice_yourcompany_demo.pdf</field>
            <fieldname="res_model">account.move</field>
            <fieldname="res_id"ref="demo_invoice_equipment_purchase"/>
        </record>

        <recordid="demo_invoice_equipment_purchase"model="account.move">
            <fieldname="message_main_attachment_id"ref="ir_attachment_in_invoice_2"/>
        </record>

        <recordid="mail_message_in_invoice_2"model="mail.message">
            <fieldname="model">account.move</field>
            <fieldname="res_id"ref="l10n_generic_coa.demo_invoice_equipment_purchase"/>
            <fieldname="body">VendorBillattachment</field>
            <fieldname="message_type">comment</field>
            <fieldname="author_id"ref="base.partner_demo"/>
            <fieldname="attachment_ids"eval="[(6,0,[ref('ir_attachment_in_invoice_2')])]"/>
        </record>

        <recordid="invoice_activity_1"model="mail.activity">
            <fieldname="res_id"ref="l10n_generic_coa.demo_invoice_3"/>
            <fieldname="res_model_id"ref="account.model_account_move"/>
            <fieldname="activity_type_id"ref="mail.mail_activity_data_todo"/>
            <fieldname="date_deadline"eval="(DateTime.today()+relativedelta(days=5)).strftime('%Y-%m-%d%H:%M')"/>
            <fieldname="summary">Follow-uponpayment</field>
            <fieldname="create_uid"ref="base.user_admin"/>
            <fieldname="user_id"ref="base.user_admin"/>
        </record>
        <recordid="invoice_activity_2"model="mail.activity">
            <fieldname="res_id"ref="l10n_generic_coa.demo_invoice_2"/>
            <fieldname="res_model_id"ref="account.model_account_move"/>
            <fieldname="activity_type_id"ref="mail.mail_activity_data_call"/>
            <fieldname="date_deadline"eval="DateTime.today().strftime('%Y-%m-%d%H:%M')"/>
            <fieldname="create_uid"ref="base.user_admin"/>
            <fieldname="user_id"ref="base.user_admin"/>
        </record>
        <recordid="invoice_activity_3"model="mail.activity">
            <fieldname="res_id"ref="l10n_generic_coa.demo_invoice_1"/>
            <fieldname="res_model_id"ref="account.model_account_move"/>
            <fieldname="activity_type_id"ref="mail.mail_activity_data_todo"/>
            <fieldname="date_deadline"eval="(DateTime.today()+relativedelta(days=5)).strftime('%Y-%m-%d%H:%M')"/>
            <fieldname="summary">Includeupsell</field>
            <fieldname="create_uid"ref="base.user_admin"/>
            <fieldname="user_id"ref="base.user_admin"/>
        </record>
        <recordid="invoice_activity_4"model="mail.activity">
            <fieldname="res_id"ref="l10n_generic_coa.demo_invoice_extract"/>
            <fieldname="res_model_id"ref="account.model_account_move"/>
            <fieldname="activity_type_id"ref="mail.mail_activity_data_todo"/>
            <fieldname="date_deadline"eval="(DateTime.today()+relativedelta(days=5)).strftime('%Y-%m-%d%H:%M')"/>
            <fieldname="summary">Updateaddress</field>
            <fieldname="create_uid"ref="base.user_admin"/>
            <fieldname="user_id"ref="base.user_admin"/>
        </record>

    </data>
</flectra>
