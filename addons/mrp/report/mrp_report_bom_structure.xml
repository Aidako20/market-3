<?xmlversion="1.0"encoding="UTF-8"?>
<flectra>
    <templateid="report_mrp_bom">
        <divclass="containero_mrp_bom_report_page">
            <tt-if="data.get('components')ordata.get('lines')">
                <divclass="row">
                    <divclass="col-lg-12">
                        <h1style="display:inline;">BoMStructure</h1>
                        <h1style="display:inline;"t-if="data['report_structure']!='bom_structure'"class="o_mrp_prod_cost">&amp;Cost</h1>
                        <h3>
                            <ahref="#"t-if="data['report_type']=='html'"t-att-data-res-id="data['product'].id"t-att-data-model="data['product']._name"class="o_mrp_bom_action">
                                <tt-esc="data['bom_prod_name']"/>
                            </a>
                            <tt-else=""t-esc="data['bom_prod_name']"/>
                        </h3>
                        <h6t-if="data['bom'].code">Reference:<tt-esc="data['bom'].code"/></h6>
                    </div>
                </div>
                <tt-set="currency"t-value="data['currency']"/>
                <divclass="row">
                    <divclass="col-lg-12">
                        <divclass="mt16">
                            <tablewidth="100%"class="o_mrp_bom_expandable">
                                <thead>
                                    <tr>
                                        <th>Product</th>
                                        <thname="th_mrp_bom_h">BoM</th>
                                        <thclass="text-right">Quantity</th>
                                        <thclass="text-left"groups="uom.group_uom">UnitofMeasure</th>
                                        <tht-if="data['report_structure']!='bom_structure'"class="o_mrp_prod_costtext-right"title="Thisisthecostdefinedontheproduct.">ProductCost</th>
                                        <tht-if="data['report_structure']!='bom_structure'"class="o_mrp_bom_costtext-right"title="ThisisthecostbasedontheBoMoftheproduct.Itiscomputedbysummingthecostsofthecomponentsandoperationsneededtobuildtheproduct.">BoMCost</th>
                                        <tht-if="data['report_type']=='html'anddata['has_attachments']"class="o_mrp_has_attachments"title="Filesattachedtotheproduct">Attachments</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>
                                            <span><ahref="#"t-if="data['report_type']=='html'"t-att-data-res-id="data['product'].id"t-att-data-model="'product.product'"class="o_mrp_bom_action"><tt-esc="data['bom_prod_name']"/></a><tt-else=""t-esc="data['bom_prod_name']"/></span>
                                        </td>
                                        <tdname="td_mrp_bom">
                                            <div><ahref="#"t-if="data['report_type']=='html'"t-att-data-res-id="data['bom'].id"t-att-data-model="'mrp.bom'"class="o_mrp_bom_action"><tt-esc="data['code']"/></a><tt-else=""t-esc="data['code']"/></div>
                                        </td>
                                        <tdclass="text-right"><span><tt-esc="data['bom_qty']"t-options='{"widget":"float","decimal_precision":"ProductUnitofMeasure"}'/></span></td>
                                        <tdgroups="uom.group_uom"><span><tt-esc="data['bom'].product_uom_id.name"/></span></td>
                                        <tdt-if="data['report_structure']!='bom_structure'"class="o_mrp_prod_costtext-right">
                                            <span><tt-esc="data['price']"t-options='{"widget":"monetary","display_currency":currency}'/></span>
                                        </td>
                                        <tdt-if="data['report_structure']!='bom_structure'"class="o_mrp_bom_costtext-right">
                                            <span><tt-esc="data['total']"t-options='{"widget":"monetary","display_currency":currency}'/></span>
                                        </td>
                                        <tdt-if="data['report_type']=='html'">
                                            <span>
                                                <tt-if="data['attachments']">
                                                    <ahref="#"role="button"t-att-data-res-id="data['attachments'].ids"t-att-data-model="'mrp.document'"class="o_mrp_show_attachment_actionfafa-fwo_button_iconfa-files-o"/>
                                                </t>
                                            </span>
                                        </td>
                                    </tr>
                                    <tt-if="data['report_type']=='html'"t-call="mrp.report_mrp_bom_line"/>
                                    <tt-if="data['report_type']=='pdf'"t-call="mrp.report_mrp_bom_pdf_line"/>
                                </tbody>
                                <tfoot>
                                    <tr>
                                        <td></td>
                                        <tdname="td_mrp_bom_f"></td>
                                        <tdt-if="data['report_structure']!='bom_structure'"class="text-righto_mrp_prod_cost"><span><strong>UnitCost</strong></span></td>
                                        <tdgroups="uom.group_uom"></td>
                                        <tdt-if="data['report_structure']!='bom_structure'"class="o_mrp_prod_costtext-right">
                                            <span><tt-esc="data['price']/data['bom_qty']"t-options='{"widget":"monetary","display_currency":currency}'/></span>
                                        </td>
                                        <tdt-if="data['report_structure']!='bom_structure'"class="o_mrp_bom_costtext-right">
                                            <span><tt-esc="data['total']/data['bom_qty']"t-options='{"widget":"monetary","display_currency":currency}'/></span>
                                        </td>
                                    </tr>
                                </tfoot>
                            </table>
                        </div>
                    </div>
                </div>
            </t>
            <tt-else="">
                <h1class="text-center">Nodataavailable.</h1>
            </t>
        </div>
    </template>

    <templateid="report_mrp_bom_line">
        <tt-set="currency"t-value="data['currency']"/>
        <tt-foreach="data['components']"t-as="l">
            <tt-set="space_td"t-value="'margin-left:'+str(l['level']*20)+'px;'"/>
            <trclass="o_mrp_bom_report_line"t-att-data-id="l['child_bom']"t-att-parent_id="l['parent_id']"t-att-data-line="l['line_id']"t-att-data-product_id="l['prod_id']"t-att-data-qty="l['prod_qty']"t-att-data-level="l['level']">
                <td>
                    <divt-att-style="space_td">
                        <tt-if="l['child_bom']">
                            <divt-att-data-function="'get_bom'"class="o_mrp_bom_unfoldablefafa-fwfa-caret-right"style="display:inline-block;"role="img"aria-label="Unfold"title="Unfold"/>
                        </t>
                        <divt-att-class="Noneifl['child_bom']else'o_mrp_bom_no_fold'"style="display:inline-block;">
                            <ahref="#"t-att-data-res-id="l['prod_id']"t-att-data-model="'product.product'"class="o_mrp_bom_action"><tt-esc="l['prod_name']"/></a>
                        </div>
                        <tt-if="l['phantom_bom']">
                            <divclass="fafa-dropbox"title="ThisisaBoMoftypeKit!"role="img"aria-label="ThisisaBoMoftypeKit!"/>
                        </t>
                    </div>
                </td>
                <tdname="td_mrp_bom">
                    <div>
                        <ahref="#"t-att-data-res-id="l['child_bom']"t-att-data-model="'mrp.bom'"class="o_mrp_bom_action"><tt-esc="l['code']"/></a>
                  </div>
                </td>
                <tdclass="text-right"><span><tt-esc="l['prod_qty']"t-options='{"widget":"float","decimal_precision":"ProductUnitofMeasure"}'/></span></td>
                <tdgroups="uom.group_uom"><span><tt-esc="l['prod_uom']"/></span></td>
                <tdclass="o_mrp_prod_costtext-right">
                    <spant-esc="l['prod_cost']"t-options='{"widget":"monetary","display_currency":currency}'/>
                </td>
                <tdclass="o_mrp_bom_costtext-right">
                    <spant-esc="l['total']"t-options='{"widget":"monetary","display_currency":currency}'/>
                </td>
                <td>
                    <span>
                        <tt-if="l['attachments']">
                            <ahref="#"role="button"t-att-data-res-id="l['attachments'].ids"t-att-data-model="'mrp.document'"class="o_mrp_show_attachment_actionfafa-fwo_button_iconfa-files-o"/>
                        </t>
                    </span>
                </td>
            </tr>
        </t>
        <tt-if="data['operations']">
            <tt-set="space_td"t-value="'margin-left:'+str(data['level']*20)+'px;'"/>
            <trclass="o_mrp_bom_report_lineo_mrp_bom_cost"t-att-data-id="'operation-'+str(data['bom'].id)"t-att-data-bom-id="data['bom'].id"t-att-parent_id="data['bom'].id"t-att-data-qty="data['bom_qty']"t-att-data-level="data['level']">
                <tdname="td_opr">
                    <spant-att-style="space_td"/>
                    <spanclass="o_mrp_bom_unfoldablefafa-fwfa-caret-right"t-att-data-function="'get_operations'"role="img"aria-label="Unfold"title="Unfold"/>
                    Operations
                </td>
                <td/>
                <tdclass="text-right">
                    <spant-esc="data['operations_time']"t-options='{"widget":"float_time"}'/>
                </td>
                <tdgroups="uom.group_uom"><span>Minutes</span></td>
                <tdclass="o_mrp_prod_cost">
                </td>
                <tdclass="o_mrp_bom_costtext-right">
                    <spant-esc="data['operations_cost']"t-options='{"widget":"monetary","display_currency":currency}'/>
                </td>
                <td/>
            </tr>
        </t>
    </template>

    <templateid="report_mrp_operation_line">
      <tt-set="currency"t-value="data['currency']"/>
      <tt-foreach="data['operations']"t-as="op">
          <tt-set="space_td"t-value="'margin-left:'+str(op['level']*20)+'px;'"/>
          <trclass="o_mrp_bom_report_lineo_mrp_bom_cost"t-att-parent_id="'operation-'+str(data['bom_id'])">
              <tdname="td_opr_line">
                  <spant-att-style="space_td"/>
                  <ahref="#"t-att-data-res-id="op['operation'].id"t-att-data-model="'mrp.routing.workcenter'"class="o_mrp_bom_action"><tt-esc="op['name']"/></a>
              </td>
              <td/>
              <tdclass="text-right">
                  <spant-esc="op['duration_expected']"t-options='{"widget":"float_time"}'/>
              </td>
              <tdgroups="uom.group_uom"><span>Minutes</span></td>
              <tdclass="o_mrp_prod_cost"></td>
              <tdclass="o_mrp_bom_costtext-right">
                  <spant-esc="op['total']"t-options='{"widget":"monetary","display_currency":currency}'/>
              </td>
              <td/>
          </tr>
      </t>
    </template>

    <templateid="report_mrp_bom_pdf">
        <tt-call="web.html_container">
            <tt-call="mrp.report_mrp_bom"/>
        </t>
    </template>

    <templateid="report_mrp_bom_pdf_line">
      <tt-set="currency"t-value="data['currency']"/>
      <tt-foreach="data['lines']"t-as="l">
          <tt-set="space_td"t-value="'margin-left:'+str(l['level']*20)+'px;'"/>
          <trt-if="data['report_structure']!='bom_structure'orl['type']!='operation'">
              <td>
                  <divt-att-style="space_td">
                    <div><tt-esc="l['name']"/></div>
                  </div>
              </td>
              <tdname="td_mrp_code">
                  <divt-if="l.get('code')"t-esc="l['code']"/>
              </td>
              <tdclass="text-right">
                  <span>
                      <tt-if="l['type']=='operation'"t-esc="l['quantity']"t-options='{"widget":"float_time"}'/>
                      <tt-if="l['type']=='bom'"t-esc="l['quantity']"t-options='{"widget":"float","decimal_precision":"ProductUnitofMeasure"}'/>
                  </span>
              </td>
              <tdgroups="uom.group_uom"><span><tt-esc="l['uom']"/></span></td>
              <tdt-if="data['report_structure']!='bom_structure'"class="o_mrp_prod_costtext-right">
                  <spant-if="'prod_cost'inl"t-esc="l['prod_cost']"t-options='{"widget":"monetary","display_currency":currency}'/>
              </td>
              <tdt-if="data['report_structure']!='bom_structure'"class="o_mrp_bom_costtext-right">
                  <spant-esc="l['bom_cost']"t-options='{"widget":"monetary","display_currency":currency}'/>
              </td>
          </tr>
      </t>
    </template>

    <templateid="report_bom_structure">
        <tt-set="data_report_landscape"t-value="True"/>
        <tt-call="web.basic_layout">
            <tt-call-assets="mrp.assets_common"t-js="False"/>
            <tt-foreach="docs"t-as="data">
                <divclass="page">
                    <tt-call="mrp.report_mrp_bom"/>
                </div>
                <pstyle="page-break-before:always;"></p>
            </t>
        </t>
    </template>
</flectra>
