<?xmlversion="1.0"encoding="utf-8"?>
<flectra>
    <!-- Unbuildandscrapmenu-->

   <recordid="action_mrp_unbuild_moves"model="ir.actions.act_window">
        <fieldname="name">StockMoves</field>
        <fieldname="type">ir.actions.act_window</field>
        <fieldname="res_model">stock.move.line</field>
        <fieldname="view_mode">tree,form</field>
        <fieldname="domain">['|',('move_id.unbuild_id','=',active_id),('move_id.consume_unbuild_id','=',active_id)]</field>
        <fieldname="help"type="html">
            <pclass="o_view_nocontent_empty_folder">
                There'snoproductmoveyet
            </p><p>
                Thismenugivesyouthefulltraceabilityofinventoryoperationsonaspecificproduct.
                Youcanfilterontheproducttoseeallthepastmovementsfortheproduct.
            </p>
        </field>
    </record>

        <recordid="mrp_unbuild_search_view"model="ir.ui.view">
            <fieldname="name">mrp.unbuild.search</field>
            <fieldname="model">mrp.unbuild</field>
            <fieldname="arch"type="xml">
                <searchstring="Search">
                    <fieldname="product_id"/>
                    <fieldname="mo_id"/>
                    <groupexpand="0"string="Filters">
                        <filtername="draft"string="Draft"domain="[('state','=','draft')]"/>
                        <filtername="done"string="Done"domain="[('state','=','done')]"/>
                        <filterinvisible="1"string="LateActivities"name="activities_overdue"
                            domain="[('my_activity_date_deadline','&lt;',context_today().strftime('%Y-%m-%d'))]"
                            help="Showallrecordswhichhasnextactiondateisbeforetoday"/>
                        <filterinvisible="1"string="TodayActivities"name="activities_today"
                            domain="[('my_activity_date_deadline','=',context_today().strftime('%Y-%m-%d'))]"/>
                        <filterinvisible="1"string="FutureActivities"name="activities_upcoming_all"
                            domain="[('my_activity_date_deadline','&gt;',context_today().strftime('%Y-%m-%d'))]"/>
                    </group>
                    <groupexpand='0'string='Groupby...'>
                        <filterstring='Product'name="productgroup"context="{'group_by':'product_id'}"/>
                        <filterstring="ManufacturingOrder"name="mogroup"context="{'group_by':'mo_id'}"/>
                    </group>
               </search>
            </field>
        </record>

        <recordid="mrp_unbuild_kanban_view"model="ir.ui.view">
            <fieldname="name">mrp.unbuild.kanban</field>
            <fieldname="model">mrp.unbuild</field>
            <fieldname="arch"type="xml">
                <kanbanclass="o_kanban_mobile"sample="1">
                    <fieldname="name"/>
                    <fieldname="product_id"/>
                    <fieldname="product_qty"/>
                    <fieldname="product_uom_id"/>
                    <fieldname="state"/>
                    <fieldname="location_id"/>
                    <fieldname="activity_state"/>
                    <progressbarfield="activity_state"colors='{"planned":"success","today":"warning","overdue":"danger"}'/>
                    <templates>
                        <tt-name="kanban-box">
                            <divt-attf-class="oe_kanban_global_click">
                                <divclass="o_kanban_record_top">
                                    <divclass="o_kanban_record_headingsmt4">
                                        <strongclass="o_kanban_record_title"><span><fieldname="name"/></span></strong>
                                    </div>
                                    <strong><tt-esc="record.product_qty.value"/><small><tt-esc="record.product_uom_id.value"/></small></strong>
                                </div>
                                <divclass="row">
                                    <divclass="col-8text-muted">
                                        <span><tt-esc="record.product_id.value"/></span>
                                    </div>
                                    <divclass="col-4">
                                        <spanclass="float-righttext-right">
                                            <fieldname="state"widget="label_selection"options="{'classes':{'draft':'default','done':'success'}}"readonly="1"/>
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </t>
                    </templates>
                </kanban>
            </field>
        </record>

        <recordid="mrp_unbuild_form_view"model="ir.ui.view">
            <fieldname="name">mrp.unbuild.form</field>
            <fieldname="model">mrp.unbuild</field>
            <fieldname="arch"type="xml">
                <formstring="UnbuildOrders">
                    <header>
                        <buttonname="action_validate"string="Unbuild"type="object"states="draft"class="oe_highlight"/>
                        <fieldname="state"widget="statusbar"statusbar_visible="draft,done"/>
                    </header>
                    <sheet>
                        <divclass="oe_button_box"name="button_box">
                            <buttonclass="oe_stat_button"name="%(action_mrp_unbuild_moves)d"
                                    string="ProductMoves"type="action"icon="fa-exchange"states="done"/>
                        </div>
                        <divclass="oe_title">
                            <h1><fieldname="name"placeholder="UnbuildOrder"nolabel="1"/></h1>
                        </div>
                        <group>
                            <group>
                                <fieldname="product_id"attrs="{'readonly':['|',('mo_id','!=',False),('state','=','done')]}"force_save="1"/>
                                <fieldname="mo_bom_id"invisible="1"/>
                                <fieldname="bom_id"attrs="{'required':[('mo_id','=',False)],'readonly':['|',('mo_id','!=',False),('state','=','done')],'invisible':[('mo_id','!=',False),('mo_bom_id','=',False)]}"force_save="1"/>
                                <labelfor="product_qty"/>
                                <divclass="o_row">
                                    <fieldname="product_qty"attrs="{'readonly':['|',('has_tracking','=','serial'),('state','=','done')]}"/>
                                    <fieldname="product_uom_id"options="{'no_open':True,'no_create':True}"groups="uom.group_uom"attrs="{'readonly':['|',('mo_id','!=',False),('state','=','done')]}"force_save="1"/>
                                </div>
                            </group>
                            <group>
                                <fieldname="mo_id"/>
                                <fieldname="location_id"options="{'no_create':True}"groups="stock.group_stock_multi_locations"/>
                                <fieldname="location_dest_id"options="{'no_create':True}"groups="stock.group_stock_multi_locations"/>
                                <fieldname="has_tracking"invisible="1"/>
                                <fieldname="allowed_mo_ids"invisible="1"/>
                                <fieldname="lot_id"attrs="{'invisible':[('has_tracking','=','none')],'required':[('has_tracking','!=','none')]}"groups="stock.group_production_lot"/>
                                <fieldname="company_id"groups="base.group_multi_company"/>
                            </group>
                        </group>
                    </sheet>
                    <divclass="oe_chatter">
                        <fieldname="message_follower_ids"/>
                        <fieldname="activity_ids"/>
                        <fieldname="message_ids"/>
                    </div>
                </form>
            </field>
        </record>

        <!--simplifiedversionofunbuildformforunbuildbuttonviamanufacturingorder,
             expectsrequiredfieldstobefilledinvia'default_'values-->
        <recordid="mrp_unbuild_form_view_simplified"model="ir.ui.view">
            <fieldname="name">mrp.unbuild.form.simplified</field>
            <fieldname="model">mrp.unbuild</field>
            <fieldname="arch"type="xml">
                <formstring="UnbuildOrder">
                    <sheet>
                        <group>
                            <group>
                                <fieldname="state"invisible="1"/>
                                <fieldname="product_id"invisible="1"/>
                                <fieldname="bom_id"invisible="1"/>
                                <labelfor="product_qty"/>
                                <divclass="o_row">
                                    <fieldname="product_qty"attrs="{'readonly':[('has_tracking','=','serial')]}"/>
                                    <fieldname="product_uom_id"options="{'no_open':True,'no_create':True}"groups="uom.group_uom"attrs="{'readonly':[('mo_id','!=',False)]}"force_save="1"/>
                                </div>
                            </group>
                            <group>
                                <fieldname="mo_id"invisible="1"/>
                                <fieldname="location_id"options="{'no_create':True}"groups="stock.group_stock_multi_locations"/>
                                <fieldname="location_dest_id"options="{'no_create':True}"groups="stock.group_stock_multi_locations"/>
                                <fieldname="has_tracking"invisible="1"/>
                                <fieldname="allowed_mo_ids"invisible="1"/>
                                <fieldname="lot_id"attrs="{'invisible':[('has_tracking','=','none')],'required':[('has_tracking','!=','none')]}"groups="stock.group_production_lot"/>
                                <fieldname="company_id"groups="base.group_multi_company"readonly="1"/>
                            </group>
                        </group>
                    </sheet>
                    <footerclass="oe_edit_only">
                        <buttonname="action_validate"string="Unbuild"type="object"states="draft"class="oe_highlight"/>
                        <buttonstring="Discard"special="cancel"/>
                    </footer>
                </form>
            </field>
        </record>


        <recordid="mrp_unbuild_tree_view"model="ir.ui.view">
            <fieldname="name">mrp.unbuild.tree</field>
            <fieldname="model">mrp.unbuild</field>
            <fieldname="arch"type="xml">
                <treesample="1">
                    <fieldname="name"decoration-bf="1"/>
                    <fieldname="product_id"/>
                    <fieldname="bom_id"/>
                    <fieldname="mo_id"/>
                    <fieldname="lot_id"groups="stock.group_production_lot"/>
                    <fieldname="product_qty"/>
                    <fieldname="product_uom_id"groups="uom.group_uom"/>
                    <fieldname="location_id"options="{'no_create':True}"groups="stock.group_stock_multi_locations"/>
                    <fieldname="activity_exception_decoration"widget="activity_exception"/>
                    <fieldname="company_id"groups="base.group_multi_company"/>
                    <fieldname="state"widget='badge'decoration-success="state=='done'"decoration-info="state=='draft'"/>
                </tree>
            </field>
        </record>

    <recordmodel="ir.actions.act_window"id="mrp_unbuild">
        <fieldname="name">UnbuildOrders</field>
        <fieldname="type">ir.actions.act_window</field>
        <fieldname="res_model">mrp.unbuild</field>
        <fieldname="view_mode">tree,kanban,form</field>
        <fieldname="help"type="html">
          <pclass="o_view_nocontent_smiling_face">
            Nounbuildorderfound
          </p><p>
            Anunbuildorderisusedtobreakdownafinishedproductintoitscomponents.
          </p>
        </field>
    </record>

    <menuitemid="menu_mrp_unbuild"
          name="UnbuildOrders"
          parent="menu_mrp_manufacturing"
          action="mrp_unbuild"
          sequence="20"/>

</flectra>
