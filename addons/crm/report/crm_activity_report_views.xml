<?xmlversion="1.0"encoding="utf-8"?>
<flectra>

        <recordid="crm_activity_report_view_graph"model="ir.ui.view">
            <fieldname="name">crm.activity.report.graph</field>
            <fieldname="model">crm.activity.report</field>
            <fieldname="arch"type="xml">
                <graphstring="ActivitiesAnalysis"stacked="True"sample="1"disable_linking="1">
                    <fieldname="mail_activity_type_id"type="col"/>
                    <fieldname="date"interval="month"type="row"/>
                </graph>
            </field>
        </record>

        <recordid="crm_activity_report_view_pivot"model="ir.ui.view">
            <fieldname="name">crm.activity.report.pivot</field>
            <fieldname="model">crm.activity.report</field>
            <fieldname="arch"type="xml">
                <pivotstring="ActivitiesAnalysis"disable_linking="True"sample="1">
                    <fieldname="mail_activity_type_id"type="col"/>
                    <fieldname="date"interval="month"type="row"/>
                </pivot>
            </field>
        </record>

        <recordid="crm_activity_report_view_tree"model="ir.ui.view">
            <fieldname="name">crm.activity.report.tree</field>
            <fieldname="model">crm.activity.report</field>
            <fieldname="arch"type="xml">
                <treedefault_order="datedesc">
                    <fieldname="date"/>
                    <fieldname="author_id"/>
                    <fieldname="mail_activity_type_id"/>
                    <fieldname="body"/>
                    <fieldname="company_id"groups="base.group_multi_company"/>
                </tree>
            </field>
        </record>

        <recordid="crm_activity_report_view_search"model="ir.ui.view">
            <fieldname="name">crm.activity.report.search</field>
            <fieldname="model">crm.activity.report</field>
            <fieldname="arch"type="xml">
                <searchstring="ActivitiesAnalysis">
                    <fieldname="mail_activity_type_id"string="ActivityType"/>
                    <fieldname="lead_id"string="Opportunity"/>
                    <fieldname="user_id"string="Salesperson"/>
                    <fieldname="team_id"context="{'invisible_team':False}"/>
                    <fieldname="author_id"string="AssignedTo"/>
                    <separatorgroups="crm.group_use_lead"/>
                    <filterstring="Leads"name="lead"domain="[('lead_type','=','lead')]"help="Showonlylead"groups="crm.group_use_lead"/>
                    <filterstring="Opportunities"name="opportunity"domain="[('lead_type','=','opportunity')]"help="Showonlyopportunity"groups="crm.group_use_lead"/>
                    <separator/>
                    <filterstring="Won"name="won"domain="[('stage_id.is_won','=',True)]"/>
                    <separator/>
                    <filterstring="Trailing12months"name="completion_date"domain="[
                        ('date','>=',(datetime.datetime.combine(context_today()+relativedelta(days=-365),datetime.time(0,0,0)).to_utc()).strftime('%Y-%m-%d%H:%M:%S')),
                        ('date','&lt;=',(datetime.datetime.combine(context_today(),datetime.time(0,0,0)).to_utc()).strftime('%Y-%m-%d%H:%M:%S'))]"/>
                    <separator/>
                    <filtername="filter_date"date="date"/>
                    <separator/>
                    <filterstring="Archived"name="inactive"domain="[('active','=',False)]"/>
                    <groupexpand="1"string="GroupBy">
                        <filterstring="Activity"name="group_by_activity_type"context="{'group_by':'mail_activity_type_id'}"/>
                        <filterstring="Type"name="group_by_subtype"context="{'group_by':'subtype_id'}"/>
                        <filterstring="AssignedTo"name="group_by_author_id"context="{'group_by':'author_id'}"/>
                        <filterstring="CompletionDate"name="group_by_completion_date"context="{'group_by':'date:month'}"/>
                        <separator/>
                        <filterstring="Salesperson"name="group_by_user_id"context="{'group_by':'user_id'}"/>
                        <filterstring="SalesTeam"name="saleschannel"context="{'group_by':'team_id'}"/>
                        <filterstring="Stage"name="stage"context="{'group_by':'stage_id'}"/>
                        <filterstring="Company"name="company"context="{'group_by':'company_id'}"groups="base.group_multi_company"/>
                        <filterstring="CreationDate"name="group_by_lead_date_creation"context="{'group_by':'lead_create_date'}"/>
                        <filterstring="ExpectedClosing"name="group_by_date_deadline"context="{'group_by':'date_deadline'}"/>
                        <filterstring="ClosedDate"name="group_by_date_closed"context="{'group_by':'date_closed'}"/>
                    </group>
                </search>
            </field>
        </record>

       <recordid="crm_activity_report_action"model="ir.actions.act_window">
           <fieldname="name">PipelineActivities</field>
           <fieldname="res_model">crm.activity.report</field>
           <fieldname="view_mode">graph,pivot,tree</field>
           <fieldname="context">{
                'search_default_completion_date':1,
                'pivot_column_groupby':['subtype_id','mail_activity_type_id'],
                'pivot_row_groupby':['date:month'],
                'graph_mode':'bar',
                'graph_groupbys':['date:month','subtype_id'],
            }</field>
            <fieldname="domain">[]</field>
            <fieldname="help"type="html">
                <pclass="o_view_nocontent_smiling_face">
                    Nodatayet!
                </p><p>
                    Startschedulingactivitiesonyouropportunities
                </p>
            </field>
       </record>

       <menuitem
            id="crm_activity_report_menu"
            name="Activities"
            groups="sales_team.group_sale_manager"
            parent="crm_menu_report"
            action="crm_activity_report_action"
            sequence="3"/>

        <recordid="crm_activity_report_action_team"model="ir.actions.act_window">
            <fieldname="name">PipelineActivities</field>
            <fieldname="res_model">crm.activity.report</field>
            <fieldname="view_mode">graph,pivot,tree</field>
            <fieldname="context">{'search_default_team_id':active_id}</field>
            <fieldname="domain">[]</field>
            <fieldname="help"type="html">
                <pclass="o_view_nocontent_smiling_face">
                    Nodatayet!
                </p><p>
                    Startschedulingactivitiesonyouropportunities
                </p>
            </field>
        </record>

</flectra>
