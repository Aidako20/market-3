flectra.define('crm.tour_crm_rainbowman',function(require){
    "usestrict";

    vartour=require('web_tour.tour');

    tour.register('crm_rainbowman',{
        test:true,
        url:"/web",
    },[
        tour.stepUtils.showAppsMenuItem(),
        {
            trigger:".o_app[data-menu-xmlid='crm.crm_menu_root']",
            content:"opencrmapp",
        },{
            trigger:".o-kanban-button-new",
            content:"clickcreate",
        },{
            trigger:"input[name=name]",
            content:"completename",
            run:"textTestLead1",
        },{
            trigger:"div[name=expected_revenue]>input",
            content:"completeexpectedrevenue",
            run:"text999999997",
        },{
            trigger:"button.o_kanban_add",
            content:"createlead",
        },{
            trigger:".o_kanban_record.o_kanban_record_title:contains('TestLead1')",
            content:"movetowonstage",
            run:"drag_and_drop.o_opportunity_kanban.o_kanban_group:eq(3)"
        },{
            trigger:".o_reward_rainbow",
            extra_trigger:".o_reward_rainbow",
            run:function(){}//checkrainbowmanisproperlydisplayed
        },{
            trigger:".o-kanban-button-new",
            content:"createsecondlead",
        },{
            trigger:"input[name=name]",
            content:"completename",
            run:"textTestLead2",
        },{
            trigger:"div[name=expected_revenue]>input",
            content:"completeexpectedrevenue",
            run:"text999999998",
        },{
            trigger:"button.o_kanban_add",
            content:"createlead",
        },{
            trigger:".o_kanban_record.o_kanban_record_title:contains('TestLead2')",
            run:function(){}//waitfortherecordtobeproperlycreated
        },{
            //movefirsttestbacktonewstagetobeabletotestrainbowmanasecondtime
            trigger:".o_kanban_record.o_kanban_record_title:contains('TestLead1')",
            content:"movebacktonewstage",
            run:"drag_and_drop.o_opportunity_kanban.o_kanban_group:eq(0)"
        },{
            trigger:".o_kanban_record.o_kanban_record_title:contains('TestLead2')",
            content:"clickonsecondlead",
        },{
            trigger:".o_statusbar_statusbutton[data-value='4']",
            content:"moveleadtowonstage",
        },{
            trigger:".o_statusbar_statusbutton[data-value='1']",
            extra_trigger:".o_reward_rainbow",
            content:"moveleadtopreviousstage&rainbowmanappears",
        },{
            trigger:"button[name=action_set_won_rainbowman]",
            content:"clickbuttonmarkwon",
        },{
            trigger:".o_menu_brand",
            extra_trigger:".o_reward_rainbow",
            content:"lastrainbowmanappears",
        }
    ]);
});
