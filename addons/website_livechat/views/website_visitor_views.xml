<?xmlversion="1.0"encoding="utf-8"?>
<flectra><data>
    <recordid="website_visitor_livechat_session_action"model="ir.actions.act_window">
        <fieldname="name">Visitor'sSessions</field>
        <fieldname="res_model">mail.channel</field>
        <fieldname="view_mode">tree,form</field>
        <fieldname="view_id"ref="im_livechat.mail_channel_view_tree"/>
        <fieldname="domain">[('livechat_visitor_id','=',active_id),('channel_message_ids','!=',False)]</field>
        <fieldname="context">{
                'search_default_livechat_visitor_id':[active_id],
                'default_livechat_visitor_id':active_id,
            }</field>
    </record>

    <recordid="website_visitor_livechat_session_action_tree"model="ir.actions.act_window.view">
        <fieldname="sequence">1</field>
        <fieldname="view_mode">tree</field>
        <fieldname="view_id"ref="im_livechat.mail_channel_view_tree"/>
        <fieldname="act_window_id"ref="website_livechat.website_visitor_livechat_session_action"/>
    </record>

    <recordid="website_visitor_livechat_session_action_form"model="ir.actions.act_window.view">
        <fieldname="sequence">2</field>
        <fieldname="view_mode">form</field>
        <fieldname="view_id"ref="im_livechat.mail_channel_view_form"/>
        <fieldname="act_window_id"ref="website_livechat.website_visitor_livechat_session_action"/>
    </record>

    <!--websitevisitorviews-->
    <recordid="website_visitor_view_kanban"model="ir.ui.view">
        <fieldname="name">website.visitor.view.kanban.inherit.website.livechat</field>
        <fieldname="model">website.visitor</field>
        <fieldname="inherit_id"ref="website.website_visitor_view_kanban"/>
        <fieldname="arch"type="xml">
            <fieldname="page_ids"position="after">
                <fieldname="livechat_operator_id"/>
            </field>
            <xpathexpr="//div[hasclass('w_visitor_kanban_actions')]"position="before">
                <divt-if="record.livechat_operator_id.raw_value">
                    <spanclass="fafa-commentsmr-2"/>SpeakingWith<spanclass="font-weight-bold"><fieldname="livechat_operator_name"/></span>
                </div>
                <tt-else="">
                    <brattrs="{'invisible':['|',('livechat_operator_id','!=',False),('is_connected','=',False)]}"/>
                </t>
            </xpath>
            <xpathexpr="//div[hasclass('w_visitor_kanban_actions_ungrouped')]"position="before">
                <divclass="col">
                    <b>
                        <fieldname="livechat_operator_name"t-if="record.livechat_operator_id.raw_value"/>
                        <spant-else="">-</span>
                    </b>
                    <div>SpeakingWith</div>
                </div>
            </xpath>
            <xpathexpr="//div[hasclass('w_visitor_kanban_actions')]"position="inside">
                <buttonname="action_send_chat_request"type="object"
                        class="btnbtn-secondary"
                        attrs="{'invisible':['|',('livechat_operator_id','!=',False),('is_connected','=',False)]}">
                        Chat
                </button>
            </xpath>
            <xpathexpr="//div[hasclass('w_visitor_kanban_actions_ungrouped')]"position="inside">
                <buttonname="action_send_chat_request"type="object"
                        class="btnbtn-secondaryborder"
                        attrs="{'invisible':['|',('livechat_operator_id','!=',False),('is_connected','=',False)]}">
                        Chat
                </button>
            </xpath>
        </field>
    </record>

    <recordid="website_visitor_view_form"model="ir.ui.view">
        <fieldname="name">website.visitor.view.form.inherit.website.livechat</field>
        <fieldname="model">website.visitor</field>
        <fieldname="inherit_id"ref="website.website_visitor_view_form"/>
        <fieldname="arch"type="xml">
            <xpathexpr="//header"position="inside">
                <buttonname="action_send_chat_request"string="Sendchatrequest"type="object"class="oe_highlight"
                attrs="{'invisible':['|',('livechat_operator_id','!=',False),('is_connected','=',False)]}"/>
            </xpath>
            <xpathexpr="//group[@id='general_info']"position="before">
                <groupid="livechat_info">
                    <fieldname="livechat_operator_id"/>
                </group>
            </xpath>
            <xpathexpr="//div[hasclass('oe_button_box')]"position="inside">
                <buttonname="%(website_visitor_livechat_session_action)d"type="action"class="oe_stat_button"icon="fa-comment"
                        attrs="{'invisible':[('session_count','=',0)]}">
                    <fieldname="session_count"widget="statinfo"string="Sessions"/>
                </button>
            </xpath>
        </field>
    </record>

    <recordid="website_visitor_view_tree"model="ir.ui.view">
        <fieldname="name">website.visitor.view.tree.inherit.website.livechat</field>
        <fieldname="model">website.visitor</field>
        <fieldname="inherit_id"ref="website.website_visitor_view_tree"/>
        <fieldname="arch"type="xml">
            <xpathexpr="//field[@name='is_connected']"position="after">
                <fieldname="livechat_operator_id"/>
                <buttonname="action_send_chat_request"string="Sendchatrequest"type="object"icon="fa-comments"
                        attrs="{'invisible':['|',('livechat_operator_id','!=',False),('is_connected','=',False)]}"/>
            </xpath>
        </field>
    </record>

    <recordid="website_visitor_view_search"model="ir.ui.view">
        <fieldname="name">website.visitor.view.search.website.livechat</field>
        <fieldname="model">website.visitor</field>
        <fieldname="inherit_id"ref="website.website_visitor_view_search"/>
        <fieldname="arch"type="xml">
            <xpathexpr="//search"position="inside">
                <filterstring="Busy"name="in_conversation"domain="[('livechat_operator_id','!=',False)]"/>
                <filterstring="Available"name="not_in_conversation"domain="[('livechat_operator_id','=',False)]"/>
            </xpath>
        </field>
    </record>

    <recordid="website_livechat_send_chat_request_action_server"model="ir.actions.server">
        <fieldname="name">SendChatRequests</field>
        <fieldname="type">ir.actions.server</field>
        <fieldname="model_id"ref="model_website_visitor"/>
        <fieldname="binding_model_id"ref="model_website_visitor"/>
        <fieldname="binding_view_types">list</field>
        <fieldname="state">code</field>
        <fieldname="code">
            ifrecords:
                action=records.action_send_chat_request()
        </field>
    </record>

    <recordid="website.website_visitors_action"model="ir.actions.act_window">
        <fieldname="help"type="html">
          <pclass="o_view_nocontent_smiling_face">
              Waitforvisitorstocometoyourwebsitetoseetheirhistory.</p>
            <p>Interactwiththembysendingthemmessages.</p>
        </field>
    </record>

    <menuitem
        id="website_livechat_visitor_menu"
        name="Visitors"
        parent="im_livechat.menu_livechat_root"
        action="website.website_visitors_action"
        groups="im_livechat.im_livechat_group_user"
        sequence="15"/>
</data></flectra>
