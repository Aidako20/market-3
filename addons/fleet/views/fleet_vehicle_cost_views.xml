<?xmlversion="1.0"encoding="UTF-8"?>
<flectra>
    <recordid='fleet_vehicle_log_contract_view_form'model='ir.ui.view'>
        <fieldname="name">fleet.vehicle.log_contract.form</field>
        <fieldname="model">fleet.vehicle.log.contract</field>
        <fieldname="arch"type="xml">
            <formstring="Contractlogs">
                <header>
                    <buttonname="contract_open"states="futur"type="object"string="StartContract"class="oe_highlight"groups="fleet.fleet_group_manager"/>
                    <buttonname="contract_close"states="futur"type="object"string="Cancel"groups="fleet.fleet_group_manager"/>
                    <buttonname="contract_close"states="open,expired,futur"type="object"class="oe_highlight"string="CloseContract"groups="fleet.fleet_group_manager"/>
                    <buttonname="contract_draft"states="closed"type="object"string="ResetToDraft"groups="fleet.fleet_group_manager"/>
                    <fieldname="state"widget="statusbar"/>
                </header>
                <sheet>
                    <fieldname="active"invisible="1"/>
                    <widgetname="web_ribbon"title="Archived"bg_color="bg-danger"attrs="{'invisible':[('active','=',True)]}"/>
                    <fieldname="currency_id"invisible="1"/>
                    <divclass="oe_title">
                        <h1><fieldname="name"/></h1>
                    </div>
                    <groupcol="2">
                        <groupstring="ContractInformation">
                            <fieldname="user_id"/>
                            <fieldname="cost_subtype_id"/>
                            <fieldname="insurer_id"/>
                            <fieldname="ins_ref"/>
                        </group>
                        <groupstring="VehicleInformation">
                            <fieldname="vehicle_id"/>
                            <fieldname="purchaser_id"/>
                        </group>
                    </group>
                    <groupcol="2">
                        <group>
                            <fieldname="amount"string="ActivationCost"help="Costthatispaidonlyonceatthecreationofthecontract"widget="monetary"/>
                            <labelfor="cost_generated"/>
                            <divclass="o_row">
                                <fieldname="cost_generated"attrs="{'invisible':[('cost_frequency','=','no')]}"widget="monetary"/>
                                <fieldname="cost_frequency"/>
                            </div>
                        </group>
                        <group>
                            <fieldname="date"string="InvoiceDate"/>
                            <fieldname="start_date"/>
                            <fieldname="expiration_date"attrs="{'required':[('cost_frequency','!=','no')]}"/>
                        </group>
                    </group>
                    <groupstring="IncludedServices">
                        <fieldname="service_ids"widget="many2many_tags"nolabel="1"/>
                    </group>
                    <groupstring="TermsandConditions">
                        <fieldname="notes"nolabel="1"placeholder="Writehereallotherinformationrelativetothiscontract"/>
                    </group>
                </sheet>
                <divclass="oe_chatter">
                    <fieldname="message_follower_ids"/>
                    <fieldname="activity_ids"/>
                    <fieldname="message_ids"/>
                </div>
            </form>
        </field>
    </record>

    <recordid='fleet_vehicle_log_contract_view_tree'model='ir.ui.view'>
        <fieldname="name">fleet.vehicle.log.contract.tree</field>
        <fieldname="model">fleet.vehicle.log.contract</field>
        <fieldname="arch"type="xml">
            <treestring="Contractlogs"
                decoration-danger="days_left==0"
                decoration-muted="state=='closed'"
                default_order="expiration_date"
                sample="1">
                <fieldname="active"invisible="1"/>
                <fieldname="name"class="font-weight-bold"/>
                <fieldname="start_date"/>
                <fieldname="expiration_date"widget="remaining_days"/>
                <fieldname="days_left"invisible="1"/>
                <fieldname="vehicle_id"widget="many2one_avatar"/>
                <fieldname="insurer_id"/>
                <fieldname="purchaser_id"/>
                <fieldname="cost_generated"widget="monetary"/>
                <fieldname="currency_id"invisible="1"/>
                <fieldname="cost_frequency"/>
                <fieldname="state"widget="badge"decoration-info="state=='open'"decoration-danger="state=='expired'"/>
                <fieldname="activity_exception_decoration"widget="activity_exception"/>
            </tree>
        </field>
    </record>

    <recordid='fleet_vehicle_log_contract_view_kanban'model='ir.ui.view'>
        <fieldname="name">fleet.vehicle.log.contract.kanban</field>
        <fieldname="model">fleet.vehicle.log.contract</field>
        <fieldname="arch"type="xml">
            <kanbanclass="o_kanban_mobile"sample="1">
                <fieldname="activity_state"/>
                <progressbarfield="activity_state"colors='{"planned":"success","today":"warning","overdue":"danger"}'/>
                <templates>
                    <tt-name="kanban-box">
                        <divt-attf-class="oe_kanban_global_click">
                            <div>
                                <strong>
                                    <fieldname="vehicle_id"widget="res_partner_many2one"/>
                                    <spanclass="float-rightbadgebadge-secondary">
                                        <fieldname="state"/>
                                    </span>
                                </strong>
                            </div>
                            <div>
                                <fieldname="start_date"/>-<fieldname="expiration_date"/>
                            </div>
                            <div>
                                <fieldname="insurer_id"widget="res_partner_many2one"/>
                            </div>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>

    <recordid="fleet_vehicle_log_contract_view_graph"model="ir.ui.view">
       <fieldname="name">fleet.vehicle.log.contract.graph</field>
       <fieldname="model">fleet.vehicle.log.contract</field>
       <fieldname="arch"type="xml">
            <graphstring="ContractCostsPerMonth"type="bar"stacked="True"sample="1">
                <fieldname="date"type="row"/>
                <fieldname="vehicle_id"type="row"/>
                <fieldname="amount"type="measure"/>
            </graph>
        </field>
    </record>

    <recordid="fleet_vehicle_log_contract_view_search"model="ir.ui.view">
        <fieldname="name">fleet.vehicle.log.contract.search</field>
        <fieldname="model">fleet.vehicle.log.contract</field>
        <fieldname="arch"type="xml">
            <searchstring="VehiclesContracts">
                <fieldname="vehicle_id"string="Vehicle"filter_domain="[('vehicle_id.name','ilike',self)]"/>
                <fieldname="purchaser_id"string="Driver"filter_domain="[('purchaser_id','child_of',self)]"/>
                <fieldname="insurer_id"string="Vendor"filter_domain="[('insurer_id','child_of',self)]"/>
                <filterstring="InProgress"name="open"domain="[('state','=','open')]"/>
                <filterstring="Expired"name="expired"domain="[('state','=','expired')]"/>
                <separator/>
                <filterstring="Archived"name="inactive"domain="[('active','=',False)]"/>
                <separator/>
                <filterinvisible="1"string="LateActivities"name="activities_overdue"
                    domain="[('my_activity_date_deadline','&lt;',context_today().strftime('%Y-%m-%d'))]"
                    help="Showallrecordswhichhasnextactiondateisbeforetoday"/>
                <filterinvisible="1"string="TodayActivities"name="activities_today"
                    domain="[('my_activity_date_deadline','=',context_today().strftime('%Y-%m-%d'))]"/>
                <filterinvisible="1"string="FutureActivities"name="activities_upcoming_all"
                    domain="[('my_activity_date_deadline','&gt;',context_today().strftime('%Y-%m-%d'))]"/>
                <groupexpand="0"string="GroupBy">
                    <filterstring="Vehicle"name="vehicle"context="{'group_by':'vehicle_id'}"/>
                </group>
            </search>
        </field>
    </record>

    <recordid="fleet_vehicle_log_contract_view_activity"model="ir.ui.view">
        <fieldname="name">fleet.vehicle.log.contract.activity</field>
        <fieldname="model">fleet.vehicle.log.contract</field>
        <fieldname="arch"type="xml">
            <activitystring="VehiclesContracts">
                <fieldname="purchaser_id"/>
                <templates>
                    <divt-name="activity-box">
                        <imgt-att-src="activity_image('res.partner','image_128',record.purchaser_id.raw_value)"t-att-title="record.purchaser_id.value"t-att-alt="record.purchaser_id.value"/>
                        <div>
                            <fieldname="vehicle_id"display="full"/>
                        </div>
                    </div>
                </templates>
            </activity>
        </field>
    </record>

    <recordid='fleet_vehicle_log_contract_action'model='ir.actions.act_window'>
        <fieldname="name">Contracts</field>
        <fieldname="res_model">fleet.vehicle.log.contract</field>
        <fieldname="view_mode">tree,kanban,form,graph,activity</field>
        <fieldname="context">{'search_default_open':1}</field>
        <fieldname="help"type="html">
          <pclass="o_view_nocontent_smiling_face">
            Createanewcontract
          </p><p>
            Manageallyourcontracts(leasing,insurances,etc.)with
            theirrelatedservices,costs.Flectrawillautomaticallywarn
            youwhensomecontractshavetoberenewed.
          </p><p>
            Eachcontract(e.g.:leasing)mayincludeseveralservices
            (reparation,insurances,periodicmaintenance).
          </p>
        </field>
    </record>

    <menuitemaction="fleet_vehicle_log_contract_action"parent="fleet_vehicles"id="fleet_vehicle_log_contract_menu"groups="fleet_group_user"sequence="2"/>

    <recordid='fleet_vehicle_log_services_view_form'model='ir.ui.view'>
        <fieldname="name">fleet.vehicle.log.services.form</field>
        <fieldname="model">fleet.vehicle.log.services</field>
        <fieldname="arch"type="xml">
            <formstring="ServicesLogs">
                <fieldname="active"invisible="1"/>
                <fieldname="currency_id"invisible="1"/>
                <header>
                    <fieldname="state"widget="statusbar"options="{'clickable':'1'}"/>
                </header>
                <sheet>
                    <widgetname="web_ribbon"title="Archived"bg_color="bg-danger"attrs="{'invisible':[('active','=',True)]}"/>
                    <groupcol="2">
                        <group>
                            <fieldname="description"/>
                            <fieldname="service_type_id"/>
                            <fieldname="date"/>
                            <fieldname="amount"widget="monetary"/>
                            <fieldname="vendor_id"/>
                        </group>
                        <group>
                            <fieldname="vehicle_id"/>
                            <fieldname="purchaser_id"/>
                            <labelfor="odometer"/>
                            <divclass="o_row">
                                <fieldname="odometer"/>
                                <fieldname="odometer_unit"/>
                            </div>
                        </group>
                    </group>
                    <groupstring="Notes">
                        <fieldnolabel="1"name="notes"placeholder="Writehereanyotherinformationrelatedtotheservicecompleted."/>
                    </group>
                </sheet>
                <divclass="oe_chatter">
                    <fieldname="message_follower_ids"/>
                    <fieldname="activity_ids"/>
                    <fieldname="message_ids"/>
                </div>
            </form>
        </field>
    </record>

    <recordid='fleet_vehicle_log_services_view_tree'model='ir.ui.view'>
        <fieldname="name">fleet.vehicle.log.services.tree</field>
        <fieldname="model">fleet.vehicle.log.services</field>
        <fieldname="arch"type="xml">
            <treestring="ServicesLogs"multi_edit="1">
                <fieldname="date"readonly="1"/>
                <fieldname="description"/>
                <fieldname="service_type_id"/>
                <fieldname="vehicle_id"readonly="1"widget="many2one_avatar"/>
                <fieldname="purchaser_id"readonly="1"widget="many2one_avatar"/>
                <fieldname="vendor_id"optional="show"/>
                <fieldname="inv_ref"invisible="1"/>
                <fieldname="notes"optional="show"/>
                <fieldname="amount"sum="Total"widget="monetary"/>
                <fieldname="currency_id"invisible="1"/>
                <fieldname="state"readonly="1"widget="badge"decoration-success="state=='done'"decoration-warning="state=='todo'" decoration-info="state=='running'"/>
            </tree>
        </field>
    </record>

    <recordid='fleet_vehicle_log_services_view_kanban'model='ir.ui.view'>
        <fieldname="name">fleet.vehicle.log.services.kanban</field>
        <fieldname="model">fleet.vehicle.log.services</field>
        <fieldname="arch"type="xml">
            <kanbanclass="o_kanban_mobile">
                <fieldname="currency_id"/>
                <templates>
                    <tt-name="kanban-box">
                        <divt-attf-class="oe_kanban_global_click">
                            <div>
                                <strong>
                                    <fieldname="vehicle_id"widget="res_partner_many2one"/>
                                    <spanclass="float-right"><fieldname="date"/></span>
                                </strong>
                            </div>
                            <div>
                                <fieldname="purchaser_id"widget="res_partner_many2one"/>
                            </div>
                            <div>
                                <span><fieldname="vendor_id"widget="res_partner_many2one"/></span>
                                <spanclass="float-right"><fieldname="amount"widget="monetary"/></span>
                            </div>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>

    <recordid="fleet_vehicle_log_services_view_graph"model="ir.ui.view">
       <fieldname="name">fleet.vehicle.log.services.graph</field>
       <fieldname="model">fleet.vehicle.log.services</field>
       <fieldname="arch"type="xml">
            <graphstring="ServicesCostsPerMonth"stacked="True"sample="1">
                <fieldname="date"type="row"/>
                <fieldname="vehicle_id"type="row"/>
                <fieldname="amount"type="measure"/>
            </graph>
        </field>
    </record>

    <recordid='fleet_vehicle_log_services_view_search'model='ir.ui.view'>
        <fieldname="name">fleet.vehicle.log.services.search</field>
        <fieldname="model">fleet.vehicle.log.services</field>
        <fieldname="arch"type="xml">
            <searchstring="ServicesLogs">
                <fieldname="vehicle_id"/>
                <fieldname="service_type_id"/>
                <separator/>
                <filterstring="Archived"name="inactive"domain="[('active','=',False)]"/>
            </search>
        </field>
    </record>

    <recordid='fleet_vehicle_log_services_action'model='ir.actions.act_window'>
        <fieldname="name">Services</field>
        <fieldname="res_model">fleet.vehicle.log.services</field>
        <fieldname="view_mode">tree,kanban,form,graph</field>
        <fieldname="help"type="html">
          <pclass="o_view_nocontent_smiling_face">
            Createanewserviceentry
          </p><p>
            Trackalltheservicesdoneonyourvehicle.
            Servicescanbeofmanytypes:occasionalrepair,fixedmaintenance,etc.
          </p>
        </field>
    </record>

    <menuitemaction="fleet_vehicle_log_services_action"parent="fleet_vehicles"id="fleet_vehicle_log_services_menu"groups="fleet_group_user"sequence="3"/>

</flectra>
