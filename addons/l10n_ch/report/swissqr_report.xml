<?xmlversion="1.0"encoding="utf-8"?>
<flectra>
    <data>

        <recordid="l10n_ch_qr_report"model="ir.actions.report">
            <fieldname="name">QR-bill</field>
            <fieldname="model">account.move</field>
            <fieldname="report_type">qweb-pdf</field>
            <fieldname="report_name">l10n_ch.qr_report_main</field>
            <fieldname="report_file">l10n_ch.qr_report_main</field>
            <fieldname="print_report_name">'QR-bill-%s'%object.name</field>
            <fieldname="paperformat_id"ref="l10n_ch.paperformat_euro_no_margin"/>
            <fieldname="attachment">'QR-bill-'+object.name+'.pdf'</field>
        </record>

        <templateid="assets_common_qr"inherit_id="web.report_assets_common">
            <xpathexpr="."position="inside">
                <linktype="text/scss"rel="stylesheet"href="/l10n_ch/static/src/scss/report_swissqr.scss"/>
            </xpath>
        </template>

        <templateid="l10n_ch_swissqr_template">
            <tt-set="o"t-value="o.with_context(lang=lang)"/>
            <tt-call="web.external_layout">
                <!--TODOmaster:removethis-->
                <scriptt-if="0">document.body.className+="l10n_ch_qr";</script>
                <!--adddefaultmarginforheader(matchingA4Europeanmargin)-->
                <tt-set="report_header_style">padding-top:6.2mm;padding-left:8.2mm;padding-right:8.2mm;</t>

                <tt-set="formated_amount"t-value="'{:,.2f}'.format(o.amount_residual).replace(',','\xa0')"/>

                <tt-set="is_qrr"t-value="o.partner_bank_id._is_qr_iban()"/>
                <tt-set="is_scor"t-value="o.partner_bank_id._is_iso11649_reference(o.payment_reference)"/>

                <divclass="swissqr_page_title">
                    <h1>QR-billforinvoice<tt-esc="o.name"/></h1>
                </div>

                <divclass="swissqr_content_v2">

                    <divclass="swissqr_receipt">

                        <imgsrc="/l10n_ch/static/src/img/scissors_h.png"class="scissorshorizontal_scissors"/>

                        <divid="receipt_title_zone"class="swissqr_section_title">
                            <span>Receipt</span>
                        </div>

                        <divid="receipt_indication_zone"class="receipt_indication_zone">

                            <divclass="swissqr_texttitle">
                                <span>Account/Payableto</span>
                            </div>
                            <divclass="swissqr_textcontent">
                                <spant-field="o.partner_bank_id.acc_number"/><br/>
                                <spant-esc="o.partner_bank_id.acc_holder_nameoro.company_id.name"/><br/>
                                <spant-field="o.company_id.street"/><br/>
                                <tt-if="o.company_id.country_id.code!='CH'">
                                    <spant-field="o.company_id.country_id.code"/>
                                </t>
                                <spant-field="o.company_id.zip"/>
                                <spant-field="o.company_id.city"/><br/>
                                <br/>
                            </div>

                            <tt-if="is_qrroris_scor">
                                <divclass="swissqr_texttitle">
                                    <span>Reference</span>
                                </div>
                            </t>
                            <tt-if="is_qrr">
                                <divclass="swissqr_textcontent">
                                    <spant-esc="o.space_qrr_reference(o.payment_reference)"/><br/>
                                    <br/>
                                </div>
                            </t>
                            <tt-if="is_scor">
                                <divclass="swissqr_textcontent">
                                    <spant-esc="o.space_scor_reference(o.payment_reference)"/><br/>
                                    <br/>
                                </div>
                            </t>

                            <divclass="swissqr_texttitle">
                                <span>Payableby</span>
                            </div>
                            <divclass="swissqr_textcontent">
                                <spant-field="o.partner_id.commercial_partner_id.name"/><br/>
                                <spant-field="o.partner_id.street"/>
                                <spant-field="o.partner_id.street2"/><br/>
                                <tt-if="o.partner_id.country_id.code!='CH'">
                                    <spant-field="o.partner_id.country_id.code"/>
                                </t>
                                <spant-field="o.partner_id.zip"/>
                                <spant-field="o.partner_id.city"/>
                            </div>

                        </div>

                        <divid="receipt_amount_zone"class="swissqr_column_leftreceipt_amount_zone">
                            <divclass="swissqr_text">
                                <divclass="column">
                                    <divclass="title">
                                        <span>Currency</span>
                                    </div>
                                    <divclass="content">
                                        <spant-field="o.currency_id.name"/>
                                    </div>
                                </div>
                                <divclass="column">
                                    <divclass="title">
                                        <span>Amount</span>
                                    </div>
                                    <divclass="content">
                                        <spant-esc="formated_amount"/>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <divid="receipt_acceptance_point_zone"class="receipt_acceptance_point_zone">
                            <divclass="swissqr_textcontent">
                                <spanclass="title">Acceptancepoint</span>
                            </div>
                        </div>

                    </div>

                    <divclass="swissqr_body">

                        <imgsrc="/l10n_ch/static/src/img/scissors_v.png"class="scissorsvertical_scissors"/>

                        <divclass="swissqr_column_left">

                            <divclass="swissqr_section_title">
                                <span>Paymentpart</span>
                            </div>

                            <imgclass="swissqr"t-att-src="qr_code_urls[o.id]"/>

                            <divid="amount_zone"class="amount_zone">
                                <divclass="swissqr_text">
                                    <divclass="column">
                                        <divclass="title">
                                            <span>Currency</span>
                                        </div>
                                        <divclass="content">
                                            <spant-field="o.currency_id.name"/>
                                        </div>
                                    </div>
                                    <divclass="column">
                                        <divclass="title">
                                            <span>Amount</span><br/>
                                        </div>
                                        <divclass="content">
                                            <spant-esc="formated_amount"/>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>

                        <divid="indications_zone"class="swissqr_column_right">
                            <divclass="swissqr_texttitle">
                                <span>Account/Payableto</span><br/>
                            </div>
                            <divclass="swissqr_textcontent">
                                <spant-field="o.partner_bank_id.acc_number"/><br/>
                                <spant-esc="o.partner_bank_id.acc_holder_nameoro.company_id.name"/><br/>
                                <spant-field="o.company_id.street"/><br/>
                                <tt-if="o.company_id.country_id.code!='CH'">
                                    <spant-field="o.company_id.country_id.code"/>
                                </t>
                                <spant-field="o.company_id.zip"/>
                                <spant-field="o.company_id.city"/><br/>
                                <br/>
                            </div>

                            <tt-if="is_qrroris_scor">
                                <divclass="swissqr_texttitle">
                                    <spanclass="title">Reference</span>
                                </div>
                            </t>
                            <tt-if="is_qrr">
                                <divclass="swissqr_textcontent">
                                    <spant-esc="o.space_qrr_reference(o.payment_reference)"/><br/>
                                    <br/>
                                </div>
                            </t>
                            <tt-if="is_scor">
                                <divclass="swissqr_textcontent">
                                    <spant-esc="o.space_scor_reference(o.payment_reference)"/><br/>
                                    <br/>
                                </div>
                            </t>

                            <tt-set="additional_info"t-value="(o.reforo.nameifis_qrroris_scorelseo.payment_referenceoro.reforo.name)"/>
                            <tt-if="additional_info">
                                <divclass="swissqr_texttitle">
                                    <span>Additionalinformation</span>
                                </div>
                                <divclass="swissqr_textcontent">
                                    <spant-esc="additional_info"/><br/>
                                    <br/>
                                </div>
                            </t>

                            <divclass="swissqr_texttitle">
                                <span>Payableby</span>
                            </div>
                            <divclass="swissqr_textcontent">
                                <spant-field="o.partner_id.commercial_partner_id.name"/><br/>
                                <spant-field="o.partner_id.street"></span>
                                <spant-field="o.partner_id.street2"/><br/>
                                <tt-if="o.partner_id.country_id.code!='CH'">
                                    <spant-field="o.partner_id.country_id.code"/>
                                </t>
                                <spant-field="o.partner_id.zip"/>
                                <spant-field="o.partner_id.city"/><br/>
                                <br/>
                            </div>

                        </div>

                    </div>
                </div>
            </t>
        </template>

        <templateid="l10n_ch.qr_report_main">
            <tt-call="web.html_container">
                <tt-foreach="docs"t-as="o">
                    <tt-set="lang"t-value="o.partner_id.lang"/>
                    <tt-call="l10n_ch.l10n_ch_swissqr_template"t-lang="lang"/>
                </t>
            </t>
        </template>
        <templateid="minimal_layout_with_report_attribute"inherit_id="web.minimal_layout">
            <bodyposition="attributes">
                <attributename="t-att-data-report-id">report_xml_id</attribute>
            </body>
        </template>
    </data>
</flectra>
