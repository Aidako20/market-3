<?xmlversion="1.0"encoding="utf-8"?>
<flectra>
    <data>

        <recordid="paperformat_euro_no_margin"model="report.paperformat">
            <fieldname="name">EuropeanA4withoutborders</field>
            <fieldname="default"eval="False"/>
            <fieldname="format">A4</field>
            <fieldname="orientation">Portrait</field>
            <fieldname="margin_top">0</field>
            <fieldname="margin_bottom">0</field>
            <fieldname="margin_left">0</field>
            <fieldname="margin_right">0</field>
            <fieldname="header_line"eval="False"/>
            <fieldname="header_spacing">0</field>
        </record>

        <!--ReportcontaininganISRcorrrespondingtoaninvoice.-->
        <recordid="l10n_ch_isr_report"model="ir.actions.report">
            <fieldname="name">ISR</field>
            <fieldname="model">account.move</field>
            <fieldname="report_type">qweb-pdf</field>
            <fieldname="report_name">l10n_ch.isr_report_main</field>
            <fieldname="report_file">l10n_ch.isr_report_main</field>
            <fieldname="print_report_name">'ISR-%s'%object.name</field>
            <fieldname="paperformat_id"ref="paperformat_euro_no_margin"/>
            <fieldname="attachment">'ISR-'+object.name+'.pdf'</field>
            <fieldname="attachment_use">True</field>
        </record>
        <!--Noadditionalconditioninreportnameoninvoicestateortypeasthis
            reportisonlyavailabletobeprintedforoutinvoicesafter
            'draft'state,ifthefieldsrequiredbytheISRhavebeenset.-->

        <templateid="assets_common"name="l10n_ch_isr_report"inherit_id="web.report_assets_common">
            <xpathexpr="."position="inside">
                <linkrel="stylesheet"type="text/scss"href="/l10n_ch/static/src/scss/report_isr.scss"/>
            </xpath>
        </template>

        <templateid="l10n_ch_isr_report_template">
            <tt-call="web.external_layout">
                <tt-set="split_total_amount"t-value="invoice.split_total_amount()"/>
                <tt-set="print_bank"t-value="invoice.company_id.l10n_ch_isr_print_bank_location"/>

                <!--addclasstobodytag-->
                <script>document.body.className+="l10n_ch_isr";</script>

                <!--sincethebodycontenttakethewholepageweneedawaytoaddmargin
                     backoncontentoutsidetheISRsoitdoesnotoverlapwiththeheader-->
                <divid="content_outside_isr">
                    <h1>ISRforinvoice<tt-esc="invoice.name"/></h1>
                </div>

                <divid="isr"t-att-class="'isr-print-bank'ifprint_bankelseNone">

                    <!--Voucher,leftpartoftheISR.-->
                    <divid="voucher">
                        <!--Einzahlungfür/Versementpour/Versamentoper-->

                        <!--IfweusethealternateISRlayout,displayingname
                        andlocationofthebank.-->
                        <tt-if="print_bank">
                            <divid="voucher-for-bank">
                                <pt-if="notinvoice.company_id.l10n_ch_isr_preprinted_bank">
                                    <tt-esc="invoice.partner_bank_id.bank_id.name"/><br/>
                                    <tt-esc="invoice.partner_bank_id.bank_id.zip"/>
                                    <tt-esc="invoice.partner_bank_id.bank_id.city"/>
                                </p>
                            </div>
                            <!--Zugunstenvon/Enfaveurde/Afavoredi-->
                        </t>
                        <divid="voucher-for-contact">
                            <pid="voucher-for_name"t-field="invoice.company_id.display_name"/>
                            <pid="voucher-for_address1"t-field="invoice.company_id.street"/>
                            <pid="voucher-for_address2"t-field="invoice.company_id.street2"/>
                            <pid="voucher-for_address3">
                                <tt-esc="invoice.company_id.zip"/>
                                <tt-esc="invoice.company_id.city"/>
                            </p>
                        </div>

                        <divid="voucher-bank"t-if="notprint_bankornotinvoice.company_id.l10n_ch_isr_preprinted_account">
                            <!--Konto/Compte/Conto-->
                            <pid="voucher-bank_ref"t-field="invoice.l10n_ch_isr_subscription_formatted"/>
                        </div>

                        <pid="voucher-amount_units"t-esc="split_total_amount[0]"/>
                        <pid="voucher-amount_cents"t-esc="split_total_amount[1]"/>

                        <divid="voucher-by">
                            <!--Einbezahltvon/Versépar/Versatoda-->
                            <pid="voucher-by_reference_number"t-field="invoice.l10n_ch_isr_number"/>
                            <addressid="voucher-by_customer_address"t-field="invoice.partner_id"t-options='{"widget":"contact","fields":["address","name"],"no_marker":True}'/>
                        </div>
                    </div>

                    <!--Slip,rightpartoftheISR.-->
                    <divid="slip">
                        <!--Einzahlungfür/Versementpour/Versamentoper-->

                        <!--IfweusethealternateISRlayout,displayingname
                        andlocationofthebank.-->
                        <tt-if="print_bank">
                            <divid="slip-for-bank">
                                <pt-if="notinvoice.company_id.l10n_ch_isr_preprinted_bank">
                                    <tt-esc="invoice.partner_bank_id.bank_id.name"/><br/>
                                    <tt-esc="invoice.partner_bank_id.bank_id.zip"/>
                                    <tt-esc="invoice.partner_bank_id.bank_id.city"/>
                                </p>
                            </div>
                            <!--Zugunstenvon/Enfaveurde/Afavoredi-->
                        </t>

                        <divid="slip-for-contact">
                            <pid="slip-for_name"t-field="invoice.company_id.display_name"/>
                            <pid="slip-for_address1"t-field="invoice.company_id.street"/>
                            <pid="slip-for_address2"t-field="invoice.company_id.street2"/>
                            <pid="slip-for_address3">
                                <tt-esc="invoice.company_id.zip"/>
                                <tt-esc="invoice.company_id.city"/>
                            </p>
                        </div>

                        <divid="slip-bank"t-if="notprint_bankornotinvoice.company_id.l10n_ch_isr_preprinted_account">
                            <!--Konto/Compte/Conto-->
                            <!--akaISRSubscribernumberprovidedbythefinancialinstitution-->
                            <pid="slip-bank_ref"t-field="invoice.l10n_ch_isr_subscription_formatted"/>
                        </div>

                        <pid="slip-amount_units"t-esc="split_total_amount[0]"/>
                        <pid="slip-amount_cents"t-esc="split_total_amount[1]"/>

                        <divid="slip-reference">
                            <!--Referenz-Nr./N°deréférence/N°diriferimento-->
                            <pid="slip-reference_number"t-field="invoice.l10n_ch_isr_number_spaced"/>
                        </div>

                        <divid="slip-by">
                            <!--Einbezahltvon/Versépar/Versatoda-->
                            <addressid="slip-by_customer_address"t-field="invoice.partner_id"t-options='{"widget":"contact","fields":["address","name"],"no_marker":True}'/>
                        </div>

                        <divid="slip-optical-line">
                            <!--Opticalreference-->
                            <divt-attf-style="top:{{invoice.company_id.l10n_ch_isr_scan_line_top}}mm;left:{{invoice.company_id.l10n_ch_isr_scan_line_left}}mm;">
                                <divt-foreach="invoice.l10n_ch_isr_optical_line"t-as="char"t-esc="char"t-attf-style="right:{{round((char_size-char_index-1)*0.1,1)}}in"/>
                            </div>
                        </div>
                    </div>
                </div>
            </t>
        </template>

        <templateid="l10n_ch.isr_report_main">
            <tt-call="web.html_container">
                <tt-foreach="docs"t-as="invoice">
                    <tt-set="o"t-value="invoice"/>
                    <tt-call="l10n_ch.l10n_ch_isr_report_template"/>
                </t>
            </t>
        </template>
    </data>
</flectra>
